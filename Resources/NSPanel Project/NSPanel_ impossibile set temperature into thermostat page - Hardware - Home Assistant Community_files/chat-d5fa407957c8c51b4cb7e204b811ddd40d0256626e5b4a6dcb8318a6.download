define("discourse/plugins/chat/discourse/adapters/chat-message",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{pathFor(e,t,i){if(i.targetMessageId)return`/chat/lookup/${i.targetMessageId}.json?chat_channel_id=${i.channelId}`
let n=`/chat/${i.channelId}/messages.json?page_size=${i.pageSize}`
return i.messageId&&(n+=`&message_id=${i.messageId}`),i.direction&&(n+=`&direction=${i.direction}`),n}apiNameFor(){return"chat-message"}}e.default=i})),define("discourse/plugins/chat/discourse/admin-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins",path:"/plugins",map(){this.route("chat")}}})),define("discourse/plugins/chat/discourse/chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("chat",(function(){this.route("channel",{path:"/c/:channelTitle/:channelId"},(function(){this.route("near-message",{path:"/:messageId"}),this.route("threads",{path:"/t"}),this.route("thread",{path:"/t/:threadId"},(function(){this.route("near-message",{path:"/:messageId"})}))})),this.route("direct-messages"),this.route("channels"),this.route("threads"),this.route("channel.info",{path:"/c/:channelTitle/:channelId/info"},(function(){this.route("members"),this.route("settings")})),this.route("browse",(function(){this.route("all"),this.route("closed"),this.route("open"),this.route("archived")})),this.route("message",{path:"/message/:messageId"})}))}})),define("discourse/plugins/chat/discourse/components/channel-icon/index",["exports","@glimmer/component","@ember/template","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get firstUser(){return this.args.channel.chatable.users[0]}get groupDirectMessage(){return this.args.channel.isDirectMessageChannel&&this.args.channel.chatable.group}get channelColorStyle(){return(0,i.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"3Z4+h5W0",block:'[[[1,"\\n"],[41,[30,1,["isDirectMessageChannel"]],[[[1,"      "],[10,0],[14,0,"chat-channel-icon"],[12],[1,"\\n"],[41,[30,0,["groupDirectMessage"]],[[[1,"          "],[10,1],[14,0,"chat-channel-icon --users-count"],[12],[1,"\\n            "],[1,[30,1,["membershipsCount"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"chat-channel-icon --avatar"],[12],[1,"\\n            "],[8,[32,0],null,[["@user","@interactive"],[[30,0,["firstUser"]],false]],null],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isCategoryChannel"]],[[[1,"      "],[10,0],[14,0,"chat-channel-icon"],[12],[1,"\\n        "],[10,1],[14,0,"chat-channel-icon --category-badge"],[15,5,[30,0,["channelColorStyle"]]],[12],[1,"\\n          "],[1,[28,[32,1],["d-chat"],null]],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"            "],[1,[28,[32,1],["lock"],[["class"],["chat-channel-icon__restricted-category-icon"]]]],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-icon/index.js",scope:()=>[r.default,n.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/channel-name/index",["exports","@glimmer/component","@ember/helper","@ember/service","@ember/template","discourse/components/plugin-outlet","discourse/components/user-status-message","discourse/helpers/replace-emoji","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get firstUser(){return this.args.channel.chatable.users[0]}get users(){return this.args.channel.chatable.users}get groupDirectMessage(){return this.args.channel.isDirectMessageChannel&&this.args.channel.chatable.group}get groupsDirectMessageTitle(){return this.args.channel.title||this.usernames}get usernames(){return this.users.mapBy("username").join(", ")}get channelColorStyle(){return(0,r.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}get showUserStatus(){return!(1!==this.users.length||!this.users[0].status)}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"cWA51D6O",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel-name"],[12],[1,"\\n"],[41,[30,1,["isDirectMessageChannel"]],[[[41,[30,0,["groupDirectMessage"]],[[[1,"          "],[10,1],[14,0,"chat-channel-name__label"],[12],[1,"\\n            "],[1,[30,0,["groupsDirectMessageTitle"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,1],[14,0,"chat-channel-name__label"],[12],[1,"\\n            "],[1,[30,0,["firstUser","username"]]],[1,"\\n          "],[13],[1,"\\n"],[41,[30,0,["showUserStatus"]],[[[1,"            "],[8,[32,0],[[24,0,"chat-channel__user-status-message"]],[["@status","@showDescription"],[[28,[32,1],[[30,0,["users"]],"0.status"],null],[52,[30,0,["site","mobileView"]],"true"]]],null],[1,"\\n"]],[]],null],[1,"          "],[8,[32,2],null,[["@name","@outletArgs","@tagName","@connectorTagName"],["after-chat-channel-username",[28,[32,3],null,[["user"],[[30,2]]]],"",""]],null],[1,"\\n"]],[]]]],[]],[[[41,[30,1,["isCategoryChannel"]],[[[1,"        "],[10,1],[14,0,"chat-channel-name__label"],[12],[1,"\\n          "],[1,[28,[32,4],[[30,1,["title"]]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],null],[1,"      "]],[]],null]],[]]],[1,"    "],[13],[1,"\\n  "]],["@channel","@user","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-name/index.js",scope:()=>[s.default,i.get,a.default,i.hash,o.default],isStrictMode:!0}),h),p=(u=h).prototype,m="currentUser",b=[n.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),d=v,u)
var p,m,b,g,f,v})),define("discourse/plugins/chat/discourse/components/channel-title/index",["exports","discourse/helpers/concat-class","discourse/plugins/chat/discourse/components/channel-icon","discourse/plugins/chat/discourse/components/channel-name","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"wjGzaaYT",block:'[[[1,"\\n  "],[10,0],[15,0,[28,[32,0],["chat-channel-title",[52,[30,1,["isDirectMessageChannel"]],"is-dm","is-category"]],null]],[12],[1,"\\n    "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n    "],[8,[32,2],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[41,[48,[30,2]],[[[1,"      "],[18,2,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["@channel","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-title/index.js",scope:()=>[t.default,i.default,n.default],isStrictMode:!0}),(0,s.default)())
e.default=o})),define("discourse/plugins/chat/discourse/components/channels-list-direct",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/components/chat-channel-row","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=class extends t.default{constructor(){super(...arguments),w(this,"chat",b,this),w(this,"chatChannelsManager",g,this),w(this,"site",f,this),w(this,"modal",v,this)}openNewMessageModal(){this.modal.show(u.default)}get inSidebar(){return this.args.inSidebar??!1}get createDirectMessageChannelLabel(){return this.canCreateDirectMessageChannel?"chat.direct_messages.new":"chat.direct_messages.cannot_create"}get showDirectMessageChannels(){return this.canCreateDirectMessageChannel||!this.directMessageChannelsEmpty}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}get directMessageChannelClasses(){return"channels-list-container direct-message-channels "+(this.inSidebar?"collapsible-sidebar-section":"")}get directMessageChannelsEmpty(){return 0===this.chatChannelsManager.directMessageChannels?.length}toggleChannelSection(e){this.args.toggleSection(e)}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"UgxkbvEB",block:'[[[1,"\\n    "],[8,[32,0],null,[["@name","@tagName","@outletArgs"],["below-direct-chat-channels","",[28,[32,1],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n\\n"],[41,[30,0,["showDirectMessageChannels"]],[[[41,[30,0,["site","desktopView"]],[[[1,"        "],[10,0],[14,0,"chat-channel-divider direct-message-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"            "],[11,1],[24,0,"title-caret"],[24,1,"direct-message-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","direct-message-channels"],[4,[32,2],["click",[28,[32,3],[[30,0,["toggleChannelSection"]],"direct-message-channels"],null]],null],[12],[1,"\\n              "],[1,[28,[32,4],["angle-up"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,5],["chat.direct_messages.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["canCreateDirectMessageChannel"]],[[[1,"            "],[8,[32,6],[[24,0,"no-text btn-flat open-new-message-btn"],[16,"title",[28,[32,5],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"\\n    "],[10,0],[14,1,"direct-message-channels"],[15,0,[30,0,["directMessageChannelClasses"]]],[12],[1,"\\n"],[41,[30,0,["directMessageChannelsEmpty"]],[[[1,"        "],[10,0],[14,0,"channel-list-empty-message"],[12],[1,"\\n          "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,5],["chat.no_direct_message_channels"],null]],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["chatChannelsManager","truncatedDirectMessageChannels"]]],null]],null],null,[[[1,"          "],[8,[32,7],null,[["@channel","@options"],[[30,1],[28,[32,1],null,[["leaveButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"    "],[13],[1,"\\n  "]],["channel"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list-direct.js",scope:()=>[o.default,i.hash,n.on,i.fn,l.default,c.default,s.default,d.default],isStrictMode:!0}),y),b=_((m=y).prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_(m.prototype,"chatChannelsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=_(m.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=_(m.prototype,"modal",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_(m.prototype,"openNewMessageModal",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"openNewMessageModal"),m.prototype),_(m.prototype,"toggleChannelSection",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"toggleChannelSection"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/channels-list-public",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","truth-helpers/helpers/and","discourse/plugins/chat/discourse/components/chat-channel-row","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(_=class extends t.default{constructor(){super(...arguments),j(this,"chatChannelsManager",g,this),j(this,"chatTrackingStateManager",f,this),j(this,"site",v,this),j(this,"siteSettings",y,this),j(this,"currentUser",w,this)}get inSidebar(){return this.args.inSidebar??!1}get publicMessageChannelsEmpty(){return 0===this.chatChannelsManager.publicMessageChannels?.length}get displayPublicChannels(){return!!this.siteSettings.enable_public_channels&&(!this.publicMessageChannelsEmpty||(this.currentUser?.staff||this.currentUser?.has_joinable_public_channels))}get hasUnreadThreads(){return this.chatTrackingStateManager.hasUnreadThreads}get isThreadEnabledInAnyChannel(){return this.currentUser?.chat_channels?.public_channels?.some((e=>e.threading_enabled))}toggleChannelSection(e){this.args.toggleSection(e)}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"WBUAnJPO",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["isThreadEnabledInAnyChannel"]]],null],[[[1,"      "],[8,[32,1],[[24,0,"chat-channel-row --threads"]],[["@route"],["chat.threads"]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-channel-title"],[12],[1,"\\n          "],[1,[28,[32,2],["discourse-threads"],[["class"],["chat-user-threads__icon"]]]],[1,"\\n          "],[1,[28,[32,3],["chat.my_threads.title"],null]],[1,"\\n        "],[13],[1,"\\n"],[41,[30,0,["hasUnreadThreads"]],[[[1,"          "],[10,0],[14,0,"c-unread-indicator"],[12],[1,"\\n            "],[10,0],[14,0,"c-unread-indicator__number"],[12],[1," "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["displayPublicChannels"]],[[[41,[30,0,["site","desktopView"]],[[[1,"        "],[10,0],[14,0,"chat-channel-divider public-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"            "],[11,1],[24,0,"title-caret"],[24,1,"public-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","public-channels"],[4,[32,4],["click",[28,[32,5],[[30,0,["toggleChannelSection"]],"public-channels"],null]],null],[12],[1,"\\n              "],[1,[28,[32,2],["angle-up"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,3],["chat.chat_channels"],null]],[13],[1,"\\n\\n          "],[8,[32,1],[[24,0,"btn no-text btn-flat open-browse-page-btn title-action"],[16,"title",[28,[32,3],["chat.channels_list_popup.browse"],null]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n            "],[1,[28,[32,2],["pencil-alt"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,1,"public-channels"],[15,0,[28,[32,6],["channels-list-container","public-channels",[52,[30,0,["inSidebar"]],"collapsible-sidebar-section"]],null]],[12],[1,"\\n"],[41,[30,0,["publicMessageChannelsEmpty"]],[[[1,"          "],[10,0],[14,0,"channel-list-empty-message"],[12],[1,"\\n            "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,3],["chat.no_public_channels"],null]],[13],[1,"\\n            "],[8,[32,1],null,[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n              "],[1,[28,[32,3],["chat.click_to_join"],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["chatChannelsManager","publicMessageChannels"]]],null]],null],null,[[[1,"            "],[8,[32,7],null,[["@channel","@options"],[[30,1],[28,[32,8],null,[["settingsButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[8,[32,9],null,[["@name","@tagName","@outletArgs"],["below-public-chat-channels","",[28,[32,8],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n  "]],["channel"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list-public.js",scope:()=>[d.default,a.LinkTo,c.default,u.default,n.on,i.fn,l.default,h.default,i.hash,o.default],isStrictMode:!0}),_),g=M((b=_).prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(b.prototype,"chatTrackingStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(b.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(b.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=M(b.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M(b.prototype,"toggleChannelSection",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"toggleChannelSection"),b.prototype),b)})),define("discourse/plugins/chat/discourse/components/channels-list",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-direct","discourse/plugins/chat/discourse/components/channels-list-public","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"zeAt9L8I",block:'[[[1,"\\n    "],[10,0],[14,"role","region"],[15,"aria-label",[28,[32,0],["chat.aria_roles.channels_list"],null]],[14,0,"channels-list"],[12],[1,"\\n      "],[8,[32,1],null,null,null],[1,"\\n\\n"],[41,[30,0,["chat","userCanAccessDirectMessages"]],[[[1,"        "],[8,[32,2],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list.js",scope:()=>[n.default,a.default,r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="chat",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat-channel-archive-status",["exports","@glimmer/component","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"chatApi",m,this),f(this,"currentUser",b,this)}get shouldRender(){return this.currentUser.admin&&(0,a.isPresent)(this.args.channel.archive)}get channelArchiveFailedMessage(){const e=this.args.channel.archive,t=e.topicId?"chat.channel_status.archive_failed":"chat.channel_status.archive_failed_no_topic"
return(0,r.htmlSafe)(u.default.t(t,{completed:e.messages,total:e.totalMessages,topic_url:this.topicUrl}))}get channelArchiveCompletedMessage(){return(0,r.htmlSafe)(u.default.t("chat.channel_status.archive_completed",{topic_url:this.topicUrl}))}retryArchive(){return this.chatApi.createChannelArchive(this.args.channel.id).catch(l.popupAjaxError)}get topicUrl(){return this.args.channel.archive.topicId?(0,c.default)(`/t/-/${this.args.channel.archive.topicId}`):""}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"WUzspRR4",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[41,[30,1,["archive","failed"]],[[[1,"        "],[10,0],[15,0,[28,[32,0],["alert alert-warn chat-channel-retry-archive",[30,1,["status"]]],null]],[12],[1,"\\n          "],[10,0],[14,0,"chat-channel-archive-failed-message"],[12],[1,"\\n            "],[1,[30,0,["channelArchiveFailedMessage"]]],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"chat-channel-archive-failed-retry"],[12],[1,"\\n            "],[8,[32,1],null,[["@action","@label"],[[30,0,["retryArchive"]],"chat.channel_archive.retry"]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,1,["archive","completed"]],[[[1,"        "],[10,0],[15,0,[28,[32,0],["chat-channel-archive-status",[30,1,["status"]]],null]],[12],[1,"\\n          "],[1,[30,0,["channelArchiveCompletedMessage"]]],[1,"\\n        "],[13],[1,"\\n      "]],[]],null]],[]]]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-archive-status.js",scope:()=>[o.default,s.default],isStrictMode:!0}),g),m=v((p=g).prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(p.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(p.prototype,"retryArchive",[i.action],Object.getOwnPropertyDescriptor(p.prototype,"retryArchive"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat-channel-card",["exports","@glimmer/component","@ember/helper","@ember/routing","@ember/service","discourse/helpers/border-color","discourse/helpers/concat-class","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","truth-helpers/helpers/gt","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=b)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"ZWwgwl2d",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-channel-card",[52,[30,1,["isClosed"]],"-closed"],[52,[30,1,["isArchived"]],"-archived"]],null]],[15,5,[28,[32,1],[[30,1,["chatable","color"]]],null]],[15,"data-channel-id",[30,1,["id"]]],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-card__header"],[12],[1,"\\n          "],[8,[32,2],[[24,0,"chat-channel-card__name-container"]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[10,1],[14,0,"chat-channel-card__name"],[12],[1,"\\n              "],[1,[28,[32,3],[[30,1,["title"]]],null]],[1,"\\n            "],[13],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"              "],[1,[28,[32,4],["lock"],[["class"],["chat-channel-card__read-restricted"]]]],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n\\n          "],[10,0],[14,0,"chat-channel-card__header-actions"],[12],[1,"\\n"],[41,[30,1,["currentUserMembership","muted"]],[[[1,"              "],[8,[32,2],[[24,0,"chat-channel-card__tag -muted"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n                "],[1,[28,[32,5],["chat.muted"],null]],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n            "],[8,[32,2],[[24,0,"chat-channel-card__setting"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,4],["cog"],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,1,["description"]],[[[1,"          "],[10,0],[14,0,"chat-channel-card__description"],[12],[1,"\\n            "],[1,[28,[32,3],[[30,1,["description"]]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[10,0],[14,0,"chat-channel-card__cta"],[12],[1,"\\n"],[41,[30,1,["isFollowing"]],[[[1,"            "],[10,0],[14,0,"chat-channel-card__tags"],[12],[1,"\\n              "],[10,1],[14,0,"chat-channel-card__tag -joined"],[12],[1,"\\n                "],[1,[28,[32,5],["chat.joined"],null]],[1,"\\n              "],[13],[1,"\\n\\n              "],[8,[32,6],null,[["@channel","@options"],[[30,1],[28,[32,7],null,[["leaveClass","labelType"],["btn-link btn-small chat-channel-card__leave-btn","short"]]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isJoinable"]],[[[1,"            "],[8,[32,6],null,[["@channel","@options"],[[30,1],[28,[32,7],null,[["joinClass","labelType"],["btn-primary btn-small chat-channel-card__join-btn","short"]]]]],null],[1,"\\n          "]],[]],null]],[]]],[1,"\\n"],[41,[28,[32,8],[[30,1,["membershipsCount"]],0],null],[[[1,"            "],[8,[32,2],[[24,0,"chat-channel-card__members"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.members",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,5],["chat.channel.memberships_count"],[["count"],[[30,1,["membershipsCount"]]]]]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-card.js",scope:()=>[s.default,a.default,n.LinkTo,o.default,l.default,c.default,d.default,i.hash,u.default],isStrictMode:!0}),g),f=(m=g).prototype,v="chat",y=[r.inject],w={configurable:!0,enumerable:!0,writable:!0,initializer:null},j={},Object.keys(w).forEach((function(e){j[e]=w[e]})),j.enumerable=!!j.enumerable,j.configurable=!!j.configurable,("value"in j||j.initializer)&&(j.writable=!0),j=y.slice().reverse().reduce((function(e,t){return t(f,v,e)||e}),j),_&&void 0!==j.initializer&&(j.value=j.initializer?j.initializer.call(_):void 0,j.initializer=void 0),void 0===j.initializer&&(Object.defineProperty(f,v,j),j=null),b=j,m)
var f,v,y,w,_,j})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-header",["exports","@ember/component","select-kit/components/combo-box/combo-box-header","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"Lr5V79a1",block:'[[[10,0],[14,0,"select-kit-header-wrapper"],[12],[1,"\\n"],[41,[30,0,["selectedContent"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,0,["selectedContent"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],["chat.incoming_webhooks.channel_placeholder"],null]],[1,"\\n"]],[]]],[1,"\\n  "],[1,[28,[35,3],[[30,0,["caretIcon"]]],[["class"],["caret-icon"]]]],[1,"\\n"],[13]],[],false,["if","channel-title","i18n","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-header.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,i.default.extend({}))})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-row",["exports","@ember/component","select-kit/components/select-kit/select-kit-row","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"0Vwx6mQC",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["item"]]]],null]],[],false,["channel-title"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-row.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,i.default.extend({classNames:["chat-channel-chooser-row"]}))})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser",["exports","select-kit/components/combo-box"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.default.extend({pluginApiIdentifiers:["chat-channel-chooser"],classNames:["chat-channel-chooser"],selectKitOptions:{headerComponent:"chat-channel-chooser-header"},modifyComponentForRow:()=>"chat-channel-chooser-row"})})),define("discourse/plugins/chat/discourse/components/chat-channel-leave-btn",["exports","@glimmer/component","@ember/service","@ember/utils","discourse/components/d-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"site",c,this)}get shouldRender(){return!this.site.mobileView&&(0,n.isPresent)(this.args.channel)}get leaveChatTitleKey(){return this.args.channel.isDirectMessageChannel?"chat.direct_messages.leave":"chat.leave"}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"pGLrTftt",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-flat chat-channel-leave-btn"]],[["@icon","@action","@title"],["times",[30,1],[30,0,["leaveChatTitleKey"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["@onLeaveChannel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-leave-btn.js",scope:()=>[r.default],isStrictMode:!0}),u),l=h((o=u).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker",["exports","@glimmer/component","@ember/object","@ember/service","@popperjs/core","ember-modifier","discourse/lib/offset-calculator","discourse/plugins/chat/discourse/components/chat-emoji-picker","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"site",d,this),m(this,"chatEmojiPickerManager",h,this),b(this,"context","chat-channel-message"),b(this,"listenToBodyScroll",(0,a.modifier)((()=>{const e=()=>{this.chatEmojiPickerManager.close()}
return document.addEventListener("scroll",e),()=>{document.removeEventListener("scroll",e)}})))}didSelectEmoji(e){this.chatEmojiPickerManager.picker?.didSelectEmoji(e),this.chatEmojiPickerManager.close()}didInsert(e){this.site.mobileView||(this._popper=(0,r.createPopper)(this.chatEmojiPickerManager.picker?.trigger,e,{placement:"top",modifiers:[{name:"eventListeners",options:{scroll:!1,resize:!1}},{name:"flip",options:{padding:{top:(0,s.headerOffset)()}}}]})),e.classList.remove("hidden")}willDestroy(){super.willDestroy(...arguments),this._popper?.destroy()}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"7uySDSKx",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"hidden"],[4,[30,0,["listenToBodyScroll"]],null,null]],[["@context","@didInsert","@willDestroy","@didSelectEmoji"],["chat-channel-message",[30,0,["didInsert"]],[30,0,["willDestroy"]],[30,0,["didSelectEmoji"]]]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker.js",scope:()=>[o.default],isStrictMode:!0}),p),d=g((u=p).prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"chatEmojiPickerManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(u.prototype,"didSelectEmoji",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"didSelectEmoji"),u.prototype),g(u.prototype,"didInsert",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"didInsert"),u.prototype),g(u.prototype,"willDestroy",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"willDestroy"),u.prototype),u)})),define("discourse/plugins/chat/discourse/components/chat-channel-metadata",["exports","@glimmer/component","I18n","discourse/plugins/chat/discourse/components/chat-channel-unread-indicator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get unreadIndicator(){return this.args.unreadIndicator??!1}get lastMessageFormattedDate(){return moment(this.args.channel.lastMessage.createdAt).calendar(null,{sameDay:"LT",lastDay:`[${i.default.t("chat.dates.yesterday")}]`,lastWeek:"dddd",sameElse:"l"})}}e.default=o,s=o,(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"XdcB4urK",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel__metadata"],[12],[1,"\\n"],[41,[30,1,["lastMessage"]],[[[1,"        "],[10,0],[14,0,"chat-channel__metadata-date"],[12],[1,"\\n          "],[1,[30,0,["lastMessageFormattedDate"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["unreadIndicator"]],[[[1,"        "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-metadata.js",scope:()=>[n.default],isStrictMode:!0}),s)})),define("discourse/plugins/chat/discourse/components/chat-channel-preview-card",["exports","@glimmer/component","@ember/helper","@ember/routing","@ember/service","@ember/utils","discourse/helpers/concat-class","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=p)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get showJoinButton(){return this.args.channel?.isOpen&&this.args.channel?.canJoin}get hasDescription(){return!(0,a.isEmpty)(this.args.channel?.description)}},(0,d.setComponentTemplate)((0,u.createTemplateFactory)({id:"11noQeda",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-channel-preview-card",[52,[51,[30,0,["hasDescription"]]],"-no-description"],[52,[51,[30,0,["showJoinButton"]]],"-no-button"]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n"],[41,[30,0,["hasDescription"]],[[[1,"        "],[10,2],[14,0,"chat-channel-preview-card__description"],[12],[1,"\\n          "],[1,[30,1,["description"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[41,[30,0,["showJoinButton"]],[[[1,"        "],[8,[32,2],null,[["@channel","@options"],[[30,1],[28,[32,3],null,[["joinClass"],["btn-primary"]]]]],null],[1,"\\n"]],[]],null],[1,"      "],[8,[32,4],[[24,0,"chat-channel-preview-card__browse-all"]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,5],["chat.browse_all_channels"],null]],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["@channel"],false,["unless","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-preview-card.js",scope:()=>[s.default,l.default,c.default,i.hash,n.LinkTo,o.default],isStrictMode:!0}),m),b=(h=m).prototype,g="chat",f=[r.inject],v={configurable:!0,enumerable:!0,writable:!0,initializer:null},w={},Object.keys(v).forEach((function(e){w[e]=v[e]})),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=f.slice().reverse().reduce((function(e,t){return t(b,g,e)||e}),w),y&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(y):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(b,g,w),w=null),p=w,h)
var b,g,f,v,y,w})),define("discourse/plugins/chat/discourse/components/chat-channel-row",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/service","@ember/template","ember-modifier","discourse/helpers/concat-class","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/and","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/channel-icon","discourse/plugins/chat/discourse/components/channel-name","discourse/plugins/chat/discourse/components/chat-channel-metadata","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z){"use strict"
var O,C,k,S,P,T,E,x,D,A,N,I,L,U,R,F,B
function W(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function H(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function $(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function V(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function G(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(B=new WeakMap,F=class extends t.default{constructor(){super(...arguments),H(this,B,{get:q,set:void 0}),W(this,"api",C,this),W(this,"capabilities",k,this),W(this,"chat",S,this),W(this,"currentUser",P,this),W(this,"router",T,this),W(this,"site",E,this),W(this,"isAtThreshold",x,this),W(this,"shouldRemoveChannel",D,this),W(this,"showRemoveButton",A,this),W(this,"swipableRow",N,this),W(this,"shouldReset",I,this),W(this,"diff",L,this),W(this,"rowStyle",U,this),W(this,"canSwipe",R,this),$(this,"registerSwipableRow",(0,u.modifier)((e=>{this.swipableRow=e}))),$(this,"onReset",(0,u.modifier)((e=>{const t=()=>{this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}
return e.addEventListener("transitionend",t,{once:!0}),()=>{e.removeEventListener("transitionend",t),this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}}))),$(this,"onRemoveChannel",(0,u.modifier)((e=>{e.addEventListener("transitionend",(()=>{this.chat.unfollowChannel(this.args.channel).catch(p.popupAjaxError)}),{once:!0}),e.classList.add("-fade-out")}))),$(this,"handleSwipe",(0,u.modifier)((e=>(e.addEventListener("touchstart",this.onSwipeStart,{passive:!0}),e.addEventListener("touchmove",this.onSwipe,{passive:!0}),e.addEventListener("touchend",this.onSwipeEnd),()=>{e.removeEventListener("touchstart",this.onSwipeStart),e.removeEventListener("touchmove",this.onSwipe),e.removeEventListener("touchend",this.onSwipeEnd)}))))}onSwipeStart(e){this._initialX=e.changedTouches[0].screenX}onSwipe(e){this.showRemoveButton=!0,this.shouldReset=!1,this.isAtThreshold=!1
const t=window.innerWidth/3,i=e.changedTouches[0].screenX
this.diff=this._initialX-i,this.isAtThreshold=this.diff>=t,this.diff>25?(this.isAtThreshold&&(this.diff=t+.1*(this.diff-t)),this.rowStyle=(0,c.htmlSafe)(`margin-right: ${this.diff}px;`)):this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;")}onSwipeEnd(){this.isAtThreshold?(this.rowStyle=(0,c.htmlSafe)("margin-right: 0px;"),this.shouldRemoveChannel=!0):this.shouldReset=!0}get shouldHandleSwipe(){return this.capabilities.touch&&this.args.channel.isDirectMessageChannel}get leaveDirectMessageLabel(){return g.default.t("chat.direct_messages.close")}get leaveChannelLabel(){return g.default.t("chat.channel_settings.leave_channel")}get channelHasUnread(){return this.args.channel.tracking.unreadCount>0}get shouldRenderLastMessage(){return this.site.mobileView&&this.args.channel.isDirectMessageChannel&&this.args.channel.lastMessage}startTrackingStatus(){V(this,B)?.trackStatus()}stopTrackingStatus(){V(this,B)?.stopTrackingStatus()}},(0,z.setComponentTemplate)((0,M.createTemplateFactory)({id:"b2eQcZxU",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["chat-channel-row",[52,[30,1,["focused"]],"focused"],[52,[30,1,["currentUserMembership","muted"]],"muted"],[52,[30,2,["leaveButton"]],"can-leave"],[52,[28,[32,2],[[30,0,["chat","activeChannel","id"]],[30,1,["id"]]],null],"active"],[52,[30,0,["channelHasUnread"]],"has-unread"]],null]],[24,"tabindex","0"],[16,"data-chat-channel-id",[30,1,["id"]]],[4,[32,3],[[30,0,["startTrackingStatus"]]],null],[4,[32,4],[[30,0,["stopTrackingStatus"]]],null],[4,[52,[30,0,["shouldRemoveChannel"]],[50,[30,0,["onRemoveChannel"]],2,null,null]],null,null]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[11,0],[16,0,[28,[32,1],["chat-channel-row__content",[52,[30,1,["isCategoryChannel"]],"is-category","is-dm"],[52,[30,0,["shouldReset"]],"-animate-reset"]],null]],[16,5,[30,0,["rowStyle"]]],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["registerSwipableRow"]],2,null,null]],null,null],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["handleSwipe"]],2,null,null]],null,null],[4,[52,[30,0,["shouldReset"]],[50,[30,0,["onReset"]],2,null,null]],null,null],[12],[1,"\\n        "],[8,[32,5],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[10,0],[14,0,"chat-channel-row__info"],[12],[1,"\\n          "],[8,[32,6],null,[["@channel"],[[30,1]]],null],[1,"\\n          "],[8,[32,7],null,[["@channel","@unreadIndicator"],[[30,1],true]],null],[1,"\\n"],[41,[30,0,["shouldRenderLastMessage"]],[[[1,"            "],[10,0],[14,0,"chat-channel__last-message"],[12],[1,"\\n              "],[1,[28,[32,8],[[28,[32,9],[[30,1,["lastMessage","excerpt"]]],null]],null]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n"],[41,[28,[32,10],[[30,2,["leaveButton"]],[30,1,["isFollowing"]],[30,0,["site","desktopView"]]],null],[[[1,"          "],[8,[32,11],null,[["@channel","@options"],[[30,1],[28,[32,12],null,[["leaveClass","labelType","leaveIcon","leaveTitle"],["btn-flat chat-channel-leave-btn","none","times",[52,[30,1,["isDirectMessageChannel"]],[30,0,["leaveDirectMessageLabel"]],[30,0,["leaveChannelLabel"]]]]]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[30,0,["showRemoveButton"]],[[[1,"        "],[10,0],[15,0,[28,[32,1],["chat-channel-row__action-btn",[52,[30,0,["isAtThreshold"]],"-at-threshold","-not-at-threshold"]],null]],[12],[1,"\\n          "],[1,[28,[32,13],["times-circle"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "]],[]]]]],[1,"\\n  "]],["@channel","@options"],false,["if","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-row.js",scope:()=>[o.LinkTo,d.default,v.default,a.default,s.default,y.default,w.default,_.default,h.default,c.htmlSafe,f.default,j.default,n.hash,m.default],isStrictMode:!0}),F),C=G((O=F).prototype,"api",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=G(O.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=G(O.prototype,"chat",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=G(O.prototype,"currentUser",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=G(O.prototype,"router",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=G(O.prototype,"site",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=G(O.prototype,"isAtThreshold",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D=G(O.prototype,"shouldRemoveChannel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=G(O.prototype,"showRemoveButton",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),N=G(O.prototype,"swipableRow",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=G(O.prototype,"shouldReset",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=G(O.prototype,"diff",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=G(O.prototype,"rowStyle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=G(O.prototype,"canSwipe",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),G(O.prototype,"onSwipeStart",[b.bind],Object.getOwnPropertyDescriptor(O.prototype,"onSwipeStart"),O.prototype),G(O.prototype,"onSwipe",[b.bind],Object.getOwnPropertyDescriptor(O.prototype,"onSwipe"),O.prototype),G(O.prototype,"onSwipeEnd",[b.bind],Object.getOwnPropertyDescriptor(O.prototype,"onSwipeEnd"),O.prototype),G(O.prototype,"startTrackingStatus",[r.action],Object.getOwnPropertyDescriptor(O.prototype,"startTrackingStatus"),O.prototype),G(O.prototype,"stopTrackingStatus",[r.action],Object.getOwnPropertyDescriptor(O.prototype,"stopTrackingStatus"),O.prototype),O)
function q(){return this.args.channel?.chatable?.users?.firstObject}})),define("discourse/plugins/chat/discourse/components/chat-channel-status",["exports","@glimmer/component","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/components/chat-channel-archive-status","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l
function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var h=new WeakSet,p=new WeakSet
class m extends t.default{constructor(){super(...arguments),c(this,p),c(this,h),u(this,"LONG_FORMAT","long"),u(this,"SHORT_FORMAT","short"),u(this,"VALID_FORMATS",[this.SHORT_FORMAT,this.LONG_FORMAT])}get format(){return this.VALID_FORMATS.includes(this.args.format)?this.args.format:this.LONG_FORMAT}get shouldRender(){return this.channelStatusIcon&&this.args.channel.status!==r.CHANNEL_STATUSES.open}get channelStatusMessage(){return this.format===this.LONG_FORMAT?d(this,p,g).call(this,this.args.channel.status):d(this,h,b).call(this,this.args.channel.status)}get channelStatusIcon(){return(0,r.channelStatusIcon)(this.args.channel.status)}}function b(e){switch(e){case r.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived")
case r.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed")
case r.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open")
case r.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only")}}function g(e){switch(e){case r.CHANNEL_STATUSES.archived:return n.default.t("chat.channel_status.archived_header")
case r.CHANNEL_STATUSES.closed:return n.default.t("chat.channel_status.closed_header")
case r.CHANNEL_STATUSES.open:return n.default.t("chat.channel_status.open_header")
case r.CHANNEL_STATUSES.readOnly:return n.default.t("chat.channel_status.read_only_header")}}e.default=m,l=m,(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"8iHhouHV",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,0],[14,0,"chat-channel-status"],[12],[1,"\\n        "],[1,[28,[32,0],[[30,0,["channelStatusIcon"]]],null]],[1,"\\n        "],[10,1],[12],[1,[30,0,["channelStatusMessage"]]],[13],[1,"\\n        "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-status.js",scope:()=>[i.default,a.default],isStrictMode:!0}),l)})),define("discourse/plugins/chat/discourse/components/chat-channel-title",["exports","discourse/plugins/chat/discourse/components/channel-title","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"YBFUIYUG",block:'[[[1,"\\n  "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],["@channel"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-title.js",scope:()=>[t.default],isStrictMode:!0}),(0,r.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat-channel-unread-indicator",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse/plugins/chat/discourse/lib/chat-user-preferences","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=new WeakSet,p=new WeakSet,d=class extends t.default{constructor(){super(...arguments),b(this,p),b(this,h),m(this,"chat",l,this),m(this,"site",c,this),m(this,"currentUser",u,this)}get showUnreadIndicator(){return this.args.channel.tracking.unreadCount>0||this.chat.activeChannel?.id!==this.args.channel.id&&this.args.channel.unreadThreadsCountSinceLastViewed>0}get unreadCount(){return g(this,p,y).call(this)&&g(this,h,v).call(this)?this.args.channel.tracking.mentionCount:this.args.channel.tracking.unreadCount}get isUrgent(){return g(this,p,y).call(this)?g(this,h,v).call(this):this.args.channel.isDirectMessageChannel||g(this,h,v).call(this)}get showUnreadCount(){return g(this,p,y).call(this)?g(this,h,v).call(this):this.args.channel.isDirectMessageChannel||this.isUrgent}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"1/sA88K1",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-channel-unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[41,[30,0,["showUnreadCount"]],[[[1,[30,0,["unreadCount"]]]],[]],[[[1," "]],[]]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-unread-indicator.js",scope:()=>[n.default],isStrictMode:!0}),d),l=f((o=d).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f(o.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(o.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)
function v(){return this.args.channel.tracking.mentionCount>0}function y(){return(0,r.hasChatIndicator)(this.currentUser).ONLY_MENTIONS}})),define("discourse/plugins/chat/discourse/components/chat-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/desktop-notifications","discourse/lib/url","discourse/lib/user-presence","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse-common/utils/decorators","truth-helpers/helpers/and","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat-channel-status","discourse/plugins/chat/discourse/lib/chat-channel-subscription-manager","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/check-message-visibility","discourse/plugins/chat/discourse/lib/dates-separators-positioner","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/modifiers/chat/on-resize","discourse/plugins/chat/discourse/modifiers/chat/scrollable-list","discourse/plugins/chat/discourse/components/chat/composer/channel","discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow","discourse/plugins/chat/discourse/components/chat/selection-manager","discourse/plugins/chat/discourse/components/chat-channel-preview-card","discourse/plugins/chat/discourse/components/chat-mention-warnings","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/components/chat-notices","discourse/plugins/chat/discourse/components/chat-skeleton","discourse/plugins/chat/discourse/components/chat-upload-drop-zone","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D,A,N,I,L,U,R,F,B,W){"use strict"
var H,$,V,G,q,K,J,Y,Z,X,Q,ee,te,ie,ne,re,ae,se,oe,le,ce,ue,de,he,pe,me,be,ge,fe,ve,ye,we
function _e(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function je(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Me(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ze(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function Oe(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(H=(0,u.inject)("chat-channel-composer"),$=(0,u.inject)("chat-channel-pane"),ge=new WeakSet,fe=new WeakSet,ve=new WeakSet,ye=new WeakSet,we=new WeakSet,be=class extends t.default{constructor(){super(...arguments),je(this,we),je(this,ye),je(this,ve),je(this,fe),je(this,ge),_e(this,"appEvents",G,this),_e(this,"capabilities",q,this),_e(this,"chat",K,this),_e(this,"chatApi",J,this),_e(this,"chatChannelsManager",Y,this),_e(this,"chatComposerPresenceManager",Z,this),_e(this,"chatDraftsManager",X,this),_e(this,"chatEmojiPickerManager",Q,this),_e(this,"chatStateManager",ee,this),_e(this,"chatChannelScrollPositions",te,this),_e(this,"composer",ie,this),_e(this,"pane",ne,this),_e(this,"currentUser",re,this),_e(this,"messageBus",ae,this),_e(this,"router",se,this),_e(this,"site",oe,this),_e(this,"sending",le,this),_e(this,"showChatQuoteSuccess",ce,this),_e(this,"includeHeader",ue,this),_e(this,"needsArrow",de,this),_e(this,"atBottom",he,this),_e(this,"uploadDropZone",pe,this),_e(this,"isScrolling",me,this),Me(this,"scrollable",null)
Me(this,"_mentionWarningsSeen",{}),Me(this,"_unreachableGroupMentions",[]),Me(this,"_overMembersLimitGroupMentions",[])}get messagesLoader(){return new O.default((0,n.getOwner)(this),this.args.channel)}get messagesManager(){return this.args.channel.messagesManager}get currentUserMembership(){return this.args.channel.currentUserMembership}get hasSavedScrollPosition(){return!!this.chatChannelScrollPositions.get(this.args.channel.id)}setScrollable(e){this.scrollable=e}teardown(){document.removeEventListener("keydown",this._autoFocus),ze(this,ve,Se).call(this),(0,b.removeOnPresenceChange)(this.onPresenceChangeCallback),this.subscriptionManager.teardown()}didResizePane(){this.debounceFillPaneAttempt(),k.default.apply(this.scrollable)}setup(e){this.uploadDropZone=e,document.addEventListener("keydown",this._autoFocus),(0,b.onPresenceChange)({callback:this.onPresenceChangeCallback}),this.messagesManager.clear(),this.args.channel.isDirectMessageChannel&&!this.args.channel.isFollowing&&this.chatChannelsManager.follow(this.args.channel),this.args.channel.draft=this.chatDraftsManager.get(this.args.channel?.id)||P.default.createDraftMessage(this.args.channel,{user:this.currentUser}),this.composer.focus(),this.loadMessages(),this.args.channel.updateLastViewedAt()}loadMessages(){this.args.channel?.id&&(this.subscriptionManager=new j.default(this,this.args.channel,{onNewMessage:this.onNewMessage}),this.args.targetMessageId?this.debounceHighlightOrFetchMessage(this.args.targetMessageId):this.chatChannelScrollPositions.get(this.args.channel.id)?this.debounceHighlightOrFetchMessage(this.chatChannelScrollPositions.get(this.args.channel.id)):this.fetchMessages({fetch_from_last_read:!0}))}onNewMessage(e){(0,z.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages([e])})),this.debouncedUpdateLastReadMessage()}onPresenceChangeCallback(e){e&&(this.debouncedUpdateLastReadMessage(),(0,z.bodyScrollFix)({delayed:!0}))}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear()
const t=await this.messagesLoader.load(e)
if(this.messagesManager.messages=this.processMessages(this.args.channel,t),e.target_message_id)this.scrollToMessageId(e.target_message_id,{highlight:!0,position:e.position})
else if(e.fetch_from_last_read){const e=this.currentUserMembership?.lastReadMessageId
this.scrollToMessageId(e)}else e.target_date?this.scrollToMessageId(t.meta.target_message_id,{highlight:!0,position:"center"}):(this._ignoreNextScroll=!0,this.scrollToBottom())
this.debounceFillPaneAttempt(),this.debouncedUpdateLastReadMessage()}async fetchMoreMessages(e){let{direction:t}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
if(this.messagesLoader.loading)return
const n=await this.messagesLoader.loadMore({direction:t})
if(!n)return
const r=this.processMessages(this.args.channel,n)
if(!r.length)return
const a=this.messagesManager.messages.lastObject.id;(0,z.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(r)})),t!==M.FUTURE||i.noScroll||this.scrollToMessageId(a,{position:"end",forceAuto:!0}),this.debounceFillPaneAttempt()}scrollToBottom(){this._ignoreNextScroll=!0,(0,S.scrollListToBottom)(this.scrollable)}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,S.scrollListToMessage)(this.scrollable,i,t)}debounceFillPaneAttempt(){this._debouncedFillPaneAttemptHandler=(0,f.default)(this,this.fillPaneAttempt,500)}fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:M.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}async fillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this.messagesManager.messages.length>200||this.messagesLoader.canLoadMorePast&&(0,c.schedule)("afterRender",(()=>{const e=this.messagesManager.messages.firstObject?.id,t=this.scrollable.querySelector(`.chat-message-container[data-id="${e}"]`)
t&&(0,C.checkMessageTopVisibility)(this.scrollable,t)&&this.fetchMoreMessages({direction:M.PAST})})))}processMessages(e,t){const i=[]
let n=!1
const r=this.messagesManager.messages.some((e=>e.newest))
return t?.messages?.forEach(((a,s)=>{a.firstOfResults=0===s,this.currentUser.ignored_users&&(a.hidden=this.currentUser.ignored_users.includes(a.user.username)),this.requestedTargetMessageId===a.id?a.expanded=!a.hidden:a.expanded=!(a.hidden||a.deleted_at),!r&&!n&&a.id>this.currentUserMembership?.lastReadMessageId&&(n=!0,a.newest=!0)
const o=P.default.create(e,a)
o.manager=e.messagesManager,o.thread&&ze(this,ye,Pe).call(this,o.thread,t.tracking.thread_tracking),i.push(o)})),i}debounceHighlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._debouncedHighlightOrFetchMessageHandler=(0,f.default)(this,this.highlightOrFetchMessage,e,t,100)}highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const i=this.messagesManager.findMessage(e)
i?this.scrollToMessageId(i.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e,position:"end"})}debouncedUpdateLastReadMessage(){this._debouncedUpdateLastReadMessageHandler=(0,f.default)(this,this.updateLastReadMessage,M.READ_INTERVAL_MS)}updateLastReadMessage(){this.args.channel.isFollowing&&(0,c.schedule)("afterRender",(()=>{let e=null
if(this.scrollable.querySelectorAll(".chat-message-container").forEach((t=>{(0,C.checkMessageBottomVisibility)(this.scrollable,t)&&(e=t)})),!e)return
let t=this.messagesManager.findMessage(e.dataset.id)
if(!t)return
const i=this.args.channel.currentUserMembership?.lastReadMessageId
return i>t.id?void 0:this.chatApi.markChannelAsRead(this.args.channel.id,t.id)}))}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom(this.scrollable)}onScroll(e){(0,c.next)((()=>{ze(this,we,Te).call(this)||((0,z.bodyScrollFix)(),k.default.apply(this.scrollable),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debouncedUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:M.PAST}):e.atBottom&&this.fetchMoreMessages({direction:M.FUTURE}))}))}onScrollEnd(e){(0,p.resetIdle)(),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.atBottom=e.atBottom,e.atBottom?(this.fetchMoreMessages({direction:M.FUTURE}),this.chatChannelScrollPositions.delete(this.args.channel.id)):this.chatChannelScrollPositions.set(this.args.channel.id,e.lastVisibleId)}async onSendMessage(e){await e.cook(),e.editing?await ze(this,ge,Ce).call(this,e):await ze(this,fe,ke).call(this,e)}resetComposerMessage(){this.args.channel.resetDraft(this.currentUser)}_onSendError(e,t){const i=this.args.channel.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?(i.message="",i.cooked="",i.error=t.jqXHR.responseJSON.errors[0]):(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}resendStagedMessage(e){this.pane.sending=!0,e.error=null
const t={cooked:e.cooked,message:e.message,upload_ids:e.uploads.map((e=>e.id)),staged_id:e.id}
this.chatApi.sendMessage(this.args.channel.id,t).catch((e=>{this._onSendError(t.staged_id,e)})).then((()=>{this.chat.markNetworkAsReliable()})).finally((()=>{this.pane.sending=!1}))}onCloseFullScreen(){this.chatStateManager.prefersDrawer(),m.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{m.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}_autoFocus(e){if(this.chatStateManager.isDrawerActive)return
const{key:t,metaKey:i,ctrlKey:n,code:r,target:a}=e
!t||t.length>1||i||n||"Space"===r||"?"===t||a&&!/^(INPUT|TEXTAREA|SELECT)$/.test(a.tagName)&&(e.preventDefault(),this.composer.focus({addText:e.key}))}},(0,W.setComponentTemplate)((0,B.createTemplateFactory)({id:"JVIiKFDg",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-channel",[52,[30,0,["messagesLoader","loading"]],"loading"],[52,[30,0,["pane","sending"]],"chat-channel--sending"],[52,[30,0,["hasSavedScrollPosition"]],"chat-channel--saved-scroll-position"],[52,[51,[30,0,["messagesLoader","fetchedOnce"]]],"chat-channel--not-loaded-once"]],null]],[16,"data-id",[30,1,["id"]]],[4,[32,1],[[30,0,["teardown"]]],null],[4,[32,2],[[30,0,["setup"]]],null],[4,[32,3],[[30,0,["loadMessages"]],[30,2]],null],[12],[1,"\\n\\n      "],[8,[32,4],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[8,[32,5],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[8,[32,6],null,null,null],[1,"\\n\\n      "],[11,0],[24,0,"chat-messages-scroll chat-messages-container popper-viewport"],[4,[32,2],[[30,0,["setScrollable"]]],null],[4,[32,7],[[28,[32,8],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n        "],[11,0],[24,0,"chat-messages-container"],[4,[32,9],[[30,0,["didResizePane"]],[28,[32,8],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"            "],[8,[32,10],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,3],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"channel"]],null],[1,"\\n"]],[3]],[[[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[1,"              "],[8,[32,11],null,null,null],[1,"\\n"]],[]],null]],[]]],[1,"        "],[13],[1,"\\n\\n"],[41,[30,0,["messagesLoader","loadedPast"]],[[[1,"          "],[10,0],[14,0,"all-loaded-message"],[12],[1,"\\n            "],[1,[28,[32,12],["chat.all_loaded"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[8,[32,13],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["pane","selectingMessages"]],[[[1,"        "],[8,[32,14],null,[["@enableMove","@pane"],[[28,[32,15],[[28,[32,16],[[30,1,["isDirectMessageChannel"]]],null],[30,1,["canModerate"]]],null],[30,0,["pane"]]]],null],[1,"\\n"]],[]],[[[41,[28,[32,15],[[28,[32,16],[[30,1,["isFollowing"]]],null],[30,1,["isCategoryChannel"]]],null],[[[1,"          "],[8,[32,17],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,18],null,[["@channel","@uploadDropZone","@onSendMessage"],[[30,1],[30,0,["uploadDropZone"]],[30,0,["onSendMessage"]]]],null],[1,"\\n"]],[]]]],[]]],[1,"\\n      "],[8,[32,19],null,[["@model"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@targetMessageId","message"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel.js",scope:()=>[d.default,l.default,s.default,o.default,_.default,U.default,I.default,E.default,r.hash,T.default,L.default,R.default,g.default,D.default,A.default,y.default,w.default,N.default,x.default,F.default],isStrictMode:!0}),be),G=Oe((V=be).prototype,"appEvents",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=Oe(V.prototype,"capabilities",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Oe(V.prototype,"chat",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Oe(V.prototype,"chatApi",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=Oe(V.prototype,"chatChannelsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Oe(V.prototype,"chatComposerPresenceManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=Oe(V.prototype,"chatDraftsManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=Oe(V.prototype,"chatEmojiPickerManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Oe(V.prototype,"chatStateManager",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Oe(V.prototype,"chatChannelScrollPositions",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Oe(V.prototype,"composer",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Oe(V.prototype,"pane",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Oe(V.prototype,"currentUser",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=Oe(V.prototype,"messageBus",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=Oe(V.prototype,"router",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=Oe(V.prototype,"site",[u.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=Oe(V.prototype,"sending",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ce=Oe(V.prototype,"showChatQuoteSuccess",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ue=Oe(V.prototype,"includeHeader",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),de=Oe(V.prototype,"needsArrow",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),he=Oe(V.prototype,"atBottom",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pe=Oe(V.prototype,"uploadDropZone",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=Oe(V.prototype,"isScrolling",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Oe(V.prototype,"messagesLoader",[i.cached],Object.getOwnPropertyDescriptor(V.prototype,"messagesLoader"),V.prototype),Oe(V.prototype,"setScrollable",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"setScrollable"),V.prototype),Oe(V.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"teardown"),V.prototype),Oe(V.prototype,"didResizePane",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"didResizePane"),V.prototype),Oe(V.prototype,"setup",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"setup"),V.prototype),Oe(V.prototype,"loadMessages",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"loadMessages"),V.prototype),Oe(V.prototype,"onNewMessage",[v.bind],Object.getOwnPropertyDescriptor(V.prototype,"onNewMessage"),V.prototype),Oe(V.prototype,"onPresenceChangeCallback",[v.bind],Object.getOwnPropertyDescriptor(V.prototype,"onPresenceChangeCallback"),V.prototype),Oe(V.prototype,"scrollToBottom",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"scrollToBottom"),V.prototype),Oe(V.prototype,"fetchMessagesByDate",[v.bind],Object.getOwnPropertyDescriptor(V.prototype,"fetchMessagesByDate"),V.prototype),Oe(V.prototype,"processMessages",[v.bind],Object.getOwnPropertyDescriptor(V.prototype,"processMessages"),V.prototype),Oe(V.prototype,"scrollToLatestMessage",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"scrollToLatestMessage"),V.prototype),Oe(V.prototype,"onScroll",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"onScroll"),V.prototype),Oe(V.prototype,"onScrollEnd",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"onScrollEnd"),V.prototype),Oe(V.prototype,"onSendMessage",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"onSendMessage"),V.prototype),Oe(V.prototype,"resetComposerMessage",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"resetComposerMessage"),V.prototype),Oe(V.prototype,"resendStagedMessage",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"resendStagedMessage"),V.prototype),Oe(V.prototype,"onCloseFullScreen",[a.action],Object.getOwnPropertyDescriptor(V.prototype,"onCloseFullScreen"),V.prototype),Oe(V.prototype,"_autoFocus",[v.bind],Object.getOwnPropertyDescriptor(V.prototype,"_autoFocus"),V.prototype),V)
async function Ce(e){this.pane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{(0,z.stackingContextFix)(this.scrollable,(async()=>{await this.chatApi.editMessage(this.args.channel.id,e.id,t)}))}catch(i){(0,h.popupAjaxError)(i)}finally{e.editing=!1,this.pane.sending=!1}}async function ke(e){this.pane.sending=!0,(0,p.resetIdle)(),(0,z.stackingContextFix)(this.scrollable,(async()=>{await this.args.channel.stageMessage(e)})),e.manager=this.args.channel.messagesManager,this.resetComposerMessage(),this.capabilities.isIOS||this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{await this.chatApi.sendMessage(this.args.channel.id,{message:e.message,in_reply_to_id:e.inReplyTo?.id,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id))}),this.capabilities.isIOS||this.scrollToLatestMessage()}catch(t){this._onSendError(e.id,t)}finally{this.pane.sending=!1}}function Se(){(0,c.cancel)(this._debouncedHighlightOrFetchMessageHandler),(0,c.cancel)(this._debouncedUpdateLastReadMessageHandler),(0,c.cancel)(this._debouncedFillPaneAttemptHandler)}function Pe(e,t){t[e.id]&&(e.tracking.unreadCount=t[e.id].unread_count,e.tracking.mentionCount=t[e.id].mention_count)}function Te(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}})),define("discourse/plugins/chat/discourse/components/chat-composer-dropdown",["exports","@glimmer/component","@ember/helper","@ember/object","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/i18n","float-kit/components/d-menu","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{onButtonClick(e,t){t(),e.action()}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"6zsHNoy8",block:'[[[1,"\\n"],[41,[30,1,["length"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["chat-composer-dropdown__trigger-btn","btn-flat",[52,[30,2],"has-active-panel"]],null]],[17,3]],[["@title","@icon","@disabled","@arrow","@placements","@identifier"],[[28,[32,2],["chat.composer.toggle_toolbar"],null],"plus",[30,4],true,[28,[32,3],["top","bottom"],null],"chat-composer-dropdown__menu"]],[["default"],[[[[1,"\\n        "],[10,"ul"],[14,0,"chat-composer-dropdown__list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1]],null]],null],null,[[[1,"            "],[10,"li"],[15,0,[28,[32,1],["chat-composer-dropdown__item",[30,6,["id"]]],null]],[12],[1,"\\n              "],[8,[32,4],[[16,0,[28,[32,1],["chat-composer-dropdown__action-btn",[30,6,["id"]]],null]]],[["@icon","@action","@label"],[[30,6,["icon"]],[28,[32,5],[[30,0,["onButtonClick"]],[30,6],[30,5,["close"]]],null],[30,6,["label"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[6]],null],[1,"        "],[13],[1,"\\n      "]],[5]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@buttons","@hasActivePanel","&attrs","@isDisabled","menu","button"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-dropdown.js",scope:()=>[o.default,a.default,s.default,i.array,r.default,i.fn],isStrictMode:!0}),d),h=(u=d).prototype,p="onButtonClick",m=[n.action],b=Object.getOwnPropertyDescriptor(u.prototype,"onButtonClick"),g=u.prototype,f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),u)
var h,p,m,b,g,f})),define("discourse/plugins/chat/discourse/components/chat-composer-message-details",["exports","discourse/components/d-button","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-common/helpers/html-safe","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"oLWhXUGN",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-message-details"],[15,"data-id",[30,1,["id"]]],[15,"data-action",[52,[30,1,["editing"]],"edit","reply"]],[12],[1,"\\n    "],[10,0],[14,0,"chat-reply"],[12],[1,"\\n      "],[1,[28,[32,0],[[52,[30,1,["editing"]],"pencil-alt","reply"]],null]],[1,"\\n      "],[8,[32,1],null,[["@user"],[[30,1,["user"]]]],null],[1,"\\n      "],[10,1],[14,0,"chat-reply__username"],[12],[1,[30,1,["user","username"]]],[13],[1,"\\n      "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n        "],[1,[28,[32,2],[[28,[32,3],[[30,1,["excerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,4],[[24,0,"btn-flat cancel-message-action"]],[["@action","@icon","@title"],[[30,2],"times-circle","cancel"]],null],[1,"\\n  "],[13],[1,"\\n"]],["@message","@cancelAction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-message-details.js",scope:()=>[n.default,a.default,i.default,r.default,t.default],isStrictMode:!0}),(0,l.default)())
e.default=c})),define("discourse/plugins/chat/discourse/components/chat-composer-upload",["exports","@glimmer/component","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/uploads","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{get isImage(){return(0,r.isImage)(this.args.upload.original_filename||this.args.upload.fileName)}get fileName(){return this.args.isDone?this.args.upload.original_filename:this.args.upload.fileName}}e.default=u,c=u,(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"rCReWXpI",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-composer-upload",[52,[30,0,["isImage"]],"chat-composer-upload--image"],[52,[51,[30,2]],"chat-composer-upload--in-progress"]],null]],[12],[1,"\\n        "],[10,0],[14,0,"preview"],[12],[1,"\\n"],[41,[30,0,["isImage"]],[[[41,[30,2],[[[1,"              "],[10,"img"],[14,0,"preview-img"],[15,"src",[30,1,["short_path"]]],[12],[13],[1,"\\n"]],[]],[[[1,"              "],[1,[28,[32,1],["far-image"],null]],[1,"\\n"]],[]]]],[]],[[[1,"            "],[1,[28,[32,1],["file-alt"],null]],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n\\n        "],[10,1],[14,0,"data"],[12],[1,"\\n"],[41,[51,[30,0,["isImage"]]],[[[1,"            "],[10,0],[14,0,"top-data"],[12],[1,"\\n              "],[10,1],[14,0,"file-name"],[12],[1,[30,0,["fileName"]]],[13],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,0],[14,0,"bottom-data"],[12],[1,"\\n"],[41,[30,2],[[[41,[51,[30,0,["isImage"]]],[[[1,"                "],[10,1],[14,0,"extension-pill"],[12],[1,[30,1,["extension"]]],[13],[1,"\\n"]],[]],null]],[]],[[[41,[30,1,["processing"]],[[[1,"                "],[10,1],[14,0,"processing"],[12],[1,[28,[32,2],["processing"],null]],[13],[1,"\\n"]],[]],[[[1,"                "],[10,1],[14,0,"uploading"],[12],[1,[28,[32,2],["uploading"],null]],[13],[1,"\\n"]],[]]],[1,"\\n              "],[10,"progress"],[14,0,"upload-progress"],[14,1,"file"],[14,"max","100"],[15,2,[30,1,["progress"]]],[12],[13],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,3],[[24,0,"btn-flat chat-composer-upload__remove-btn"]],[["@action","@icon","@title"],[[30,3],"times","chat.remove_upload"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@upload","@isDone","@onCancel"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-upload.js",scope:()=>[n.default,a.default,s.default,i.default],isStrictMode:!0}),c)})),define("discourse/plugins/chat/discourse/components/chat-composer-uploads",["exports","@ember/component","@ember/object","@ember/service","discourse/lib/uppy-media-optimization-plugin","discourse/lib/utilities","discourse/mixins/uppy-upload","discourse-common/lib/object","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,c.createTemplateFactory)({id:"FoGAB5VV",block:'[[[41,[30,0,["showUploadsContainer"]],[[[1,"  "],[10,0],[14,0,"chat-composer-uploads-container"],[12],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["uploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@isDone","@onCancel"],[[30,1],true,[28,[37,4],[[30,0],"removeUpload",[30,1]],null]]],null],[1,"\\n"]],[1]],null],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["inProgressUploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@onCancel"],[[30,2],[28,[37,4],[[30,0],"cancelUploading",[30,2]],null]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[8,[39,5],null,[["@allowMultiple","@fileInputId","@fileInputClass"],[true,[30,0,["fileUploadElementId"]],"hidden-upload-field"]],null]],["upload","upload"],false,["if","each","-track-array","chat-composer-upload","action","pick-files-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-uploads.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(p,t.default.extend(s.default,(u=(0,l.default)("uploads.length","inProgressUploads.length"),d={classNames:["chat-composer-uploads"],mediaOptimizationWorker:(0,n.inject)(),chatStateManager:(0,n.inject)(),id:"chat-composer-uploader",type:"chat-composer",existingUploads:null,uploads:null,useMultipartUploadsIfAvailable:!0,uploadDropZone:null,init(){this._super(...arguments),this.setProperties({fileInputSelector:`#${this.fileUploadElementId}`})},didReceiveAttrs(){this._super(...arguments),this.inProgressUploads?.length>0&&this._uppyInstance?.cancelAll(),this.set("uploads",this.existingUploads?(0,o.cloneJSON)(this.existingUploads):[])},didInsertElement(){this._super(...arguments),this.composerInputEl?.addEventListener("paste",this._pasteEventListener)},willDestroyElement(){this._super(...arguments),this.composerInputEl?.removeEventListener("paste",this._pasteEventListener)},uploadDone(e){this.uploads.pushObject(e),this._triggerUploadsChanged()},showUploadsContainer:(e,t)=>e>0||t>0,cancelUploading(e){this.appEvents.trigger(`upload-mixin:${this.id}:cancel-upload`,{fileId:e.id}),this.removeUpload(e)},removeUpload(e){this.uploads.removeObject(e),this._triggerUploadsChanged()},_uploadDropTargetOptions(){return{target:this.uploadDropZone||document.body}},_uppyReady(){this.siteSettings.composer_media_optimization_image_enabled&&this._useUploadPlugin(r.default,{optimizeFn:(e,t)=>this.mediaOptimizationWorker.optimizeImage(e,t),runParallel:!this.site.isMobileDevice}),this._onPreProcessProgress((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.processing||t?.set("processing",!0)})),this._onPreProcessComplete((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.set("processing",!1)}))},_pasteEventListener(e){if(document.activeElement!==this.composerInputEl)return
const{canUpload:t,canPasteHtml:i,types:n}=(0,a.clipboardHelpers)(e,{siteSettings:this.siteSettings,canUpload:!0})
!t||i||n.includes("text/plain")||e&&e.clipboardData&&e.clipboardData.files&&this._addFiles([...e.clipboardData.files],{pasted:!0})},onProgressUploadsChanged(){this._triggerUploadsChanged(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})},_triggerUploadsChanged(){this.onUploadChanged?.(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})}},h(d,"showUploadsContainer",[u],Object.getOwnPropertyDescriptor(d,"showUploadsContainer"),d),h(d,"cancelUploading",[i.action],Object.getOwnPropertyDescriptor(d,"cancelUploading"),d),h(d,"removeUpload",[i.action],Object.getOwnPropertyDescriptor(d,"removeUpload"),d),h(d,"_pasteEventListener",[l.bind],Object.getOwnPropertyDescriptor(d,"_pasteEventListener"),d),d)))})),define("discourse/plugins/chat/discourse/components/chat-composer",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/application","@ember/object","@ember/runloop","@ember/service","@ember/utils","jquery","pretty-text/emoji","pretty-text/emoji/data","rsvp","discourse/components/modal/insert-hyperlink","discourse/lib/autocomplete","discourse/lib/hashtag-autocomplete","discourse/lib/text","discourse/lib/user-search","discourse/lib/user-status-on-autocomplete","discourse-common/lib/object","discourse-common/lib/raw-templates","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/channel-summary","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/lib/textarea-interactor","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O,C){"use strict"
var k,S,P,T,E,x,D,A,N,I,L,U,R,F,B,W,H,$,V,G,q,K,J,Y
function Z(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function X(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Q(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ee(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const te=(0,C.createTemplateFactory)({id:"h27tq99D",block:'[[[1,"\\n"],[10,0],[14,0,"chat-composer__wrapper"],[12],[1,"\\n"],[41,[30,0,["shouldRenderMessageDetails"]],[[[1,"    "],[8,[39,1],null,[["@message","@cancelAction"],[[52,[30,0,["draft","editing"]],[30,0,["draft"]],[30,0,["draft","inReplyTo"]]],[30,0,["resetDraft"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.composer"],null]],[16,0,[28,[37,3],["chat-composer",[52,[30,0,["isFocused"]],"is-focused"],[52,[30,0,["pane","sending"]],"is-sending"],[52,[30,0,["sendEnabled"]],"is-send-enabled","is-send-disabled"],[52,[30,0,["disabled"]],"is-disabled","is-enabled"],[52,[30,0,["draft","draftSaved"]],"is-draft-saved","is-draft-unsaved"]],null]],[4,[38,4],[[30,0,["didUpdateMessage"]],[30,0,["draft"]]],null],[4,[38,4],[[30,0,["didUpdateInReplyTo"]],[30,0,["draft","inReplyTo"]]],null],[4,[38,5],[[30,0,["setup"]]],null],[4,[38,6],[[30,0,["teardown"]]],null],[4,[38,6],[[30,0,["cancelPersistDraft"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-composer__outer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-composer__inner-container"],[12],[1,"\\n        "],[8,[39,7],null,[["@buttons","@isDisabled"],[[30,0,["dropdownButtons"]],[30,0,["disabled"]]]],null],[1,"\\n\\n        "],[11,0],[24,0,"chat-composer__input-container"],[4,[38,8],["click",[30,0,["composer","focus"]]],null],[12],[1,"\\n          "],[8,[39,9],[[16,1,[30,0,["composerId"]]],[16,2,[28,[37,10],[[30,0,["draft","message"]]],null]],[24,0,"chat-composer__input"],[16,"disabled",[30,0,["disabled"]]],[24,"autocorrect","on"],[24,"autocapitalize","sentences"],[16,"placeholder",[30,0,["placeholder"]]],[16,"rows",1],[16,"data-chat-composer-context",[30,0,["context"]]],[24,4,"text"],[4,[38,5],[[30,0,["setupTextareaInteractor"]]],null],[4,[38,8],["input",[30,0,["onInput"]]],null],[4,[38,8],["keydown",[30,0,["onKeyDown"]]],null],[4,[38,8],["focusin",[30,0,["onTextareaFocusIn"]]],null],[4,[38,8],["focusin",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["focusout",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null],[4,[38,5],[[30,0,["setupAutocomplete"]]],null]],null,null],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,0,["inlineButtons","length"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["inlineButtons"]]],null]],null],null,[[[1,"            "],[8,[39,14],[[16,0,[29,["-",[30,1,["id"]]]]],[16,"disabled",[28,[37,15],[[30,0,["disabled"]],[30,1,["disabled"]]],null]],[16,"tabindex",[52,[30,1,["disabled"]],-1,0]],[4,[38,8],["click",[28,[37,11],[[30,0,["handleInlineButtonAction"]],[30,1,["action"]]],null]],[["bubbles"],[false]]],[4,[38,8],["focus",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],[[30,1,["icon"]]]],null],[1,"\\n"]],[1]],null],[1,"\\n          "],[8,[39,16],null,null,null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[39,14],[[24,0,"-send"],[16,"title",[28,[37,2],["chat.composer.send"],null]],[16,"disabled",[28,[37,15],[[30,0,["disabled"]],[28,[37,17],[[30,0,["sendEnabled"]]],null]],null]],[16,"tabindex",[52,[30,0,["sendEnabled"]],0,-1]],[4,[38,8],["click",[30,0,["onSend"]]],null],[4,[38,8],["mousedown",[30,0,["trapMouseDown"]]],null],[4,[38,8],["focus",[28,[37,11],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,11],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],["paper-plane"]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["canAttachUploads"]],[[[1,"    "],[8,[39,18],null,[["@fileUploadElementId","@onUploadChanged","@existingUploads","@uploadDropZone","@composerInputEl"],[[30,0,["fileUploadElementId"]],[30,0,["onUploadChanged"]],[30,0,["draft","uploads"]],[30,2],[30,0,["composer","textarea","element"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[10,0],[14,0,"chat-replying-indicator-container"],[12],[1,"\\n    "],[8,[39,19],null,[["@presenceChannelName"],[[30,0,["presenceChannelName"]]]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,20],null,[["@context","@didSelectEmoji"],[[30,0,["context"]],[30,0,["onSelectEmoji"]]]],null],[1,"\\n"],[13]],["button","@uploadDropZone"],false,["if","chat-composer-message-details","i18n","concat-class","did-update","did-insert","will-destroy","chat-composer-dropdown","on","d-textarea","readonly","fn","each","-track-array","chat/composer/button","or","chat/composer/separator","not","chat-composer-uploads","chat-replying-indicator","chat-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer.hbs",isStrictMode:!1})
let ie=e.default=(V=new WeakSet,G=new WeakSet,q=new WeakSet,K=new WeakSet,J=new WeakSet,Y=new WeakSet,k=class extends i.default{constructor(){super(...arguments),X(this,Y),X(this,J),X(this,K),X(this,q),X(this,G),X(this,V),Z(this,"capabilities",S,this),Z(this,"site",P,this),Z(this,"siteSettings",T,this),Z(this,"store",E,this),Z(this,"chat",x,this),Z(this,"chatComposerPresenceManager",D,this),Z(this,"chatComposerWarningsTracker",A,this),Z(this,"appEvents",N,this),Z(this,"chatEmojiReactionStore",I,this),Z(this,"chatEmojiPickerManager",L,this),Z(this,"currentUser",U,this),Z(this,"chatApi",R,this),Z(this,"chatDraftsManager",F,this),Z(this,"modal",B,this),Z(this,"isFocused",W,this),Z(this,"inProgressUploadsCount",H,this),Z(this,"presenceChannelName",$,this)}get shouldRenderMessageDetails(){return this.draft?.editing||"channel"===this.context&&this.draft?.inReplyTo}get inlineButtons(){return(0,M.chatComposerButtons)(this,"inline",this.context)}get dropdownButtons(){return(0,M.chatComposerButtons)(this,"dropdown",this.context)}get fileUploadElementId(){return this.context+"-file-uploader"}get canAttachUploads(){return this.siteSettings.chat_allow_uploads&&(0,l.isPresent)(this.args.uploadDropZone)}persistDraft(){}setupAutocomplete(e){const t=(0,c.default)(e)
Q(this,G,re).call(this,t),Q(this,K,se).call(this,t),Q(this,q,ae).call(this,t)}setupTextareaInteractor(e){this.composer.textarea=new O.default((0,r.getOwner)(this),e),this.site.desktopView&&this.args.autofocus&&this.composer.focus({ensureAtEnd:!0,refreshHeight:!0})}didUpdateMessage(){this.cancelPersistDraft(),this.composer.textarea.value=this.draft.message,this.persistDraft(),this.captureMentions({skipDebounce:!0})}didUpdateInReplyTo(){this.cancelPersistDraft(),this.persistDraft()}cancelPersistDraft(){(0,s.cancel)(this._persistHandler)}handleInlineButtonAction(e,t){t.stopPropagation(),e()}get hasContent(){const e=this.siteSettings.chat_minimum_message_length||1
return this.draft?.message?.length>=e||this.canAttachUploads&&this.hasUploads}get hasUploads(){return this.draft?.uploads?.length>0}get sendEnabled(){return(this.hasContent||this.draft?.editing)&&!this.pane.sending&&!this.inProgressUploadsCount>0}setup(){this.appEvents.on("chat:modify-selection",this,"modifySelection"),this.appEvents.on("chat:open-insert-link-modal",this,"openInsertLinkModal")}teardown(){this.appEvents.off("chat:modify-selection",this,"modifySelection"),this.appEvents.off("chat:open-insert-link-modal",this,"openInsertLinkModal"),this.pane.sending=!1}insertDiscourseLocalDate(){const e=require("discourse/plugins/discourse-local-dates/discourse/components/modal/local-dates-create").default
this.modal.show(e,{model:{insertDate:e=>{this.composer.textarea.addText(this.composer.textarea.getSelected(),e),this.composer.focus()}}})}uploadClicked(){document.querySelector(`#${this.fileUploadElementId}`).click()}computeIsFocused(e){(0,s.next)((()=>{this.isFocused=e}))}onInput(e){this.draft.draftSaved=!1,this.draft.message=e.target.value,this.composer.textarea.refreshHeight(),this.reportReplyingPresence(),this.persistDraft(),this.captureMentions()}onUploadChanged(e,t){let{inProgressUploadsCount:i}=t
this.draft.draftSaved=!1,this.inProgressUploadsCount=i||0,void 0!==e&&"undefined"!==i&&0===i&&this.draft&&(this.draft.uploads=(0,y.cloneJSON)(e)),this.composer.textarea?.focus(),this.reportReplyingPresence(),this.persistDraft()}trapMouseDown(e){e?.preventDefault()}async onSend(e){this.sendEnabled&&(e?.preventDefault(),!this.draft.editing||this.hasUploads||0!==this.draft.message.length?(await this.args.onSendMessage(this.draft),this.composer.textarea.refreshHeight()):Q(this,Y,le).call(this))}reportReplyingPresence(){this.args.channel&&this.draft&&this.chatComposerPresenceManager.notifyState(this.presenceChannelName,!this.draft.editing&&this.hasContent)}modifySelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:null,context:null}
if(t.context!==this.context)return
const i=this.composer.textarea.getSelected("",{lineVal:!0})
"bold"===t.type?this.composer.textarea.applySurround(i,"**","**","bold_text"):"italic"===t.type?this.composer.textarea.applySurround(i,"_","_","italic_text"):"code"===t.type&&this.composer.textarea.applySurround(i,"`","`","code_text")}onTextareaFocusIn(e){this.capabilities.isIOS&&((e=this.composer.textarea.textarea).style.transform="translateY(-99999px)",e.focus(),window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{e.style.transform=""}))})))}onKeyDown(e){if(!(this.site.mobileView||e.altKey||e.metaKey||Q(this,J,oe).call(this))){if("Escape"===e.key&&!e.shiftKey)return this.handleEscape(e)
if("Enter"===e.key){if(e.shiftKey)return
if(!e.ctrlKey){const{pre:e}=this.composer.textarea.getSelected({lineVal:!0})
if(this.composer.textarea.isInside(e,/(^|\n)```/g))return}return this.onSend(),e.preventDefault(),!1}if("ArrowUp"===e.key&&!this.hasContent&&!this.draft.editing)if(e.shiftKey&&this.lastMessage?.replyable)this.composer.replyTo(this.lastMessage)
else{const e=this.lastUserMessage(this.currentUser)
e?.editable&&(this.composer.edit(e),this.args.channel.draft=e)}}}openInsertLinkModal(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{context:null}).context!==this.context)return
const t=this.composer.textarea.getSelected("",{lineVal:!0}),i=t?.value
this.modal.show(p.default,{model:{linkText:i,toolbarEvent:{addText:e=>this.composer.textarea.addText(t,e)}}})}onSelectEmoji(e){const t=`:${e}:`
this.chatEmojiReactionStore.track(t),this.composer.textarea.addText(this.composer.textarea.getSelected(),t),this.site.desktopView?this.composer.focus():this.chatEmojiPickerManager.close()}captureMentions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{skipDebounce:!1}
this.hasContent?this.chatComposerWarningsTracker.trackMentions(this.draft,e.skipDebounce):this.chatComposerWarningsTracker.reset()}showChannelSummaryModal(){this.modal.show(j.default,{model:{channelId:this.args.channel.id}})}},S=ee(k.prototype,"capabilities",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=ee(k.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ee(k.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=ee(k.prototype,"store",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ee(k.prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ee(k.prototype,"chatComposerPresenceManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=ee(k.prototype,"chatComposerWarningsTracker",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=ee(k.prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ee(k.prototype,"chatEmojiReactionStore",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=ee(k.prototype,"chatEmojiPickerManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ee(k.prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ee(k.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ee(k.prototype,"chatDraftsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=ee(k.prototype,"modal",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ee(k.prototype,"isFocused",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=ee(k.prototype,"inProgressUploadsCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$=ee(k.prototype,"presenceChannelName",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee(k.prototype,"persistDraft",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"persistDraft"),k.prototype),ee(k.prototype,"setupAutocomplete",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"setupAutocomplete"),k.prototype),ee(k.prototype,"setupTextareaInteractor",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"setupTextareaInteractor"),k.prototype),ee(k.prototype,"didUpdateMessage",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"didUpdateMessage"),k.prototype),ee(k.prototype,"didUpdateInReplyTo",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"didUpdateInReplyTo"),k.prototype),ee(k.prototype,"cancelPersistDraft",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"cancelPersistDraft"),k.prototype),ee(k.prototype,"handleInlineButtonAction",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"handleInlineButtonAction"),k.prototype),ee(k.prototype,"setup",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"setup"),k.prototype),ee(k.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"teardown"),k.prototype),ee(k.prototype,"insertDiscourseLocalDate",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"insertDiscourseLocalDate"),k.prototype),ee(k.prototype,"uploadClicked",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"uploadClicked"),k.prototype),ee(k.prototype,"computeIsFocused",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"computeIsFocused"),k.prototype),ee(k.prototype,"onInput",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onInput"),k.prototype),ee(k.prototype,"onUploadChanged",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onUploadChanged"),k.prototype),ee(k.prototype,"trapMouseDown",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"trapMouseDown"),k.prototype),ee(k.prototype,"onSend",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onSend"),k.prototype),ee(k.prototype,"modifySelection",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"modifySelection"),k.prototype),ee(k.prototype,"onTextareaFocusIn",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onTextareaFocusIn"),k.prototype),ee(k.prototype,"onKeyDown",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onKeyDown"),k.prototype),ee(k.prototype,"openInsertLinkModal",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"openInsertLinkModal"),k.prototype),ee(k.prototype,"onSelectEmoji",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"onSelectEmoji"),k.prototype),ee(k.prototype,"captureMentions",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"captureMentions"),k.prototype),ee(k.prototype,"showChannelSummaryModal",[a.action],Object.getOwnPropertyDescriptor(k.prototype,"showChannelSummaryModal"),k.prototype),k)
function ne(e){const t=this.store.createRecord("user",e)
this.draft.mentionedUsers.set(t.id,t)}function re(e){this.siteSettings.enable_mentions&&e.autocomplete({template:(0,w.findRawTemplate)("user-selector-autocomplete"),key:"@",width:"100%",treatAsTextarea:!0,autoSelectFirstSuggestion:!0,transformComplete:e=>(e.isUser&&Q(this,V,ne).call(this,e),e.username||e.name),dataSource:e=>((0,v.destroyUserStatuses)(),(0,f.default)({term:e,includeGroups:!0}).then((e=>{if(e?.users?.length>0){const t=this.chat.presenceChannel.users?.mapBy("username")
e.users.forEach((e=>{t.includes(e.username)&&(e.cssClasses="is-online")})),(0,v.initUserStatusHtml)((0,r.getOwner)(this),e.users)}return e}))),onRender:e=>{(0,v.renderUserStatusHtml)(e)},afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus(),this.captureMentions()},onClose:v.destroyUserStatuses})}function ae(e){(0,b.setupHashtagAutocomplete)(this.site.hashtag_configurations["chat-composer"],e,this.siteSettings,{treatAsTextarea:!0,afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()}})}function se(e){this.siteSettings.enable_emoji&&e.autocomplete({template:(0,w.findRawTemplate)("emoji-selector-autocomplete"),key:":",afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()},treatAsTextarea:!0,onKeyUp:(e,t)=>{const i=/(?:^|[\s.\?,@\/#!%&*;:\[\]{}=\-_()])(:(?!:).?[\w-]*:?(?!:)(?:t\d?)?:?) ?$/gi.exec(e.substring(0,t))
if(i&&i[1])return[i[1]]},transformComplete:t=>t.code?(this.chatEmojiReactionStore.track(t.code),`${t.code}:`):(e.autocomplete({cancel:!0}),this.chatEmojiPickerManager.open({context:this.context,initialFilter:t.term}),""),dataSource:e=>new h.Promise((t=>{const i=`:${e}`
e=e.toLowerCase()
let n=Math.max(this.siteSettings.emoji_autocomplete_min_chars,2)
if(e.length<n)return t(m.SKIP)
if(!e.match(/[^-\{\}\[\]\(\)\*_\<\>\\\/].*[^-\{\}\[\]\(\)\*_\<\>\\\/]/))return t(m.SKIP)
if(""===e)return this.chatEmojiReactionStore.favorites.length?t(this.chatEmojiReactionStore.favorites.slice(0,5)):t(["slight_smile","smile","wink","sunny","blush"])
const r=this.site.custom_emoji_translation||{},a=Object.assign({},d.translations,r)
if(a[i])return t([a[i]])
const s=this.site.denied_emojis||[],o=e.match(/^:?(.*?):t([2-6])?$/)
if(o){const e=o[1],i=o[2]
if((0,u.isSkinTonableEmoji)(e)&&!s.includes(e))return t(i?[`${e}:t${i}`]:[2,3,4,5,6].map((t=>`${e}:t${t}`)))}return t((0,u.emojiSearch)(e,{maxResults:5,diversity:this.chatEmojiReactionStore.diversity,exclude:s}))})).then((e=>{if(e!==m.SKIP)return e.map((e=>({code:e,src:(0,g.emojiUrlFor)(e)})))})).then((t=>(t?.length&&t.push({label:_.default.t("composer.more_emoji"),term:e}),t)))})}function oe(){return document.querySelector(".autocomplete")}function le(){new z.default((0,r.getOwner)(this),this.draft,this.context).delete(),this.resetDraft()}(0,t.setComponentTemplate)(te,ie)})),define("discourse/plugins/chat/discourse/components/chat-drawer",["exports","@ember/component","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/url","discourse/lib/utilities","discourse-common/lib/get-url","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h
function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,u.createTemplateFactory)({id:"Km2Q7jFJ",block:'[[[41,[30,0,["chatStateManager","isDrawerActive"]],[[[1,"  "],[11,0],[16,"data-chat-channel-id",[30,0,["chat","activeChannel","id"]]],[16,"data-chat-thread-id",[30,0,["chat","activeChannel","activeThread","id"]]],[16,0,[28,[37,1],["chat-drawer",[52,[30,0,["chatStateManager","isDrawerExpanded"]],"is-expanded"]],null]],[16,5,[30,0,["drawerStyle"]]],[4,[38,2],[".chat-drawer-resizer",[30,0,["didResize"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-resizer"],[12],[13],[1,"\\n      "],[8,[30,0,["chatDrawerRouter","component"]],null,[["@params","@openURL","@openInFullPage","@toggleExpand","@close","@drawerActions"],[[30,0,["chatDrawerRouter","params"]],[30,0,["openURL"]],[30,0,["openInFullPage"]],[30,0,["toggleExpand"]],[30,0,["close"]],[30,0,["drawerActions"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","concat-class","chat/resizable-node"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(m,t.default.extend((d=(0,c.observes)("chatStateManager.isDrawerActive"),h={tagName:"",chat:(0,r.inject)(),router:(0,r.inject)(),chatDrawerSize:(0,r.inject)(),chatChannelsManager:(0,r.inject)(),chatStateManager:(0,r.inject)(),chatDrawerRouter:(0,r.inject)(),loading:!1,sizeTimer:null,rafTimer:null,hasUnreadMessages:!1,drawerStyle:null,didInsertElement(){this._super(...arguments),this.chat.userCanChat&&(this._checkSize(),this.appEvents.on("chat:open-url",this,"openURL"),this.appEvents.on("chat:toggle-close",this,"close"),this.appEvents.on("composer:closed",this,"_checkSize"),this.appEvents.on("composer:opened",this,"_checkSize"),this.appEvents.on("composer:resized",this,"_checkSize"),this.appEvents.on("composer:div-resizing",this,"_dynamicCheckSize"),window.addEventListener("resize",this._checkSize),this.appEvents.on("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.on("composer:resize-ended",this,"_clearDynamicCheckSize"),this.computeDrawerStyle())},willDestroyElement(){this._super(...arguments),this.chat.userCanChat&&(window.removeEventListener("resize",this._checkSize),this.appEvents&&(this.appEvents.off("chat:open-url",this,"openURL"),this.appEvents.off("chat:toggle-close",this,"close"),this.appEvents.off("composer:closed",this,"_checkSize"),this.appEvents.off("composer:opened",this,"_checkSize"),this.appEvents.off("composer:resized",this,"_checkSize"),this.appEvents.off("composer:div-resizing",this,"_dynamicCheckSize"),this.appEvents.off("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.off("composer:resize-ended",this,"_clearDynamicCheckSize")),this.sizeTimer&&((0,n.cancel)(this.sizeTimer),this.sizeTimer=null),this.rafTimer&&window.cancelAnimationFrame(this.rafTimer))},_fireHiddenAppEvents(){this.appEvents.trigger("chat:rerender-header")},computeDrawerStyle(){const{width:e,height:t}=this.chatDrawerSize.size
let i=`width: ${(0,o.escapeExpression)((e||"0").toString())}px;`
i+=`height: ${(0,o.escapeExpression)((t||"0").toString())}px;`,this.set("drawerStyle",(0,a.htmlSafe)(i))},get drawerActions(){return{openInFullPage:this.openInFullPage,close:this.close,toggleExpand:this.toggleExpand}},_dynamicCheckSize(){this.chatStateManager.isDrawerActive&&(this.rafTimer||(this.rafTimer=window.requestAnimationFrame((()=>{this.rafTimer=null,this._performCheckSize()}))))},_startDynamicCheckSize(){this.chatStateManager.isDrawerActive&&document.querySelector(".chat-drawer-outlet-container").classList.add("clear-transitions")},_clearDynamicCheckSize(){this.chatStateManager.isDrawerActive&&(document.querySelector(".chat-drawer-outlet-container").classList.remove("clear-transitions"),this._checkSize())},_checkSize(){this.sizeTimer=(0,n.throttle)(this,this._performCheckSize,150)},_performCheckSize(){if(this.isDestroying||this.isDestroyed)return
const e=document.querySelector(".chat-drawer-outlet-container")
if(!e)return
const t=document.getElementById("reply-control"),i=t.classList.contains("closed")
e.style.setProperty("--composer-right",(i?15:Math.max(15,t.offsetLeft))+"px")},openURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
this.chat.activeChannel=null,this.chatDrawerRouter.stateFor(this._routeFromURL(e)),this.chatStateManager.didOpenDrawer(e)},_routeFromURL(e){let t=this.router.recognize((0,l.default)(e||"/"))
return"index"===t.localName&&(t=t.parent),t},async openInFullPage(){return this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,await new Promise((e=>(0,n.next)(e))),s.default.routeTo(this.chatStateManager.lastKnownChatURL)},toggleExpand(){this.computeDrawerStyle(),this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)},close(){this.computeDrawerStyle(),this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null},didResize(e,t){let{width:i,height:n}=t
this.chatDrawerSize.size={width:i,height:n}}},p(h,"_fireHiddenAppEvents",[d],Object.getOwnPropertyDescriptor(h,"_fireHiddenAppEvents"),h),p(h,"_dynamicCheckSize",[c.bind],Object.getOwnPropertyDescriptor(h,"_dynamicCheckSize"),h),p(h,"_checkSize",[c.bind],Object.getOwnPropertyDescriptor(h,"_checkSize"),h),p(h,"openURL",[i.action],Object.getOwnPropertyDescriptor(h,"openURL"),h),p(h,"openInFullPage",[i.action],Object.getOwnPropertyDescriptor(h,"openInFullPage"),h),p(h,"toggleExpand",[i.action],Object.getOwnPropertyDescriptor(h,"toggleExpand"),h),p(h,"close",[i.action],Object.getOwnPropertyDescriptor(h,"close"),h),p(h,"didResize",[i.action],Object.getOwnPropertyDescriptor(h,"didResize"),h),h)))})),define("discourse/plugins/chat/discourse/components/chat-emoji-avatar",["exports","discourse/helpers/replace-emoji","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"jVj1V68A",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-emoji-avatar"],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-avatar-container"],[12],[1,"\\n      "],[1,[28,[32,0],[[30,1]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@emoji"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-emoji-avatar.js",scope:()=>[t.default],isStrictMode:!0}),(0,r.default)())
e.default=a}))
define("discourse/plugins/chat/discourse/components/chat-emoji-picker",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/text","discourse-common/config/environment","discourse-common/lib/debounce","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FITZPATRICK_MODIFIERS=void 0
const z=(0,h.createTemplateFactory)({id:"eJPIWM3x",block:'[[[1,"\\n"],[41,[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],[30,1]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-emoji-picker",[52,[30,0,["chatEmojiPickerManager","closing"]],"closing"]],null]],[17,2],[4,[38,3],[[30,0,["addClickOutsideEventListener"]]],null],[4,[38,3],[[30,0,["chatEmojiPickerManager","loadEmojis"]]],null],[4,[38,3],[[52,[30,3],[30,3],[28,[37,4],null,null]]],null],[4,[38,5],[[52,[30,4],[30,4],[28,[37,4],null,null]]],null],[4,[38,5],[[30,0,["removeClickOutsideEventListener"]]],null],[4,[38,6],["keydown",[30,0,["trapKeyDownEvents"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-picker__filter-container"],[12],[1,"\\n      "],[8,[39,7],[[16,"autofocus",true],[16,"placeholder",[28,[37,8],["chat.emoji_picker.search_placeholder"],null]],[4,[38,3],[[52,[30,0,["site","desktopView"]],[30,0,["focusFilter"]],[28,[37,4],null,null]]],null],[4,[38,3],[[28,[37,11],[[30,0,["didInputFilter"]],[30,0,["chatEmojiPickerManager","picker","initialFilter"]]],null]],null]],[["@value","@filterAction","@icons","@containerClass"],[[30,0,["chatEmojiPickerManager","picker","initialFilter"]],[28,[37,9],[[30,0],[30,0,["didInputFilter"]]],[["value"],["target.value"]]],[28,[37,10],null,[["left"],["search"]]],"chat-emoji-picker__filter"]],[["default"],[[[[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__fitzpatrick-scale"],[24,"role","toolbar"],[4,[38,6],["keyup",[30,0,["didNavigateFitzpatrickScale"]]],null],[12],[1,"\\n"],[41,[30,0,["isExpandedFitzpatrickScale"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["fitzpatrickModifiers"]]],null]],null],null,[[[1,"\\n"],[41,[28,[37,14],[[30,5,["scale"]],[30,0,["chatEmojiReactionStore","diversity"]]],null],[[[1,"                "],[11,"button"],[16,"title",[28,[37,15],["t",[30,5,["scale"]]],null]],[24,"tabindex","-1"],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn",[28,[37,15],["t",[30,5,["scale"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[4,[38,6],["click",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[12],[1,"\\n                  "],[1,[28,[35,16],["check"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[5]],null]],[]],null],[1,"\\n          "],[11,"button"],[16,"title",[28,[37,15],["t",[30,0,["fitzpatrick","scale"]]],null]],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn current",[28,[37,15],["t",[30,0,["chatEmojiReactionStore","diversity"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[30,0,["didToggleFitzpatrickScale"]]],null],[4,[38,6],["click",[30,0,["didToggleFitzpatrickScale"]]],null],[12],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["chatEmojiPickerManager","sections","length"]],[[[41,[28,[37,1],[[30,0,["filteredEmojis"]],null],null],[[[1,"        "],[10,0],[14,0,"chat-emoji-picker__sections-nav"],[12],[1,"\\n          "],[10,0],[14,0,"chat-emoji-picker__sections-nav__indicator"],[15,5,[30,0,["navIndicatorStyle"]]],[12],[13],[1,"\\n\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[8,[39,18],[[16,0,[28,[37,2],["btn-flat","chat-emoji-picker__section-btn",[52,[28,[37,1],[[30,0,["chatEmojiPickerManager","lastVisibleSection"]],[30,7]],null],"active"]],null]],[24,"tabindex","-1"],[16,5,[30,0,["navBtnStyle"]]],[16,"data-section",[30,7]]],[["@action"],[[28,[37,11],[[30,0,["didRequestSection"]],[30,7]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[37,1],[[30,7],"favorites"],null],[[[1,"                "],[1,[28,[35,19],[":star:"],null]],[1,"\\n"]],[]],[[[1,"                "],[10,"img"],[14,"width","18"],[14,"height","18"],[14,0,"emoji"],[15,"src",[28,[37,20],[[30,6],"0.url"],null]],[12],[13],[1,"\\n"]],[]]],[1,"            "]],[]]]]],[1,"\\n"]],[6,7]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[11,0],[24,0,"chat-emoji-picker__scrollable-content"],[4,[38,21],null,null],[12],[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__sections"],[24,"role","button"],[4,[38,6],["click",[30,0,["didSelectEmoji"]]],null],[4,[38,6],["keydown",[30,0,["onSectionsKeyDown"]]],null],[12],[1,"\\n"],[41,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],[[[1,"            "],[10,0],[14,0,"chat-emoji-picker__section filtered"],[12],[1,"\\n"],[42,[28,[37,13],[[28,[37,13],[[30,0,["filteredEmojis"]]],null]],null],null,[[[1,"                "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,8,["name"]]],[15,"data-tonable",[52,[30,8,["tonable"]],"true"]],[15,"alt",[30,8,["name"]]],[15,"title",[28,[37,23],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[8]],[[[1,"                "],[10,2],[14,0,"chat-emoji-picker__no-results"],[12],[1,"\\n                  "],[1,[28,[35,8],["chat.emoji_picker.no_results"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[10,0],[15,0,[28,[37,2],["chat-emoji-picker__section",[52,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],"hidden"]],null]],[15,"data-section",[30,10]],[14,"role","region"],[15,"aria-label",[28,[37,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[12],[1,"\\n              "],[10,"h2"],[14,0,"chat-emoji-picker__section-title"],[12],[1,"\\n                "],[1,[28,[35,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"chat-emoji-picker__section-emojis"],[12],[1,"\\n"],[44,[[28,[37,20],[[30,9],"0"],null]],[[[1,"                  "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,11,["name"]]],[15,"data-tonable",[52,[30,11,["tonable"]],"true"]],[15,"alt",[30,11,["name"]]],[15,"title",[28,[37,23],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[11]]],[1,"\\n"],[41,[28,[37,25],[[30,0,["chatEmojiPickerManager","visibleSections"]],[30,10]],null],[[[42,[28,[37,13],[[28,[37,13],[[30,9]],null]],null],null,[[[41,[28,[37,26],[[30,13],0],null],[[[1,"                      "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","-1"],[15,"data-emoji",[30,12,["name"]]],[15,"data-tonable",[52,[30,12,["tonable"]],"true"]],[15,"alt",[30,12,["name"]]],[15,"title",[28,[37,23],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[]],null]],[12,13]],null]],[]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[9,10]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"spinner medium"],[12],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n\\n"],[41,[28,[37,27],[[30,0,["site","mobileView"]],[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],"chat-channel-message"],null]],null],[[[1,"    "],[10,0],[14,0,"chat-emoji-picker__backdrop"],[12],[13],[1,"\\n"]],[]],null]],[]],null]],["@context","&attrs","@didInsert","@willDestroy","fitzpatrick","emojis","section","emoji","emojis","section","emoji","emoji","index"],false,["if","eq","concat-class","did-insert","noop","will-destroy","on","dc-filter-input","i18n","action","hash","fn","each","-track-array","not-eq","concat","d-icon","-each-in","d-button","replace-emoji","get","chat/emoji-picker-scroll-listener","tonable-emoji-url","tonable-emoji-title","let","includes","gt","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-picker.hbs",isStrictMode:!1}),O=e.FITZPATRICK_MODIFIERS=[{scale:1,modifier:null},{scale:2,modifier:":t2"},{scale:3,modifier:":t3"},{scale:4,modifier:":t4"},{scale:5,modifier:":t5"},{scale:6,modifier:":t6"}]
let C=e.default=(p=class extends i.default{constructor(){super(...arguments),_(this,"chatEmojiPickerManager",m,this),_(this,"emojiPickerScrollObserver",b,this),_(this,"chatEmojiReactionStore",g,this),_(this,"capabilities",f,this),_(this,"site",v,this),_(this,"filteredEmojis",y,this),_(this,"isExpandedFitzpatrickScale",w,this),j(this,"fitzpatrickModifiers",O)}get groups(){const e=this.chatEmojiPickerManager.emojis
return{...{favorites:this.chatEmojiReactionStore.favorites.filter((e=>!this.site.denied_emojis?.includes(e))).map((e=>({name:e,group:"favorites",url:(0,l.emojiUrlFor)(e)})))},...e}}get flatEmojis(){if(!this.chatEmojiPickerManager.emojis)return[]
let{favorites:e,...t}=this.chatEmojiPickerManager.emojis
return Object.values(t).flat()}get navIndicatorStyle(){const e=this.chatEmojiPickerManager.lastVisibleSection,t=Object.keys(this.groups).indexOf(e)
return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%; transform: translateX(${100*t}%);`)}get navBtnStyle(){return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%;`)}trapKeyDownEvents(e){"Escape"===e.key&&this.chatEmojiPickerManager.close(),"ArrowUp"===e.key&&e.stopPropagation(),"ArrowDown"===e.key&&e.target.classList.contains("dc-filter-input")&&(e.stopPropagation(),e.preventDefault(),document.querySelector('.chat-emoji-picker__scrollable-content .emoji[tabindex="0"]')?.focus())}didNavigateFitzpatrickScale(e){if("keyup"!==e.type)return
const t=[...e.target.closest(".chat-emoji-picker__fitzpatrick-scale")?.querySelectorAll(".chat-emoji-picker__fitzpatrick-modifier-btn")||[]]
"ArrowRight"===e.key&&(e.preventDefault(),e.target===t[t.length-1]?t[0].focus():e.target.nextElementSibling?.focus()),"ArrowLeft"===e.key&&(e.preventDefault(),e.target===t[0]?t[t.length-1].focus():e.target.previousElementSibling?.focus())}didToggleFitzpatrickScale(e){if("keyup"===e.type){if("Escape"===e.key)return e.preventDefault(),void(this.isExpandedFitzpatrickScale=!1)
if("Enter"!==e.key)return}this.isExpandedFitzpatrickScale=!this.isExpandedFitzpatrickScale}didRequestFitzpatrickScale(e,t){if("keyup"===t.type){if("Escape"===t.key)return t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,void this._focusCurrentFitzpatrickScale()
if("Enter"!==t.key)return}t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,this.chatEmojiReactionStore.diversity=e,this._focusCurrentFitzpatrickScale()}_focusCurrentFitzpatrickScale(){(0,a.schedule)("afterRender",(()=>{document.querySelector(".chat-emoji-picker__fitzpatrick-modifier-btn.current")?.focus()}))}didInputFilter(e){e?.length?(0,u.default)(this,this.debouncedDidInputFilter,e,c.INPUT_DELAY):this.filteredEmojis=null}focusFilter(e){(0,a.schedule)("afterRender",(()=>{e?.focus()}))}debouncedDidInputFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
e=e.toLowerCase(),this.filteredEmojis=this.flatEmojis.filter((t=>t.name.toLowerCase().includes(e)||t.search_aliases?.any((t=>t.toLowerCase().includes(e))))),(0,a.schedule)("afterRender",(()=>{const e=document.querySelector(".chat-emoji-picker__scrollable-content")
e&&(e.scrollTop=0)}))}onSectionsKeyDown(e){"Enter"===e.key?this.didSelectEmoji(e):this.didNavigateSection(e)}didNavigateSection(e){const t=e=>[...e.querySelectorAll(".emoji")],i=e=>{t(e)[0].focus()},n=e.target.closest(".chat-emoji-picker__section"),r=()=>{document.querySelector(".dc-filter-input")?.focus()},a=()=>[...document.querySelectorAll(".chat-emoji-picker__section:not(.hidden) .emoji")]
if("ArrowRight"===e.key){e.preventDefault()
const t=e.target.nextElementSibling
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowLeft"===e.key){e.preventDefault()
const i=e.target.previousElementSibling
if(i)i.focus()
else{const e=n.previousElementSibling
e?(e=>{const i=t(e)
i[i.length-1].focus()})(e):r()}}if("ArrowDown"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().filter((t=>t.offsetTop>e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
if(t)t.focus()
else{const e=n.nextElementSibling
e&&i(e)}}if("ArrowUp"===e.key){e.preventDefault(),e.stopPropagation()
const t=a().reverse().filter((t=>t.offsetTop<e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
t?t.focus():r()}}didSelectEmoji(e){if(e.target.classList.contains("emoji")&&("click"===e.type||"Enter"===e.key)){e.preventDefault(),e.stopPropagation()
let t=e.target.dataset.emoji
const i=e.target.dataset.tonable,n=this.chatEmojiReactionStore.diversity
i&&n>1&&(t=`${t}:t${n}`),this.args.didSelectEmoji?.(t)}}didRequestSection(e){const t=document.querySelector(".chat-emoji-picker__scrollable-content")
this.filteredEmojis=null,this.emojiPickerScrollObserver.enabled=!1,this.chatEmojiPickerManager.addVisibleSections([e]),this.chatEmojiPickerManager.lastVisibleSection=e,t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="hidden"),(0,a.schedule)("afterRender",(()=>{const i=document.querySelector(`.chat-emoji-picker__section[data-section="${e}"] .emoji:nth-child(1)`);([...document.querySelectorAll(`.chat-emoji-picker__section[data-section="${e}"] .emoji`)].find((e=>e.offsetTop>i.offsetTop))||i).focus(),(0,a.later)((()=>{t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="scroll"),this.emojiPickerScrollObserver.enabled=!0}),200)}))}addClickOutsideEventListener(){document.addEventListener("click",this.didClickOutside)}removeClickOutsideEventListener(){document.removeEventListener("click",this.didClickOutside)}didClickOutside(e){e.target.closest(".chat-emoji-picker")||this.chatEmojiPickerManager.close()}},m=M(p.prototype,"chatEmojiPickerManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=M(p.prototype,"emojiPickerScrollObserver",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=M(p.prototype,"chatEmojiReactionStore",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(p.prototype,"capabilities",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(p.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(p.prototype,"filteredEmojis",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=M(p.prototype,"isExpandedFitzpatrickScale",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(p.prototype,"trapKeyDownEvents",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"trapKeyDownEvents"),p.prototype),M(p.prototype,"didNavigateFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateFitzpatrickScale"),p.prototype),M(p.prototype,"didToggleFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didToggleFitzpatrickScale"),p.prototype),M(p.prototype,"didRequestFitzpatrickScale",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestFitzpatrickScale"),p.prototype),M(p.prototype,"didInputFilter",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didInputFilter"),p.prototype),M(p.prototype,"focusFilter",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"focusFilter"),p.prototype),M(p.prototype,"onSectionsKeyDown",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"onSectionsKeyDown"),p.prototype),M(p.prototype,"didNavigateSection",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didNavigateSection"),p.prototype),M(p.prototype,"didSelectEmoji",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didSelectEmoji"),p.prototype),M(p.prototype,"didRequestSection",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didRequestSection"),p.prototype),M(p.prototype,"addClickOutsideEventListener",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"addClickOutsideEventListener"),p.prototype),M(p.prototype,"removeClickOutsideEventListener",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"removeClickOutsideEventListener"),p.prototype),M(p.prototype,"didClickOutside",[d.bind],Object.getOwnPropertyDescriptor(p.prototype,"didClickOutside"),p.prototype),p);(0,t.setComponentTemplate)(z,C)})),define("discourse/plugins/chat/discourse/components/chat-footer",["exports","@glimmer/component","@ember/service","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/i18n","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat/footer/unread-indicator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"router",d,this),b(this,"chat",h,this),b(this,"siteSettings",p,this),g(this,"threadsEnabled",this.siteSettings.chat_threads_enabled)}get directMessagesEnabled(){return this.chat.userCanAccessDirectMessages}get shouldRenderFooter(){return this.threadsEnabled||this.directMessagesEnabled}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"4aKg6QTh",block:'[[[1,"\\n"],[41,[30,0,["shouldRenderFooter"]],[[[1,"      "],[10,"nav"],[14,0,"c-footer"],[12],[1,"\\n        "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.channel_list.aria_label"],null]],[24,1,"c-footer-channels"],[16,0,[28,[32,2],["btn-flat","c-footer__item",[52,[28,[32,3],[[30,0,["router","currentRouteName"]],"chat.channels"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.channels","comments",[28,[32,1],["chat.channel_list.title"],null]]],[["default"],[[[[1,"\\n          "],[8,[32,4],null,null,null],[1,"\\n        "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["directMessagesEnabled"]],[[[1,"          "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.direct_messages.aria_label"],null]],[24,1,"c-footer-direct-messages"],[16,0,[28,[32,2],["btn-flat","c-footer__item",[52,[28,[32,3],[[30,0,["router","currentRouteName"]],"chat.direct-messages"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.direct-messages","users",[28,[32,1],["chat.direct_messages.title"],null]]],[["default"],[[[[1,"\\n            "],[8,[32,5],null,null,null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["threadsEnabled"]],[[[1,"          "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.my_threads.aria_label"],null]],[24,1,"c-footer-threads"],[16,0,[28,[32,2],["btn-flat","c-footer__item",[52,[28,[32,3],[[30,0,["router","currentRouteName"]],"chat.threads"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.threads","discourse-threads",[28,[32,1],["chat.my_threads.title"],null]]],[["default"],[[[[1,"\\n            "],[8,[32,6],null,null,null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-footer.js",scope:()=>[n.default,a.default,r.default,s.default,o.UnreadChannelsIndicator,o.UnreadDirectMessagesIndicator,o.UnreadThreadsIndicator],isStrictMode:!0}),m),d=f((u=m).prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(u.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(u.prototype,"siteSettings",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/components/chat-header",["exports","@glimmer/component","@glimmer/tracking","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-common/lib/get-url","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function y(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=new WeakSet,b=class extends t.default{constructor(){super(...arguments),v(this,g),f(this,"site",d,this),f(this,"siteSettings",h,this),f(this,"router",p,this),f(this,"previousURL",m,this),y(this,"title",o.default.t("chat.back_to_forum")),y(this,"heading",o.default.t("chat.heading")),this.router.on("routeDidChange",this,w(this,g,j))}get shouldRender(){return this.siteSettings.chat_enabled&&this.site.mobileView&&this.isChatOpen}willDestroy(){super.willDestroy(...arguments),this.router.off("routeDidChange",this,w(this,g,j))}get isChatOpen(){return this.router.currentURL.startsWith("/chat")}get forumLink(){return(0,s.default)(this.previousURL??this.router.rootURL)}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"Cw+adMhm",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,0],[14,0,"c-header"],[12],[1,"\\n        "],[10,3],[15,6,[30,0,["forumLink"]]],[14,0,"btn-flat back-to-forum"],[15,"title",[30,0,["title"]]],[12],[1,"\\n          "],[1,[28,[32,0],["arrow-left"],null]],[1,"\\n          "],[1,[30,0,["title"]]],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,1],[[24,0,"c-heading"]],[["@route"],["chat.index"]],[["default"],[[[[1,[30,0,["heading"]]]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[18,1,null],[1,"\\n"]],[]]],[1,"  "]],["&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-header.js",scope:()=>[a.default,n.LinkTo],isStrictMode:!0}),b),d=_((u=b).prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=_(u.prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=_(u.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_(u.prototype,"previousURL",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)
function j(){this.isChatOpen||(this.previousURL=this.router.currentURL)}})),define("discourse/plugins/chat/discourse/components/chat-mention-warnings",["exports","@glimmer/component","@ember/service","@ember/template","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/lib/get-url","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"siteSettings",d,this),b(this,"currentUser",h,this),b(this,"chatComposerWarningsTracker",p,this)}get unreachableGroupMentions(){return this.chatComposerWarningsTracker.unreachableGroupMentions}get overMembersLimitGroupMentions(){return this.chatComposerWarningsTracker.overMembersLimitGroupMentions}get hasTooManyMentions(){return this.chatComposerWarningsTracker.tooManyMentions}get channelWideMentionDisallowed(){return this.chatComposerWarningsTracker.channelWideMentionDisallowed}get mentionsCount(){return this.chatComposerWarningsTracker.mentionsCount}get unreachableGroupMentionsCount(){return this.unreachableGroupMentions.length}get overMembersLimitMentionsCount(){return this.overMembersLimitGroupMentions.length}get hasUnreachableGroupMentions(){return this.unreachableGroupMentionsCount>0}get hasOverMembersLimitGroupMentions(){return this.overMembersLimitMentionsCount>0}get warningsCount(){return this.unreachableGroupMentionsCount+this.overMembersLimitMentionsCount}get show(){return this.hasTooManyMentions||this.channelWideMentionDisallowed||this.hasUnreachableGroupMentions||this.hasOverMembersLimitGroupMentions}get listStyleClass(){return this.hasTooManyMentions?"chat-mention-warnings-list__simple":this.warningsCount>1?"chat-mention-warnings-list__multiple":"chat-mention-warnings-list__simple"}get warningHeaderText(){return this.mentionsCount<=this.warningsCount||this.hasTooManyMentions?o.default.t("chat.mention_warning.groups.header.all"):o.default.t("chat.mention_warning.groups.header.some")}get tooManyMentionsBody(){if(this.hasTooManyMentions)return this.currentUser.admin?(0,n.htmlSafe)(o.default.t("chat.mention_warning.too_many_mentions_admin",{count:this.siteSettings.max_mentions_per_chat_message,siteSettingUrl:(0,s.default)("/admin/site_settings/category/plugins?filter=max_mentions_per_chat_message")})):(0,n.htmlSafe)(o.default.t("chat.mention_warning.too_many_mentions",{count:this.siteSettings.max_mentions_per_chat_message}))}get unreachableBody(){if(this.hasUnreachableGroupMentions)switch(this.unreachableGroupMentionsCount){case 1:return o.default.t("chat.mention_warning.groups.unreachable_1",{group:this.unreachableGroupMentions[0]})
case 2:return o.default.t("chat.mention_warning.groups.unreachable_2",{group1:this.unreachableGroupMentions[0],group2:this.unreachableGroupMentions[1]})
default:return o.default.t("chat.mention_warning.groups.unreachable_multiple",{group:this.unreachableGroupMentions[0],count:this.unreachableGroupMentionsCount-1})}}get overMembersLimitBody(){if(this.hasOverMembersLimitGroupMentions)return(0,n.htmlSafe)(o.default.messageFormat("chat.mention_warning.groups.too_many_members_MF",{groupCount:this.overMembersLimitMentionsCount,isAdmin:this.currentUser.admin,siteSettingUrl:(0,s.default)("/admin/site_settings/category/plugins?filter=max_users_notified_per_group_mention"),notificationLimit:this.siteSettings.max_users_notified_per_group_mention,group1:this.overMembersLimitGroupMentions[0],group2:this.overMembersLimitGroupMentions[1]}))}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"I3dNE3Vl",block:'[[[1,"\\n"],[41,[30,0,["show"]],[[[1,"      "],[10,0],[14,0,"chat-mention-warnings"],[12],[1,"\\n        "],[10,0],[14,0,"chat-mention-warning__icon"],[12],[1,"\\n          "],[1,[28,[32,0],["exclamation-triangle"],null]],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-mention-warning__text"],[12],[1,"\\n          "],[10,0],[14,0,"chat-mention-warning__header"],[12],[1,"\\n            "],[1,[30,0,["warningHeaderText"]]],[1,"\\n          "],[13],[1,"\\n          "],[10,"ul"],[15,0,[30,0,["listStyleClass"]]],[12],[1,"\\n"],[41,[30,0,["hasTooManyMentions"]],[[[1,"              "],[10,"li"],[12],[1,[30,0,["tooManyMentionsBody"]]],[13],[1,"\\n"]],[]],[[[41,[30,0,["channelWideMentionDisallowed"]],[[[1,"                "],[10,"li"],[12],[1,[28,[32,1],["chat.mention_warning.channel_wide_mentions_disallowed"],null]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasUnreachableGroupMentions"]],[[[1,"                "],[10,"li"],[12],[1,[30,0,["unreachableBody"]]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasOverMembersLimitGroupMentions"]],[[[1,"                "],[10,"li"],[12],[1,[30,0,["overMembersLimitBody"]]],[13],[1,"\\n"]],[]],null]],[]]],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-mention-warnings.js",scope:()=>[r.default,a.default],isStrictMode:!0}),m),d=g((u=m).prototype,"siteSettings",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(u.prototype,"chatComposerWarningsTracker",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-desktop",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","@popperjs/core","discourse/components/bookmark-icon","discourse/components/d-button","discourse/helpers/concat-class","select-kit/components/dropdown-select-box","truth-helpers/helpers/and","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/lib/chat-message-container","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j){"use strict"
var M,z,O,C,k,S
function P(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function T(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const x="full"
e.default=(S=class extends t.default{constructor(){super(...arguments),P(this,"chat",z,this),P(this,"chatEmojiPickerManager",O,this),P(this,"site",C,this),P(this,"size",k,this),T(this,"popper",null)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new w.default((0,n.getOwner)(this),this.message,this.context)}get shouldRenderFavoriteReactions(){return this.size===x}onWheel(){this.chat.activeMessage=null}setup(e){this.popper?.destroy(),(0,u.schedule)("afterRender",(()=>{const t=(0,y.default)(this.message.id,this.context)
if(!t)return
const i=t.closest(".popper-viewport")
this.size=i.clientWidth<500?"reduced":x,t&&(this.popper=(0,h.createPopper)(t,e,{placement:"top-end",strategy:"fixed",modifiers:[{name:"flip",enabled:!0,options:{boundary:i,fallbackPlacements:["bottom-end"]}},{name:"hide",enabled:!0},{name:"eventListeners",options:{scroll:!1}},{name:"offset",options:{offset:[-2,-10]}}]}))}))}teardown(){this.popper?.destroy(),this.popper=null}},(0,j.setComponentTemplate)((0,_.createTemplateFactory)({id:"3AA9zPXK",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[11,0],[16,0,[28,[32,1],["chat-message-actions-container",[28,[32,2],["is-size-",[30,0,["size"]]],null]],null]],[16,"data-id",[30,0,["message","id"]]],[4,[32,3],[[30,0,["setup"]]],null],[4,[32,4],[[30,0,["setup"]],[30,0,["chat","activeMessage","model","id"]]],null],[4,[32,5],["wheel",[30,0,["onWheel"]]],[["passive"],[true]]],[4,[32,6],[[30,0,["teardown"]]],null],[12],[1,"\\n        "],[10,0],[15,0,[28,[32,1],["chat-message-actions",[52,[51,[30,0,["messageInteractor","secondaryActions","length"]]],"has-no-secondary-actions"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldRenderFavoriteReactions"]],[[[42,[28,[31,3],[[28,[31,3],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],"emoji",[[[1,"              "],[8,[32,7],null,[["@reaction","@onReaction","@message","@showCount","@disableTooltip"],[[30,1],[30,0,["messageInteractor","react"]],[30,0,["message"]],false,true]],null],[1,"\\n"]],[1]],null]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canInteractWithMessage"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat bookmark-btn"]],[["@action","@translatedTitle"],[[30,0,["messageInteractor","toggleBookmark"]],[30,0,["message","bookmark","reminderTitle"]]]],[["default"],[[[[1,"\\n              "],[8,[32,9],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat reply-btn"]],[["@action","@icon","@title"],[[30,0,["messageInteractor","reply"]],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,0],[[30,0,["messageInteractor","message"]],[30,0,["messageInteractor","secondaryActions","length"]]],null],[[[1,"            "],[8,[32,10],[[24,0,"more-buttons secondary-actions"]],[["@options","@content","@onChange"],[[28,[32,11],null,[["icon","placement","customStyle","btnCustomClasses"],["ellipsis-v","left","true","btn-flat"]]],[30,0,["messageInteractor","secondaryActions"]],[30,0,["messageInteractor","handleSecondaryActions"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["reaction"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-desktop.js",scope:()=>[f.default,b.default,r.concat,o.default,l.default,a.on,c.default,v.default,m.default,p.default,g.default,r.hash],isStrictMode:!0}),S),z=E((M=S).prototype,"chat",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=E(M.prototype,"chatEmojiPickerManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=E(M.prototype,"site",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=E(M.prototype,"size",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return x}}),E(M.prototype,"onWheel",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"onWheel"),M.prototype),E(M.prototype,"setup",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"setup"),M.prototype),E(M.prototype,"teardown",[s.action],Object.getOwnPropertyDescriptor(M.prototype,"teardown"),M.prototype),M)})),define("discourse/plugins/chat/discourse/components/chat-message-actions-mobile",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/components/bookmark-icon","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/lib/later","truth-helpers/helpers/and","truth-helpers/helpers/or","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y){"use strict"
var w,_,j,M,z,O,C,k,S,P
function T(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function E(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function x(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function D(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(k=new WeakSet,S=new WeakSet,P=new WeakSet,C=class extends t.default{constructor(){super(...arguments),E(this,P),E(this,S),E(this,k),T(this,"chat",_,this),T(this,"site",j,this),T(this,"capabilities",M,this),T(this,"hasExpandedReply",z,this),T(this,"showFadeIn",O,this)}get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new f.default((0,n.getOwner)(this),this.message,this.context)}fadeAndVibrate(){(0,h.default)(x(this,S,N).bind(this)),this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5)}expandReply(e){e.stopPropagation(),this.hasExpandedReply=!0}collapseMenu(e){e.preventDefault(),x(this,k,A).call(this)}actAndCloseMenu(e){this.messageInteractor[e](),x(this,k,A).call(this)}openEmojiPicker(e,t){this.messageInteractor.openEmojiPicker(e,t),x(this,k,A).call(this)}},(0,y.setComponentTemplate)((0,v.createTemplateFactory)({id:"nW31Z6tX",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","mobileView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[11,0],[16,0,[28,[32,1],["chat-message-actions-backdrop",[52,[30,0,["showFadeIn"]],"fade-in"]],null]],[4,[32,2],[[30,0,["fadeAndVibrate"]]],null],[12],[1,"\\n        "],[11,0],[24,"role","button"],[24,0,"collapse-area"],[4,[32,3],["touchstart",[30,0,["collapseMenu"]]],[["passive","bubbles"],[false,false]]],[12],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-message-actions"],[12],[1,"\\n          "],[10,0],[14,0,"selected-message-container"],[12],[1,"\\n            "],[10,0],[14,0,"selected-message"],[12],[1,"\\n              "],[8,[32,4],null,[["@user"],[[30,0,["message","user"]]]],null],[1,"\\n              "],[11,1],[24,"role","button"],[16,0,[28,[32,1],["selected-message-reply",[52,[30,0,["hasExpandedReply"]],"is-expanded"]],null]],[4,[32,3],["touchstart",[30,0,["expandReply"]]],[["passive"],[true]]],[12],[1,"\\n                "],[1,[30,0,["message","message"]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,"ul"],[14,0,"secondary-actions"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","secondaryActions"]]],null]],null],null,[[[1,"              "],[10,"li"],[14,0,"chat-message-action-item"],[15,"data-id",[30,1,["id"]]],[12],[1,"\\n                "],[8,[32,5],[[24,0,"chat-message-action"]],[["@translatedLabel","@icon","@action"],[[30,1,["name"]],[30,1,["icon"]],[28,[32,6],[[30,0,["actAndCloseMenu"]],[30,1,["id"]]],null]]],null],[1,"\\n              "],[13],[1,"\\n"]],[1]],null],[1,"          "],[13],[1,"\\n\\n"],[41,[28,[32,7],[[30,0,["messageInteractor","canReact"]],[30,0,["messageInteractor","canReply"]]],null],[[[1,"            "],[10,0],[14,0,"main-actions"],[12],[1,"\\n"],[41,[30,0,["messageInteractor","canReact"]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],null,[[[1,"                  "],[8,[32,8],null,[["@reaction","@onReaction","@message","@showCount"],[[30,2],[30,0,["messageInteractor","react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[2]],null],[1,"\\n                "],[8,[32,5],[[24,"data-id","react"],[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"                "],[8,[32,5],[[24,"data-id","bookmark"],[24,0,"btn-flat bookmark-btn"]],[["@action"],[[28,[32,6],[[30,0,["actAndCloseMenu"]],"toggleBookmark"],null]]],[["default"],[[[[1,"\\n                  "],[8,[32,9],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"                "],[8,[32,5],[[24,"data-id","reply"],[24,0,"chat-message-action reply-btn btn-flat"]],[["@action","@icon","@title"],[[28,[32,6],[[30,0,["actAndCloseMenu"]],"reply"],null],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["button","reaction"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-mobile.js",scope:()=>[p.default,d.default,o.default,a.on,g.default,u.default,r.fn,m.default,b.default,c.default],isStrictMode:!0}),C),_=D((w=C).prototype,"chat",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D(w.prototype,"site",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=D(w.prototype,"capabilities",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=D(w.prototype,"hasExpandedReply",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=D(w.prototype,"showFadeIn",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D(w.prototype,"fadeAndVibrate",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"fadeAndVibrate"),w.prototype),D(w.prototype,"expandReply",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"expandReply"),w.prototype),D(w.prototype,"collapseMenu",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"collapseMenu"),w.prototype),D(w.prototype,"actAndCloseMenu",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"actAndCloseMenu"),w.prototype),D(w.prototype,"openEmojiPicker",[s.action],Object.getOwnPropertyDescriptor(w.prototype,"openEmojiPicker"),w.prototype),w)
function A(){x(this,P,I).call(this),(0,h.default)((()=>{this.isDestroying||this.isDestroyed||(this.chat.activeMessage=null)}),200)}function N(){this.showFadeIn=!0}function I(){this.showFadeIn=!1}})),define("discourse/plugins/chat/discourse/components/chat-message-collapser",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse/lib/utilities","discourse-common/lib/dom-from-string","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.isCollapsible=function(e,t){const i=Array.prototype.slice.call((0,s.default)(e))
return w(i)||M(i)||z(t)||C(i)||S(i)}
const d=(0,l.createTemplateFactory)({id:"0kb4UYGW",block:'[[[10,0],[14,0,"chat-message-collapser"],[12],[1,"\\n"],[41,[30,0,["hasUploads"]],[[[1,"    "],[1,[28,[35,1],[[30,1]],null]],[1,"\\n\\n    "],[8,[39,2],null,[["@header","@onToggle"],[[30,0,["uploadsHeader"]],[30,2]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-uploads"],[12],[1,"\\n"],[42,[28,[37,4],[[28,[37,4],[[30,3]],null]],null],null,[[[1,"          "],[8,[39,5],null,[["@upload"],[[30,4]]],null],[1,"\\n"]],[4]],null],[1,"      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[42,[28,[37,4],[[28,[37,4],[[30,0,["cookedBodies"]]],null]],null],null,[[[41,[30,5,["needsCollapser"]],[[[1,"        "],[8,[39,2],null,[["@header","@onToggle"],[[30,5,["header"]],[30,2]]],[["default"],[[[[1,"\\n"],[41,[30,5,["videoAttributes"]],[[[1,"            "],[10,0],[14,0,"chat-message-collapser-lazy-video"],[12],[1,"\\n              "],[8,[39,6],null,[["@videoAttributes"],[[30,5,["videoAttributes"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[1,[30,5,["body"]]],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,5,["body"]]],[1,"\\n"]],[]]]],[5]],null]],[]]],[13]],["@cooked","@onToggleCollapse","@uploads","upload","cooked"],false,["if","html-safe","collapser","each","-track-array","chat-upload","lazy-video"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-collapser.hbs",isStrictMode:!1})
let h=e.default=(c=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get hasUploads(){return z(this.args.uploads)}get uploadsHeader(){let e=""
return e=1===this.args.uploads.length?this.args.uploads[0].original_filename:o.default.t("chat.uploaded_files",{count:this.args.uploads.length}),(0,r.htmlSafe)(`<span class="chat-message-collapser-link-small">${(0,a.escapeExpression)(e)}</span>`)}get cookedBodies(){const e=Array.prototype.slice.call((0,s.default)(this.args.cooked))
return w(e)?this.lazyVideoCooked(e):M(e)?this.imageOneboxCooked(e):C(e)?this.imageCooked(e):S(e)?this.galleryCooked(e):[]}lazyVideoCooked(e){return e.reduce(((e,t)=>{if(this.siteSettings.lazy_videos_enabled&&y(t)){const i=(0,requirejs("discourse/plugins/discourse-lazy-videos/lib/lazy-video-attributes").default)(t)
if(this.siteSettings[`lazy_${i.providerName}_enabled`]){const n=(0,a.escapeExpression)(i.url),s=i.title,o=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link" rel="noopener noreferrer" href="${n}">${s}</a>`)
e.push({header:o,body:t,videoAttributes:i,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageOneboxCooked(e){return e.reduce(((e,t)=>{if(j(t)){let i=_(t)?t.firstChild.src:t.firstElementChild.href
i=(0,a.escapeExpression)(i)
const n=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${i}</a>`)
e.push({header:n,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageCooked(e){return e.reduce(((e,t)=>{if(O(t)){const i=(0,a.escapeExpression)(t.firstElementChild.src),n=(0,a.escapeExpression)(t.firstElementChild.alt),s=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n||i}</a>`)
e.push({header:s,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}galleryCooked(e){return e.reduce(((e,t)=>{if(k(t)){const i=(0,a.escapeExpression)(t.firstElementChild.href),n=(0,a.escapeExpression)(t.firstElementChild.firstElementChild.textContent)
t.firstElementChild.removeChild(t.firstElementChild.firstElementChild)
const s=(0,r.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${i}">${n}</a>`)
e.push({header:s,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}},p=c.prototype,m="siteSettings",b=[n.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),u=v,c)
var p,m,b,g,f,v
function y(e){return e.classList.contains("lazy-video-container")}function w(e){return e.some((e=>y(e)))}function _(e){return e.firstChild&&"IMG"===e.firstChild.nodeName&&e.firstChild.classList.contains("animated")&&e.firstChild.classList.contains("onebox")}function j(e){return _(e)||function(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.classList.contains("onebox")&&e.firstElementChild.firstElementChild&&"IMG"===e.firstElementChild.firstElementChild.nodeName}(e)}function M(e){return e.some((e=>j(e)))}function z(e){return e?.length>0}function O(e){return"P"===e.nodeName&&e.firstElementChild&&"IMG"===e.firstElementChild.nodeName&&!e.firstElementChild.classList.contains("emoji")}function C(e){return e.some((e=>O(e)))}function k(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.classList.contains("outer-box")}function S(e){return e.some((e=>k(e)))}(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator",["exports","@glimmer/component","@ember/routing","@ember/service","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-common/helpers/html-safe","discourse/plugins/chat/discourse/components/chat-emoji-avatar","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=h)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get route(){return this.hasThread?"chat.channel.thread":"chat.channel.near-message"}get model(){return this.hasThread?[...this.args.message.channel.routeModels,this.args.message.thread.id]:[...this.args.message.channel.routeModels,this.args.message.inReplyTo.id]}get hasThread(){return this.args.message?.channel?.threadingEnabled&&this.args.message?.thread?.id}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"zfH8D9bT",block:'[[[1,"\\n"],[41,[30,1,["inReplyTo"]],[[[1,"      "],[8,[32,0],[[24,0,"chat-reply is-direct-reply"]],[["@route","@models"],[[30,0,["route"]],[30,0,["model"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["share"],[["title"],["chat.in_reply_to"]]]],[1,"\\n\\n"],[41,[30,1,["inReplyTo","chatWebhookEvent","emoji"]],[[[1,"          "],[8,[32,2],null,[["@emoji"],[[30,1,["inReplyTo","chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,3],null,[["@user"],[[30,1,["inReplyTo","user"]]]],null],[1,"\\n"]],[]]],[1,"\\n        "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n          "],[1,[28,[32,4],[[28,[32,5],[[30,1,["inReplyTo","excerpt"]]],null]],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator.js",scope:()=>[i.LinkTo,a.default,o.default,l.default,r.default,s.default],isStrictMode:!0}),p),m=(d=p).prototype,b="router",g=[n.inject],f={configurable:!0,enumerable:!0,writable:!0,initializer:null},y={},Object.keys(f).forEach((function(e){y[e]=f[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=g.slice().reverse().reduce((function(e,t){return t(m,b,e)||e}),y),v&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(v):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(m,b,y),y=null),h=y,d)
var m,b,g,f,v,y})),define("discourse/plugins/chat/discourse/components/chat-message-reaction",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","@ember/template","ember-modifier","discourse/helpers/concat-class","discourse/lib/text","truth-helpers/helpers/and","discourse/plugins/chat/discourse/lib/get-reaction-text","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(w=class extends t.default{constructor(){super(...arguments),_(this,"capabilities",b,this),_(this,"currentUser",g,this),_(this,"tooltip",f,this),_(this,"site",v,this),_(this,"isActive",y,this),j(this,"registerTooltip",(0,o.modifier)((e=>{if(this.disableTooltip||!this.popoverContent?.length)return
const t=this.tooltip.register(e,{content:(0,s.htmlSafe)(this.popoverContent),identifier:"chat-message-reaction-tooltip",animated:!1,placement:"top",fallbackPlacements:["bottom"],triggers:this.site.mobileView?["hold"]:["hover"]})
return()=>{t?.destroy()}})))}get disableTooltip(){return this.args.disableTooltip??!1}get showCount(){return this.args.showCount??!0}get emojiString(){return`:${this.args.reaction.emoji}:`}get emojiUrl(){return(0,c.emojiUrlFor)(this.args.reaction.emoji)}handleClick(e){e.stopPropagation(),this.args.onReaction?.(this.args.reaction.emoji,this.args.reaction.reacted?"remove":"add"),this.tooltip.close()}get popoverContent(){if(this.args.reaction.count&&this.args.reaction.users?.length)return(0,c.emojiUnescape)((0,d.getReactionText)(this.args.reaction,this.currentUser))}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"wzg8WR/+",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1],[30,0,["emojiUrl"]]],null],[[[1,"      "],[11,"button"],[24,"tabindex","0"],[16,0,[28,[32,1],["chat-message-reaction",[52,[30,1,["reacted"]],"reacted"],[52,[30,0,["isActive"]],"-active"]],null]],[16,"data-emoji-name",[30,1,["emoji"]]],[16,"title",[30,0,["emojiString"]]],[24,4,"button"],[4,[32,2],["click",[30,0,["handleClick"]]],[["passive"],[true]]],[4,[30,0,["registerTooltip"]],null,null],[12],[1,"\\n        "],[10,"img"],[14,"loading","lazy"],[14,0,"emoji"],[14,"width","20"],[14,"height","20"],[15,"alt",[30,0,["emojiString"]]],[15,"src",[30,0,["emojiUrl"]]],[12],[13],[1,"\\n\\n"],[41,[28,[32,0],[[30,0,["showCount"]],[30,1,["count"]]],null],[[[1,"          "],[10,1],[14,0,"count"],[12],[1,[30,1,["count"]]],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@reaction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-reaction.js",scope:()=>[u.default,l.default,n.on],isStrictMode:!0}),w),b=M((m=w).prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=M(m.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(m.prototype,"tooltip",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(m.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(m.prototype,"isActive",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M(m.prototype,"handleClick",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"handleClick"),m.prototype),M(m.prototype,"popoverContent",[i.cached],Object.getOwnPropertyDescriptor(m.prototype,"popoverContent"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat-message-separator",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","ember-modifier","discourse/helpers/concat-class","discourse-common/helpers/i18n","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b
function g(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function f(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const w="is-pinned"
e.default=(p=new WeakSet,m=new WeakSet,b=new WeakSet,h=class extends t.default{constructor(){super(...arguments),g(this,b),g(this,m),g(this,p),f(this,"track",(0,a.modifier)((e=>{const t=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(w):t.target.classList.remove(w)}),{threshold:[0,1]})
return t.observe(e),()=>{t?.disconnect()}})))}onDateClick(){return this.args.fetchMessagesByDate?.(this.firstMessageOfTheDayAt)}get firstMessageOfTheDayAt(){const e=this.args.message
return e.previousMessage&&v(this,p,_).call(this,e.previousMessage.createdAt,e.createdAt)?void 0:v(this,m,j).call(this,e.createdAt)}get formattedFirstMessageDate(){if(this.firstMessageOfTheDayAt)return v(this,b,M).call(this,this.firstMessageOfTheDayAt)}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"Ld2OGiuY",block:'[[[1,"\\n"],[41,[30,0,["formattedFirstMessageDate"]],[[[1,"      "],[11,0],[16,0,[28,[32,0],["chat-message-separator-date",[52,[30,1,["newest"]],"with-last-visit"]],null]],[24,"role","button"],[4,[32,1],["click",[30,0,["onDateClick"]]],[["passive"],[true]]],[12],[1,"\\n        "],[11,0],[24,0,"chat-message-separator__text-container"],[4,[30,0,["track"]],null,null],[12],[1,"\\n          "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n            "],[1,[30,0,["formattedFirstMessageDate"]]],[1,"\\n\\n"],[41,[30,1,["newest"]],[[[1,"              "],[10,1],[14,0,"chat-message-separator__last-visit"],[12],[1,"\\n                "],[10,1],[14,0,"chat-message-separator__last-visit-separator"],[12],[1,"-"],[13],[1,"\\n                "],[1,[28,[32,2],["chat.last_visit"],null]],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["newest"]],[[[1,"      "],[10,0],[14,0,"chat-message-separator-new"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-separator__text-container"],[12],[1,"\\n          "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n            "],[1,[28,[32,2],["chat.last_visit"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n          "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-separator.js",scope:()=>[s.default,n.on,o.default],isStrictMode:!0}),h),y((d=h).prototype,"onDateClick",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"onDateClick"),d.prototype),y(d.prototype,"firstMessageOfTheDayAt",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"firstMessageOfTheDayAt"),d.prototype),y(d.prototype,"formattedFirstMessageDate",[i.cached],Object.getOwnPropertyDescriptor(d.prototype,"formattedFirstMessageDate"),d.prototype),d)
function _(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function j(e){return moment(e).startOf("day").format()}function M(e){return moment(e).calendar(moment(),{sameDay:`[${l.default.t("chat.chat_message_separator.today")}]`,lastDay:`[${l.default.t("chat.chat_message_separator.yesterday")}]`,lastWeek:"LL",sameElse:"LL"})}})),define("discourse/plugins/chat/discourse/components/chat-message-text",["exports","@glimmer/component","discourse-common/helpers/html-safe","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat-message-collapser","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get isEdited(){return this.args.edited??!1}get isCollapsible(){return(0,r.isCollapsible)(this.args.cooked,this.args.uploads)}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"uDFmalJR",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-text"],[12],[1,"\\n"],[41,[30,0,["isCollapsible"]],[[[1,"        "],[8,[32,0],null,[["@cooked","@uploads","@onToggleCollapse"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],[[[1,"        "],[1,[28,[32,1],[[30,1]],null]],[1,"\\n"]],[]]],[1,"\\n"],[41,[30,0,["isEdited"]],[[[1,"        "],[10,1],[14,0,"chat-message-edited"],[12],[1,"("],[1,[28,[32,2],["chat.edited"],null]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[18,4,null],[1,"\\n    "],[13],[1,"\\n  "]],["@cooked","@uploads","@onToggleCollapse","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-text.js",scope:()=>[r.default,i.default,n.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat-message-thread-indicator",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/service","discourse/helpers/concat-class","discourse/helpers/format-date","discourse/helpers/replace-emoji","discourse-common/helpers/html-safe","discourse-common/helpers/i18n","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse/plugins/chat/discourse/components/chat-thread-participants","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f){"use strict"
var v,y,w,_,j,M,z,O
function C(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(O=class extends t.default{constructor(){super(...arguments),C(this,"capabilities",y,this),C(this,"chat",w,this),C(this,"chatStateManager",_,this),C(this,"router",j,this),C(this,"site",M,this),C(this,"isActive",z,this)}get interactiveUser(){return this.args.interactiveUser??!0}setup(e){this.element=e,this.capabilities.touch&&(this.element.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.addEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchCancel",this.cancelTouch)),this.element.addEventListener("mousedown",this.openThread,{passive:!0}),this.element.addEventListener("keydown",this.openThread,{passive:!0})}teardown(){this.capabilities.touch&&(this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!0}),this.element.removeEventListener("touchmove",this.cancelTouch,{passive:!0}),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchCancel",this.cancelTouch)),this.element.removeEventListener("mousedown",this.openThread,{passive:!0}),this.element.removeEventListener("keydown",this.openThread,{passive:!0})}onTouchStart(e){this.isActive=!0,e.stopPropagation(),this.touching=!0}onTouchEnd(){this.isActive=!1,this.touching&&this.openThread()}cancelTouch(){this.isActive=!1,this.touching=!1}openThread(e){"keydown"===e?.type&&"Enter"!==e?.key||("mousedown"!==e?.type||2!==e?.which&&!e?.shiftKey?(this.chat.activeMessage=null,this.router.transitionTo("chat.channel.thread",...this.args.message.thread.routeModels)):window.open((0,h.default)(this.router.urlFor("chat.channel.thread",...this.args.message.thread.routeModels)),"_blank"))}},(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"1bxogJUz",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-message-thread-indicator",[52,[30,0,["isActive"]],"-active"]],null]],[24,"role","button"],[16,"title",[28,[32,1],["chat.threads.open"],null]],[24,"tabindex","0"],[17,1],[4,[32,2],[[30,0,["setup"]]],null],[4,[32,3],[[30,0,["teardown"]]],null],[12],[1,"\\n\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-avatar"],[12],[1,"\\n        "],[8,[32,4],null,[["@user","@avatarSize","@interactive"],[[30,2,["thread","preview","lastReplyUser"]],"small",[30,0,["interactiveUser"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-info"],[12],[1,"\\n        "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-username"],[12],[1,"\\n          "],[1,[30,2,["thread","preview","lastReplyUser","username"]]],[1,"\\n        "],[13],[1,"\\n        "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-timestamp"],[12],[1,"\\n          "],[1,[28,[32,5],[[30,2,["thread","preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-message-thread-indicator__replies-count"],[12],[1,"\\n        "],[1,[28,[32,1],["chat.thread.replies"],[["count"],[[30,2,["thread","preview","replyCount"]]]]]],[1,"\\n      "],[13],[1,"\\n      "],[8,[32,6],null,[["@thread"],[[30,2,["thread"]]]],null],[1,"\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-excerpt"],[12],[1,"\\n        "],[1,[28,[32,7],[[28,[32,8],[[30,2,["thread","preview","lastReplyExcerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-thread-indicator.js",scope:()=>[o.default,d.default,r.default,a.default,b.default,l.default,m.default,c.default,u.default],isStrictMode:!0}),O),y=k((v=O).prototype,"capabilities",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=k(v.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=k(v.prototype,"chatStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=k(v.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=k(v.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=k(v.prototype,"isActive",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k(v.prototype,"setup",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"setup"),v.prototype),k(v.prototype,"teardown",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"teardown"),v.prototype),k(v.prototype,"onTouchStart",[p.bind],Object.getOwnPropertyDescriptor(v.prototype,"onTouchStart"),v.prototype),k(v.prototype,"onTouchEnd",[p.bind],Object.getOwnPropertyDescriptor(v.prototype,"onTouchEnd"),v.prototype),k(v.prototype,"cancelTouch",[p.bind],Object.getOwnPropertyDescriptor(v.prototype,"cancelTouch"),v.prototype),k(v.prototype,"openThread",[p.bind],Object.getOwnPropertyDescriptor(v.prototype,"openThread"),v.prototype),v)})),define("discourse/plugins/chat/discourse/components/chat-message",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/component","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","ember-modifier","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/optional-service","discourse/lib/update-user-status-on-mention","discourse-common/lib/debounce","discourse-common/lib/later","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/eq","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat/message/avatar","discourse/plugins/chat/discourse/components/chat/message/error","discourse/plugins/chat/discourse/components/chat/message/info","discourse/plugins/chat/discourse/components/chat/message/left-gutter","discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-message-separator","discourse/plugins/chat/discourse/components/chat-message-text","discourse/plugins/chat/discourse/components/chat-message-thread-indicator","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/lib/zoom-check","discourse/plugins/chat/discourse/modifiers/chat/on-long-press","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D,A,N){"use strict"
var I,L,U,R,F,B,W,H,$,V,G,q,K,J,Y,Z,X,Q,ee
function te(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ie(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ne(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function re(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.MESSAGE_CONTEXT_THREAD=e.MENTION_KEYWORDS=void 0,e.addChatMessageDecorator=function(e){ae.push(e)},e.default=void 0,e.resetChatMessageDecorators=function(){ae=[]}
let ae=[]
e.MENTION_KEYWORDS=["here","all"]
const se=e.MESSAGE_CONTEXT_THREAD="thread"
e.default=(ee=new WeakSet,Q=class extends t.default{constructor(){super(...arguments),ie(this,ee),te(this,"site",L,this),te(this,"dialog",U,this),te(this,"currentUser",R,this),te(this,"appEvents",F,this),te(this,"capabilities",B,this),te(this,"chat",W,this),te(this,"chatApi",H,this),te(this,"chatEmojiReactionStore",$,this),te(this,"chatEmojiPickerManager",V,this),te(this,"chatChannelPane",G,this),te(this,"chatThreadPane",q,this),te(this,"chatChannelsManager",K,this),te(this,"router",J,this),te(this,"toasts",Y,this),te(this,"adminTools",Z,this),te(this,"isActive",X,this),ne(this,"toggleCheckIfPossible",(0,h.modifier)((e=>{let t=!1
const i=()=>{this.pane.selectingMessages&&(event.shiftKey?this.messageInteractor.bulkSelect(!this.args.message.selected):this.messageInteractor.select(!this.args.message.selected))}
return this.pane.selectingMessages&&(e.addEventListener("click",i,{passive:!0}),t=!0),()=>{t&&e.removeEventListener("click",i)}}))),this.initMentionedUsers()}get pane(){return this.args.context===se?this.chatThreadPane:this.chatChannelPane}get messageInteractor(){return new x.default((0,n.getOwner)(this),this.args.message,this.args.context)}get deletedAndCollapsed(){return this.args.message?.deletedAt&&this.collapsed}get hiddenAndCollapsed(){return this.args.message?.hidden&&this.collapsed}get collapsed(){return!this.args.message?.expanded}get deletedMessageLabel(){let e=1
const t=i=>{const n=i.previousMessage
n?.deletedAt&&(e++,t(n))}
return t(this.args.message),w.default.t("chat.deleted",{count:e})}get shouldRender(){return this.args.message.expanded||!this.args.message.deletedAt||this.args.message.deletedAt&&!this.args.message.nextMessage?.deletedAt}get shouldRenderOpenEmojiPickerButton(){return this.chat.userCanInteractWithChat&&this.site.desktopView}get secondaryActionsIsExpanded(){return document.querySelector(".more-buttons.secondary-actions.is-expanded")}expand(){const e=t=>{const i=t.previousMessage
i?.deletedAt&&(i.expanded=!0,e(i))}
this.args.message.expanded=!0,this.refreshStatusOnMentions(),e(this.args.message)}toggleChecked(e){e.stopPropagation(),e.shiftKey?this.messageInteractor.bulkSelect(e.target.checked):this.messageInteractor.select(e.target.checked)}willDestroyMessage(){(0,u.cancel)(this._invitationSentTimer),(0,u.cancel)(this._disableMessageActionsHandler),(0,u.cancel)(this._makeMessageActiveHandler),(0,u.cancel)(this._debounceDecorateCookedMessageHandler),function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,ee,oe).call(this),this.chat.activeMessage=null}refreshStatusOnMentions(){(0,u.schedule)("afterRender",(()=>{this.args.message.mentionedUsers.forEach((e=>{const t=`/u/${e.username.toLowerCase()}`
this.messageContainer.querySelectorAll(`a.mention[href="${t}"]`).forEach((t=>{(0,g.updateUserStatusOnMention)((0,n.getOwner)(this),t,e.status)}))}))}))}didInsertMessage(e){this.messageContainer=e,this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions()}didUpdateMessageId(){this.debounceDecorateCookedMessage()}didUpdateMessageVersion(){this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions(),this.initMentionedUsers()}debounceDecorateCookedMessage(){this._debounceDecorateCookedMessageHandler=(0,f.default)(this,this.decorateCookedMessage,this.args.message,100)}decorateCookedMessage(e){(0,u.schedule)("afterRender",(()=>{ae.forEach((t=>{t.call(this,this.messageContainer,e.channel)}))}))}initMentionedUsers(){this.args.message.mentionedUsers.forEach((e=>{e.isTrackingStatus()||(e.trackStatus(),e.on("status-changed",this,"refreshStatusOnMentions"))}))}get show(){return!this.args.message?.deletedAt||this.currentUser.id===this.args.message?.user?.id||this.currentUser.staff||this.args.message?.channel?.canModerate}onMouseEnter(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||(this._onMouseEnterMessageDebouncedHandler=(0,f.default)(this,this._debouncedOnHoverMessage,250)))}onMouseMove(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||this._setActiveMessage())}onMouseLeave(e){(0,u.cancel)(this._onMouseEnterMessageDebouncedHandler),this.site.mobileView||(e.toElement||e.relatedTarget)?.closest(".chat-message-actions-container")||this.secondaryActionsIsExpanded||(this.chat.activeMessage=null)}_debouncedOnHoverMessage(){this._setActiveMessage()}_setActiveMessage(){this.args.disableMouseEvents||((0,u.cancel)(this._onMouseEnterMessageDebouncedHandler),this.chat.userCanInteractWithChat&&this.args.message.expanded&&(this.chat.activeMessage={model:this.args.message,context:this.args.context}))}onLongPressStart(e,t){this.args.message.expanded&&this.args.message.persisted&&"IMG"!==t.target.tagName&&(this._makeMessageActiveHandler=(0,v.default)((()=>{this.isActive=!0}),125))}onLongPressCancel(){(0,u.cancel)(this._makeMessageActiveHandler),this.isActive=!1,this._disableMessageActionsHandler=(0,v.default)((()=>{document.documentElement.classList.remove("disable-message-actions-touch")}),200)}onLongPressEnd(e,t){"IMG"!==t.target.tagName&&((0,u.cancel)(this._makeMessageActiveHandler),this.isActive=!1,(0,D.default)()||(document.documentElement.classList.add("disable-message-actions-touch"),document.activeElement.blur(),document.querySelector(".chat-composer__input")?.blur(),this._setActiveMessage()))}get hasActiveState(){return this.isActive||this.chat.activeMessage?.model?.id===this.args.message.id}get hasReply(){return this.args.message.inReplyTo&&!this.hideReplyToInfo}get hideUserInfo(){const e=this.args.message,t=e.previousMessage
return!!t&&(!e.firstOfResults&&(!e.chatWebhookEvent&&(!t.deletedAt&&(!(Math.abs(new Date(e.createdAt)-new Date(t.createdAt))>3e5)&&(e.inReplyTo?e.inReplyTo?.id===t.id&&e.user?.id===t.user?.id:e.user?.id===t.user?.id)))))}get hideReplyToInfo(){return this.args.context===se||this.args.message?.inReplyTo?.id===this.args.message?.previousMessage?.id||this.threadingEnabled}get threadingEnabled(){return this.args.message?.channel?.threadingEnabled&&!!this.args.message?.thread}get showThreadIndicator(){return this.args.context!==se&&this.threadingEnabled&&this.args.message?.thread&&this.args.message?.thread.preview.replyCount>0}},(0,r.setComponentTemplate)((0,N.createTemplateFactory)({id:"JArkOVc6",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],null,[["@fetchMessagesByDate","@message"],[[30,1],[30,2]]],null],[1,"\\n\\n      "],[11,0],[16,0,[28,[32,1],["chat-message-container",[52,[30,0,["pane","selectingMessages"]],"-selectable"],[52,[30,2,["highlighted"]],"-highlighted"],[52,[28,[32,2],[[30,2,["user","id"]],[30,0,["currentUser","id"]]],null],"is-by-current-user"],[52,[30,2,["staged"]],"-staged","-persisted"],[52,[30,2,["processed"]],"-processed","-not-processed"],[52,[30,0,["hasActiveState"]],"-active"],[52,[30,2,["bookmark"]],"-bookmarked"],[52,[30,2,["deletedAt"]],"-deleted"],[52,[30,2,["selected"]],"-selected"],[52,[30,2,["error"]],"-errored"],[52,[30,0,["showThreadIndicator"]],"has-thread-indicator"],[52,[30,0,["hideUserInfo"]],"-user-info-hidden"],[52,[30,0,["hasReply"]],"has-reply"]],null]],[16,"data-id",[30,2,["id"]]],[16,"data-thread-id",[30,2,["thread","id"]]],[17,3],[4,[32,3],[[30,0,["didInsertMessage"]]],null],[4,[32,4],[[30,0,["didUpdateMessageId"]],[30,2,["id"]]],null],[4,[32,4],[[30,0,["didUpdateMessageVersion"]],[30,2,["version"]]],null],[4,[32,5],[[30,0,["willDestroyMessage"]]],null],[4,[32,6],["mouseenter",[30,0,["onMouseEnter"]]],[["passive"],[true]]],[4,[32,6],["mouseleave",[30,0,["onMouseLeave"]]],[["passive"],[true]]],[4,[32,6],["mousemove",[30,0,["onMouseMove"]]],[["passive"],[true]]],[4,[30,0,["toggleCheckIfPossible"]],null,null],[4,[32,7],[[30,0,["onLongPressStart"]],[30,0,["onLongPressEnd"]],[30,0,["onLongPressCancel"]]],null],[12],[1,"\\n"],[41,[30,0,["show"]],[[[41,[30,0,["pane","selectingMessages"]],[[[1,"            "],[8,[32,8],[[24,0,"chat-message-selector"],[4,[32,6],["click",[30,0,["toggleChecked"]]],null]],[["@type","@checked"],["checkbox",[30,2,["selected"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["deletedAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -deleted"],[12],[1,"\\n              "],[8,[32,9],[[24,0,"btn-flat chat-message-expand"]],[["@action","@translatedLabel"],[[30,0,["expand"]],[30,0,["deletedMessageLabel"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[41,[30,0,["hiddenAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -hidden"],[12],[1,"\\n              "],[8,[32,9],[[24,0,"btn-flat chat-message-expand"]],[["@action","@label"],[[30,0,["expand"]],"chat.hidden"]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"chat-message"],[12],[1,"\\n"],[41,[51,[30,0,["hideReplyToInfo"]]],[[[1,"                "],[8,[32,10],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hideUserInfo"]],[[[1,"                "],[8,[32,11],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]],[[[1,"                "],[8,[32,12],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]]],[1,"\\n              "],[10,0],[14,0,"chat-message-content"],[12],[1,"\\n                "],[8,[32,13],null,[["@message","@show"],[[30,2],[28,[32,14],[[30,0,["hideUserInfo"]]],null]]],null],[1,"\\n\\n                "],[8,[32,15],null,[["@cooked","@uploads","@edited"],[[30,2,["cooked"]],[30,2,["uploads"]],[30,2,["edited"]]]],[["default"],[[[[1,"\\n"],[41,[30,2,["reactions","length"]],[[[1,"                    "],[10,0],[14,0,"chat-message-reaction-list"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,2,["reactions"]]],null]],null],null,[[[1,"                        "],[8,[32,16],null,[["@reaction","@onReaction","@message","@showTooltip"],[[30,4],[30,0,["messageInteractor","react"]],[30,2],true]],null],[1,"\\n"]],[4]],null],[1,"\\n"],[41,[30,0,["shouldRenderOpenEmojiPickerButton"]],[[[1,"                        "],[8,[32,9],[[24,0,"chat-message-react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"                    "],[13],[1,"\\n"]],[]],null],[1,"                "]],[]]]]],[1,"\\n\\n                "],[8,[32,17],null,[["@message","@onRetry"],[[30,2],[30,5]]],null],[1,"\\n              "],[13],[1,"\\n\\n"],[41,[30,0,["showThreadIndicator"]],[[[1,"                "],[8,[32,18],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "]],[]]]],[]]]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@fetchMessagesByDate","@message","&attrs","reaction","@resendStagedMessage"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message.js",scope:()=>[P.default,m.default,_.default,o.default,l.default,c.default,a.on,A.default,r.Input,p.default,k.default,C.default,M.default,O.default,j.default,T.default,S.default,z.default,E.default],isStrictMode:!0}),Q),L=re((I=Q).prototype,"site",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=re(I.prototype,"dialog",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=re(I.prototype,"currentUser",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=re(I.prototype,"appEvents",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=re(I.prototype,"capabilities",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=re(I.prototype,"chat",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=re(I.prototype,"chatApi",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=re(I.prototype,"chatEmojiReactionStore",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=re(I.prototype,"chatEmojiPickerManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=re(I.prototype,"chatChannelPane",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=re(I.prototype,"chatThreadPane",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=re(I.prototype,"chatChannelsManager",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=re(I.prototype,"router",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=re(I.prototype,"toasts",[d.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=re(I.prototype,"adminTools",[b.default],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=re(I.prototype,"isActive",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),re(I.prototype,"expand",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"expand"),I.prototype),re(I.prototype,"toggleChecked",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"toggleChecked"),I.prototype),re(I.prototype,"willDestroyMessage",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"willDestroyMessage"),I.prototype),re(I.prototype,"refreshStatusOnMentions",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"refreshStatusOnMentions"),I.prototype),re(I.prototype,"didInsertMessage",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"didInsertMessage"),I.prototype),re(I.prototype,"didUpdateMessageId",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"didUpdateMessageId"),I.prototype),re(I.prototype,"didUpdateMessageVersion",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"didUpdateMessageVersion"),I.prototype),re(I.prototype,"decorateCookedMessage",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"decorateCookedMessage"),I.prototype),re(I.prototype,"initMentionedUsers",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"initMentionedUsers"),I.prototype),re(I.prototype,"onMouseEnter",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onMouseEnter"),I.prototype),re(I.prototype,"onMouseMove",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onMouseMove"),I.prototype),re(I.prototype,"onMouseLeave",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onMouseLeave"),I.prototype),re(I.prototype,"_debouncedOnHoverMessage",[y.bind],Object.getOwnPropertyDescriptor(I.prototype,"_debouncedOnHoverMessage"),I.prototype),re(I.prototype,"onLongPressStart",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onLongPressStart"),I.prototype),re(I.prototype,"onLongPressCancel",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onLongPressCancel"),I.prototype),re(I.prototype,"onLongPressEnd",[s.action],Object.getOwnPropertyDescriptor(I.prototype,"onLongPressEnd"),I.prototype),I)
function oe(){this.args.message.mentionedUsers.forEach((e=>{e.stopTrackingStatus(),e.off("status-changed",this,"refreshStatusOnMentions")}))}})),define("discourse/plugins/chat/discourse/components/chat-notice",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p={mention_without_membership:a.default}
e.default=(l=(0,n.inject)("chat-channel-notices-manager"),d=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="noticesManager",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}clearNotice(){this.noticesManager.clearNotice(this.args.notice)}get component(){return p[this.args.notice.type]}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"KWUTxAH3",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-notices__notice"],[12],[1,"\\n\\n"],[41,[30,1,["textContent"]],[[[1,"        "],[10,2],[14,0,"chat-notices__notice__content"],[12],[1,"\\n          "],[1,[30,1,["textContent"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[8,[30,0,["component"]],null,[["@channel","@notice","@clearNotice"],[[30,2],[30,1],[30,0,["clearNotice"]]]],null],[1,"\\n"]],[]]],[1,"\\n      "],[8,[32,0],[[24,0,"btn-flat chat-notices__notice__clear"]],[["@icon","@action"],["times",[30,0,["clearNotice"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@notice","@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-notice.js",scope:()=>[r.default],isStrictMode:!0}),d),u=h((c=d).prototype,"noticesManager",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(c.prototype,"clearNotice",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"clearNotice"),c.prototype),c)})),define("discourse/plugins/chat/discourse/components/chat-notices",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/components/chat-notice","discourse/plugins/chat/discourse/components/chat-retention-reminder","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=(0,i.inject)("chat-channel-notices-manager"),u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="noticesManager",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get noticesForChannel(){return this.noticesManager.notices.filter((e=>e.channelId===this.args.channel.id))}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"w5+Mqhw3",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-notices"],[12],[1,"\\n      "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["noticesForChannel"]]],null]],null],null,[[[1,"        "],[8,[32,1],null,[["@notice","@channel"],[[30,2],[30,1]]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n  "]],["@channel","notice"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-notices.js",scope:()=>[r.default,n.default],isStrictMode:!0}),u),d=(l=u).prototype,h="noticesManager",p=[o],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat-replying-indicator",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/service","@ember/utils","discourse/helpers/concat-class","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(f=class extends t.default{constructor(){super(...arguments),v(this,"currentUser",m,this),v(this,"presence",b,this),v(this,"presenceChannel",g,this)}async updateSubscription(){await this.unsubscribe(),await this.subscribe()}async subscribe(){this.presenceChannel=this.presence.getChannel(this.args.presenceChannelName),await this.presenceChannel.subscribe()}async unsubscribe(){this.presenceChannel?.subscribed&&await this.presenceChannel.unsubscribe()}get users(){return this.presenceChannel?.get("users")?.filter((e=>e.id!==this.currentUser.id))||[]}get usernames(){return this.users.mapBy("username")}get text(){if(1===this.usernames.length)return u.default.t("chat.replying_indicator.single_user",{username:this.usernames[0]})
if(this.usernames.length<4){const e=this.usernames[this.usernames.length-1],t=this.usernames.slice(0,this.usernames.length-1).join(u.default.t("word_connector.comma"))
return u.default.t("chat.replying_indicator.multiple_users",{commaSeparatedUsernames:t,lastUsername:e})}const e=this.usernames.slice(0,2).join(u.default.t("word_connector.comma"))
return u.default.t("chat.replying_indicator.many_users",{commaSeparatedUsernames:e,count:this.usernames.length-2})}get shouldRender(){return(0,l.isPresent)(this.usernames)}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"mY3LAGZX",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[11,0],[16,0,[28,[32,0],["chat-replying-indicator",[52,[30,0,["presenceChannel","subscribed"]],"is-subscribed"]],null]],[4,[32,1],[[30,0,["subscribe"]]],null],[4,[32,2],[[30,0,["updateSubscription"]],[30,1]],null],[4,[32,3],[[30,0,["unsubscribe"]]],null],[12],[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"          "],[10,1],[14,0,"chat-replying-indicator__text"],[12],[1,[30,0,["text"]]],[13],[1,"\\n          "],[10,1],[14,0,"chat-replying-indicator__wave"],[12],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@presenceChannelName"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-replying-indicator.js",scope:()=>[c.default,r.default,a.default,s.default],isStrictMode:!0}),f),m=y((p=f).prototype,"currentUser",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=y(p.prototype,"presence",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=y(p.prototype,"presenceChannel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y(p.prototype,"updateSubscription",[n.action],Object.getOwnPropertyDescriptor(p.prototype,"updateSubscription"),p.prototype),y(p.prototype,"subscribe",[n.action],Object.getOwnPropertyDescriptor(p.prototype,"subscribe"),p.prototype),y(p.prototype,"unsubscribe",[n.action],Object.getOwnPropertyDescriptor(p.prototype,"unsubscribe"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder-text",["exports","@glimmer/component","@ember/service","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function d(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=new WeakMap,l=class extends t.default{constructor(){var e,t,i,n
super(...arguments),u(this,c,{get:v,set:void 0}),e=this,t="siteSettings",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get type(){return this.args.type??"long"}get text(){return this.args.channel.isDirectMessageChannel?d(this,c)>0?n.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_dm_retention_days}):n.default.t(`chat.retention_reminders.indefinitely_${this.type}`):d(this,c)>0?n.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_channel_retention_days}):n.default.t(`chat.retention_reminders.indefinitely_${this.type}`)}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"jf5EPrBy",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-retention-reminder-text"],[12],[1,"\\n      "],[1,[30,0,["text"]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder-text.js",isStrictMode:!0}),l),h=(s=l).prototype,p="siteSettings",m=[i.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),o=f,s)
var h,p,m,b,g,f
function v(){return this.args.channel.isDirectMessageChannel?this.siteSettings.chat_dm_retention_days:this.siteSettings.chat_channel_retention_days}})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get show(){return this.args.channel?.isDirectMessageChannel&&this.currentUser?.get("needs_dm_retention_reminder")||this.args.channel?.isCategoryChannel&&this.currentUser?.get("needs_channel_retention_reminder")}async dismiss(){try{await(0,a.ajax)("/chat/dismiss-retention-reminder",{method:"POST",data:{chatable_type:this.args.channel.chatableType}})
const e=this.args.channel.isDirectMessageChannel?"needs_dm_retention_reminder":"needs_channel_retention_reminder"
this.currentUser.set(e,!1)}catch(e){(0,s.popupAjaxError)(e)}}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"zn7vf8Hz",block:'[[[1,"\\n"],[41,[30,0,["show"]],[[[1,"      "],[10,0],[14,0,"chat-retention-reminder"],[12],[1,"\\n        "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[8,[32,1],[[24,0,"btn no-text btn-icon btn-flat no-text dismiss-btn"]],[["@action","@icon"],[[30,0,["dismiss"]],"times"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder.js",scope:()=>[o.default,r.default],isStrictMode:!0}),h),d=p((u=h).prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(u.prototype,"dismiss",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"dismiss"),u.prototype),u)})),define("discourse/plugins/chat/discourse/components/chat-side-panel-resizer",["exports","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,t.createTemplateFactory)({id:"zRFG2Lu3",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-side-panel-resizer"],[12],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-side-panel-resizer.js",isStrictMode:!0}),(0,n.default)())
e.default=r})),define("discourse/plugins/chat/discourse/components/chat-side-panel",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","@ember/template","truth-helpers/helpers/and","discourse/plugins/chat/discourse/modifiers/chat/resizable-node","discourse/plugins/chat/discourse/components/chat-side-panel-resizer","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=new WeakSet,v=class extends t.default{constructor(){super(...arguments),_(this,y),w(this,"chatStateManager",m,this),w(this,"chatSidePanelSize",b,this),w(this,"site",g,this),w(this,"widthStyle",f,this)}setupSize(){this.widthStyle=(0,o.htmlSafe)(`width:${this.chatSidePanelSize.width}px`)}didResize(e,t){if(this.isDestroying||this.isDestroyed)return
e.parentElement.getBoundingClientRect().width-t.width>=250&&(this.chatSidePanelSize.width=t.width,e.style.width=t.width+"px",this.widthStyle=(0,o.htmlSafe)(`width:${t.width}px`))}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"1KF7uXu1",block:'[[[1,"\\n"],[41,[30,0,["chatStateManager","isSidePanelExpanded"]],[[[1,"      "],[11,0],[24,0,"chat-side-panel"],[16,5,[52,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["chatStateManager","isFullPageActive"]]],null],[30,0,["widthStyle"]]]],[4,[32,1],[[30,0,["setupSize"]]],null],[4,[32,2],[".chat-side-panel-resizer",[30,0,["didResize"]],[28,[32,3],null,[["position","vertical","mutate","resetOnWindowResize"],[false,false,false,true]]]],null],[12],[1,"\\n        "],[18,1,null],[1,"\\n\\n"],[41,[30,0,["site","desktopView"]],[[[1,"          "],[8,[32,4],null,null,null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-side-panel.js",scope:()=>[l.default,a.default,c.default,n.hash,u.default],isStrictMode:!0}),v),m=j((p=v).prototype,"chatStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=j(p.prototype,"chatSidePanelSize",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(p.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=j(p.prototype,"widthStyle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j(p.prototype,"setupSize",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"setupSize"),p.prototype),j(p.prototype,"didResize",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"didResize"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat-skeleton",["exports","@glimmer/component","@ember/template","@ember/template-factory","@ember/component"],(function(e,t,i,n,r){"use strict"
var a
function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function o(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var l=new WeakSet
class c extends t.default{constructor(){super(...arguments),s(this,l)}get placeholders(){return Array.from({length:15},(()=>({image:5===o(this,l,u).call(this,1,10),rows:Array.from({length:o(this,l,u).call(this,1,5)},(()=>(0,i.htmlSafe)(`width: ${o(this,l,u).call(this,20,95)}%`))),reactions:Array.from({length:o(this,l,u).call(this,0,3)})})))}}function u(e,t){return Math.floor(Math.random()*(t-e+1)+e)}e.default=c,a=c,(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"roMafkk/",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-skeleton -animation"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["placeholders"]]],null]],null],null,[[[1,"        "],[10,0],[14,0,"chat-skeleton__body"],[12],[1,"\\n          "],[10,0],[14,0,"chat-skeleton__message"],[12],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-avatar"],[12],[13],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-poster"],[12],[13],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-content"],[12],[1,"\\n"],[41,[30,1,["image"]],[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-img"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n              "],[10,0],[14,0,"chat-skeleton__message-text"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1,["rows"]]],null]],null],null,[[[1,"                  "],[10,0],[14,0,"chat-skeleton__message-msg"],[15,5,[30,2]],[12],[13],[1,"\\n"]],[2]],null],[1,"              "],[13],[1,"\\n\\n"],[41,[30,1,["reactions"]],[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-reactions"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1,["reactions"]]],null]],null],null,[[[1,"                    "],[10,0],[14,0,"chat-skeleton__message-reaction"],[12],[13],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n  "]],["placeholder","row"],false,["each","-track-array","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-skeleton.js",isStrictMode:!0}),a)})),define("discourse/plugins/chat/discourse/components/chat-thread-list",["exports","@glimmer/component","@glimmer/tracking","@ember/service","ember-modifier","discourse/components/conditional-loading-spinner","discourse/lib/is-element-in-viewport","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat/thread-list/item","discourse/plugins/chat/discourse/modifiers/chat/track-message","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=class extends t.default{constructor(){super(...arguments),w(this,"chat",b,this),w(this,"chatApi",g,this),w(this,"messageBus",f,this),w(this,"chatTrackingStateManager",v,this),_(this,"noThreadsLabel",l.default.t("chat.threads.none")),_(this,"subscribe",(0,r.modifier)(((e,t)=>{let[i]=t
return this.messageBus.subscribe(`/chat/${i.id}`,this.onMessageBus,i.channelMessageBusLastId),()=>{i&&this.messageBus.unsubscribe(`/chat/${i.id}`,this.onMessageBus)}}))),_(this,"fill",(0,r.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,s.default)(e)&&this.loadThreads()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()})))),_(this,"loadMore",(0,r.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.loadThreads),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))}get threadsCollection(){return this.chatApi.threads(this.args.channel.id,this.handleLoadedThreads)}loadThreads(){this.threadsCollection.load({limit:10})}get threadsManager(){return this.args.channel.threadsManager}get sortedThreads(){return this.threadsManager.threads.filter((e=>!e.originalMessage.deletedAt)).sort(((e,t)=>e.tracking.unreadCount&&t.tracking.unreadCount?e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1:e.tracking.unreadCount?-1:t.tracking.unreadCount?1:e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1))}get lastThread(){return this.sortedThreads[this.sortedThreads.length-1]}get shouldRender(){return!!this.args.channel}onMessageBus(e){switch(e.type){case"delete":this.handleDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)}}handleDeleteMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.deleted_id)
t&&(t.originalMessage.deletedAt=new Date)}handleRestoreMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.chat_message.id)
t&&(t.originalMessage.deletedAt=null)}handleLoadedThreads(e){return e.threads.map((t=>{const i=this.threadsManager.add(this.args.channel,t,{replace:!0})
return this.chatTrackingStateManager.setupChannelThreadState(this.args.channel,e.tracking),i}))}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"puIZL12K",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[11,0],[24,0,"chat-thread-list"],[4,[30,0,["subscribe"]],[[30,1]],null],[12],[1,"\\n        "],[11,0],[24,0,"chat-thread-list__items"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["sortedThreads"]]],null]],null],"id",[[[1,"            "],[8,[32,0],[[4,[52,[28,[32,1],[[30,2],[30,0,["lastThread"]]],null],[50,[32,2],2,[[30,0,["load"]]],null]],null,null]],[["@thread"],[[30,2]]],null],[1,"\\n"]],[2]],[[[41,[30,0,["threadsCollection","fetchedOnce"]],[[[1,"              "],[10,0],[14,0,"chat-thread-list__no-threads"],[12],[1,"\\n                "],[1,[30,0,["noThreadsLabel"]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"\\n          "],[8,[32,3],null,[["@condition"],[[30,0,["threadsCollection","loading"]]]],null],[1,"\\n\\n          "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n            "],[10,"br"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel","thread"],false,["if","each","-track-array","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-list.js",scope:()=>[u.default,c.default,d.default,a.default],isStrictMode:!0}),y),b=j((m=y).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(m.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=j(m.prototype,"messageBus",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=j(m.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j(m.prototype,"threadsCollection",[i.cached],Object.getOwnPropertyDescriptor(m.prototype,"threadsCollection"),m.prototype),j(m.prototype,"loadThreads",[o.bind],Object.getOwnPropertyDescriptor(m.prototype,"loadThreads"),m.prototype),j(m.prototype,"sortedThreads",[i.cached],Object.getOwnPropertyDescriptor(m.prototype,"sortedThreads"),m.prototype),j(m.prototype,"onMessageBus",[o.bind],Object.getOwnPropertyDescriptor(m.prototype,"onMessageBus"),m.prototype),j(m.prototype,"handleLoadedThreads",[o.bind],Object.getOwnPropertyDescriptor(m.prototype,"handleLoadedThreads"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat-thread-participants",["exports","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get showParticipants(){if(this.args.thread)return this.includeOriginalMessageUser?this.participantsUsers.length>1:this.participantsUsers.length>0}get includeOriginalMessageUser(){return this.args.includeOriginalMessageUser??!0}get participantsUsers(){const e=this.args.thread.preview.participantUsers
return this.includeOriginalMessageUser?e.length>3?e.slice(0,2).concat(e[e.length-1]):e:e.filter((e=>e.id!==this.args.thread.originalMessage.user.id))}get otherCountLabel(){return i.default.t("chat.thread.participants_other_count",{count:this.args.thread.preview.otherParticipantCount})}}e.default=o,s=o,(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"uIyMf295",block:'[[[1,"\\n"],[41,[30,0,["showParticipants"]],[[[1,"      "],[11,0],[24,0,"chat-thread-participants"],[17,1],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-participants__avatar-group"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["participantsUsers"]]],null]],null],null,[[[1,"            "],[8,[32,0],null,[["@user","@avatarSize","@showPresence","@interactive"],[[30,2],"tiny",false,false]],null],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n"],[41,[30,3,["preview","otherParticipantCount"]],[[[1,"          "],[10,0],[14,0,"chat-thread-participants__other-count"],[12],[1,"\\n            "],[1,[30,0,["otherCountLabel"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&attrs","user","@thread"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-participants.js",scope:()=>[n.default],isStrictMode:!0}),s)})),define("discourse/plugins/chat/discourse/components/chat-thread-tracking-dropdown",["exports","select-kit/components/notifications-button","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.default.extend({pluginApiIdentifiers:["thread-notifications-button"],classNames:["thread-notifications-button"],content:i.threadNotificationButtonLevels,selectKitOptions:{i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat"}})})),define("discourse/plugins/chat/discourse/components/chat-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/application","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/desktop-notifications","discourse/lib/notification-levels","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/chat-channel-thread-subscription-manager","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/dates-separators-positioner","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/user-chat-thread-membership","discourse/plugins/chat/discourse/modifiers/chat/on-resize","discourse/plugins/chat/discourse/modifiers/chat/scrollable-list","discourse/plugins/chat/discourse/components/chat/composer/thread","discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow","discourse/plugins/chat/discourse/components/chat/selection-manager","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/components/chat-skeleton","discourse/plugins/chat/discourse/components/chat-upload-drop-zone","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D){"use strict"
var A,N,I,L,U,R,F,B,W,H,$,V,G,q,K,J,Y,Z,X,Q,ee,te
function ie(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ne(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function re(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ae(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function se(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(X=new WeakSet,Q=new WeakSet,ee=new WeakSet,te=new WeakSet,Z=class extends t.default{constructor(){super(...arguments),ne(this,te),ne(this,ee),ne(this,Q),ne(this,X),ie(this,"appEvents",N,this),ie(this,"capabilities",I,this),ie(this,"chat",L,this),ie(this,"chatApi",U,this),ie(this,"chatComposerPresenceManager",R,this),ie(this,"chatHistory",F,this),ie(this,"chatDraftsManager",B,this),ie(this,"chatThreadComposer",W,this),ie(this,"chatThreadPane",H,this),ie(this,"currentUser",$,this),ie(this,"router",V,this),ie(this,"siteSettings",G,this),ie(this,"isAtBottom",q,this),ie(this,"isScrolling",K,this),ie(this,"needsArrow",J,this),ie(this,"uploadDropZone",Y,this),re(this,"scrollable",null)}resetIdle(){(0,h.resetIdle)()}get messagesLoader(){return new y.default((0,n.getOwner)(this),this.args.thread)}get messagesManager(){return this.args.thread.messagesManager}handleKeydown(e){if("Escape"===e.key)return this.router.transitionTo("chat.channel",...this.args.thread.channel.routeModels)}setup(e){this.uploadDropZone=e,this.messagesManager.clear(),this.args.thread.draft=this.chatDraftsManager.get(this.args.thread.channel?.id,this.args.thread.id)||j.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread}),this.chatThreadComposer.focus(),this.loadMessages()}teardown(){this.subscriptionManager.teardown(),(0,l.cancel)(this._debouncedFillPaneAttemptHandler),(0,l.cancel)(this._debounceUpdateLastReadMessageHandler)}onScroll(e){(0,l.next)((()=>{ae(this,te,ue).call(this)||((0,v.bodyScrollFix)(),w.default.apply(this.scrollable),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debounceUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:f.PAST}):e.atBottom&&this.fetchMoreMessages({direction:f.FUTURE}))}))}onScrollEnd(e){this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.resetIdle(),this.atBottom=e.atBottom,this.args.setFullTitle?.(e.atTop),e.atBottom&&this.fetchMoreMessages({direction:f.FUTURE})}debounceUpdateLastReadMessage(){this._debounceUpdateLastReadMessageHandler=(0,m.default)(this,this.updateLastReadMessage,f.READ_INTERVAL_MS)}updateLastReadMessage(){this.markThreadAsRead()}setScrollable(e){this.scrollable=e}loadMessages(){this.fetchMessages(),this.subscriptionManager=new g.default(this,this.args.thread,{onNewMessage:this.onNewMessage})}didResizePane(){this._ignoreNextScroll=!0,this.debounceFillPaneAttempt(),this.debounceUpdateLastReadMessage(),w.default.apply(this.scrollable)}async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear(),e.targetMessageId??=this.args.targetMessageId||this.args.thread.currentUserMembership?.lastReadMessageId,e.targetMessageId||(e.direction=f.FUTURE)
const t=await this.messagesLoader.load(e)
if(!t)return
const[i,n]=this.processMessages(this.args.thread,t);(0,v.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(i)})),this.args.thread.details=n,this.args.targetMessageId?this.scrollToMessageId(this.args.targetMessageId,{highlight:!0}):this.args.thread.currentUserMembership?.lastReadMessageId?this.scrollToMessageId(this.args.thread.currentUserMembership?.lastReadMessageId):this.scrollToTop(),this.debounceFillPaneAttempt()}async fetchMoreMessages(e){let{direction:t}=e
if(this.messagesLoader.loading)return
const i=await this.messagesLoader.loadMore({direction:t})
if(!i)return
const[n,r]=this.processMessages(this.args.thread,i)
n?.length&&((0,v.stackingContextFix)(this.scrollable,(()=>{this.messagesManager.addMessages(n)})),this.args.thread.details=r,t===f.FUTURE?this.scrollToMessageId(n.firstObject.id,{position:"end",behavior:"auto"}):t===f.PAST&&this.scrollToMessageId(n.lastObject.id),this.debounceFillPaneAttempt())}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom()}debounceFillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this._debouncedFillPaneAttemptHandler=(0,m.default)(this,this.fillPaneAttempt,500))}async fillPaneAttempt(){if(this.messagesManager.messages.length>200)return
if(!this.messagesLoader.canLoadMorePast)return
const e=this.messagesManager.messages.firstObject
e?.visible&&await this.fetchMoreMessages({direction:f.PAST})}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1,position:"start",autoExpand:!1}
this._ignoreNextScroll=!0
const i=this.messagesManager.findMessage(e);(0,_.scrollListToMessage)(this.scrollable,i,t)}onNewMessage(e){this.messagesManager.addMessages([e])}processMessages(e,t){return[t.messages.map((t=>{const i=(this.currentUser.ignored_users||[]).includes(t.user.username)
return j.default.create(e.channel,{...t,hidden:i,expanded:!(i||t.deleted_at),manager:this.messagesManager,thread:e})})),t.meta]}markThreadAsRead(){if(this.args.thread)return this.chatApi.markThreadAsRead(this.args.thread.channel.id,this.args.thread.id)}async onSendMessage(e){(0,h.resetIdle)(),await e.cook(),e.editing?await ae(this,Q,le).call(this,e):await ae(this,X,oe).call(this,e)}fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:f.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const i=this.messagesManager.findMessage(e)
i?this.scrollToMessageId(i.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e})}resetComposerMessage(){this.args.thread.draft=j.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread})}scrollToBottom(){this._ignoreNextScroll=!0,(0,_.scrollListToBottom)(this.scrollable)}scrollToTop(){this._ignoreNextScroll=!0,(0,_.scrollListToTop)(this.scrollable)}resendStagedMessage(){}},(0,D.setComponentTemplate)((0,x.createTemplateFactory)({id:"Xn3lbkVn",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-thread",[52,[30,0,["messagesLoader","loading"]],"loading"]],null]],[16,"data-id",[30,1,["id"]]],[4,[32,1],[[30,0,["setup"]]],null],[4,[32,2],[[30,0,["teardown"]]],null],[12],[1,"\\n      "],[11,0],[24,0,"chat-thread__body popper-viewport chat-messages-scroll"],[4,[32,1],[[30,0,["setScrollable"]]],null],[4,[32,3],[[28,[32,4],null,[["onScroll","onScrollEnd","reverse"],[[30,0,["onScroll"]],[30,0,["onScrollEnd"]],true]]]],null],[12],[1,"\\n        "],[11,0],[24,0,"chat-messages-container"],[4,[32,5],[[30,0,["didResizePane"]],[28,[32,4],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"            "],[8,[32,6],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,2],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"thread"]],null],[1,"\\n"]],[2]],null],[1,"\\n"],[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[41,[30,0,["messagesLoader","loading"]],[[[1,"              "],[8,[32,7],null,null,null],[1,"\\n"]],[]],null]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,8],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["chatThreadPane","selectingMessages"]],[[[1,"        "],[8,[32,9],null,[["@pane"],[[30,0,["chatThreadPane"]]]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[32,10],null,[["@channel","@thread","@onSendMessage","@uploadDropZone"],[[30,3],[30,1],[30,0,["onSendMessage"]],[30,0,["uploadDropZone"]]]],null],[1,"\\n"]],[]]],[1,"\\n      "],[8,[32,11],null,[["@model"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@thread","message","@channel"],false,["if","each","-track-array","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread.js",scope:()=>[u.default,s.default,o.default,O.default,r.hash,z.default,P.default,T.default,k.default,S.default,C.default,E.default],isStrictMode:!0}),Z),N=se((A=Z).prototype,"appEvents",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=se(A.prototype,"capabilities",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=se(A.prototype,"chat",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=se(A.prototype,"chatApi",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=se(A.prototype,"chatComposerPresenceManager",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=se(A.prototype,"chatHistory",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=se(A.prototype,"chatDraftsManager",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=se(A.prototype,"chatThreadComposer",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=se(A.prototype,"chatThreadPane",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=se(A.prototype,"currentUser",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=se(A.prototype,"router",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=se(A.prototype,"siteSettings",[c.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=se(A.prototype,"isAtBottom",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),K=se(A.prototype,"isScrolling",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),J=se(A.prototype,"needsArrow",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y=se(A.prototype,"uploadDropZone",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se(A.prototype,"resetIdle",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"resetIdle"),A.prototype),se(A.prototype,"messagesLoader",[i.cached],Object.getOwnPropertyDescriptor(A.prototype,"messagesLoader"),A.prototype),se(A.prototype,"handleKeydown",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"handleKeydown"),A.prototype),se(A.prototype,"setup",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"setup"),A.prototype),se(A.prototype,"teardown",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"teardown"),A.prototype),se(A.prototype,"onScroll",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"onScroll"),A.prototype),se(A.prototype,"onScrollEnd",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"onScrollEnd"),A.prototype),se(A.prototype,"updateLastReadMessage",[b.bind],Object.getOwnPropertyDescriptor(A.prototype,"updateLastReadMessage"),A.prototype),se(A.prototype,"setScrollable",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"setScrollable"),A.prototype),se(A.prototype,"loadMessages",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"loadMessages"),A.prototype),se(A.prototype,"didResizePane",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"didResizePane"),A.prototype),se(A.prototype,"fetchMoreMessages",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"fetchMoreMessages"),A.prototype),se(A.prototype,"scrollToLatestMessage",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"scrollToLatestMessage"),A.prototype),se(A.prototype,"onNewMessage",[b.bind],Object.getOwnPropertyDescriptor(A.prototype,"onNewMessage"),A.prototype),se(A.prototype,"processMessages",[b.bind],Object.getOwnPropertyDescriptor(A.prototype,"processMessages"),A.prototype),se(A.prototype,"onSendMessage",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"onSendMessage"),A.prototype),se(A.prototype,"fetchMessagesByDate",[b.bind],Object.getOwnPropertyDescriptor(A.prototype,"fetchMessagesByDate"),A.prototype),se(A.prototype,"highlightOrFetchMessage",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"highlightOrFetchMessage"),A.prototype),se(A.prototype,"resetComposerMessage",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"resetComposerMessage"),A.prototype),se(A.prototype,"scrollToBottom",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"scrollToBottom"),A.prototype),se(A.prototype,"scrollToTop",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"scrollToTop"),A.prototype),se(A.prototype,"resendStagedMessage",[a.action],Object.getOwnPropertyDescriptor(A.prototype,"resendStagedMessage"),A.prototype),A)
async function oe(e){if(!this.chatThreadPane.sending){this.chatThreadPane.sending=!0,this._ignoreNextScroll=!0,(0,v.stackingContextFix)(this.scrollable,(async()=>{await this.args.thread.stageMessage(e)})),this.resetComposerMessage(),this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{const t=await this.chatApi.sendMessage(this.args.thread.channel.id,{message:e.message,in_reply_to_id:null,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id)),thread_id:e.thread.id})
this.args.thread.currentUserMembership??=M.default.create({notification_level:p.NotificationLevels.TRACKING,last_read_message_id:t.message_id}),this.scrollToLatestMessage()}catch(t){ae(this,ee,ce).call(this,e.id,t)}finally{this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id),this.chatThreadPane.sending=!1}}}async function le(e){this.chatThreadPane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{return await this.chatApi.editMessage(e.channel.id,e.id,t)}catch(i){(0,d.popupAjaxError)(i)}finally{this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id),this.chatThreadPane.sending=!1}}function ce(e,t){const i=this.args.thread.messagesManager.findStagedMessage(e)
i&&(t.jqXHR?.responseJSON?.errors?.length?i.error=t.jqXHR.responseJSON.errors[0]:(this.chat.markNetworkAsUnreliable(),i.error="network_error")),this.resetComposerMessage()}function ue(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}})),define("discourse/plugins/chat/discourse/components/chat-to-topic-selector",["exports","@ember/component","@ember/object/computed","@ember/template","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NEW_TOPIC_SELECTION=e.NEW_MESSAGE_SELECTION=e.EXISTING_TOPIC_SELECTION=void 0
const d=(0,a.createTemplateFactory)({id:"pfhwe5XR",block:'[[[10,0],[14,0,"chat-to-topic-selector"],[12],[1,"\\n  "],[10,0],[14,0,"radios"],[12],[1,"\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-topic","move-to-entity",[30,0,["newTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.split_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-existing-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-existing-topic","move-to-entity",[30,0,["existingTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.merge_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["allowNewMessage"]],[[[1,"      "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-message"],[12],[1,"\\n        "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-message","move-to-entity",[30,0,["newMessageSelection"]],[30,0,["selection"]]]],null],[1,"\\n        "],[10,"b"],[12],[1,[28,[35,1],["topic.move_to_new_message.radio_label"],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n"],[41,[30,0,["newTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["newTopicInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-topic-name"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.split_topic.topic_name"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-topic-name"]],null],[1,"\\n\\n      "],[10,"label"],[12],[1,[28,[35,1],["categories.category"],null]],[13],[1,"\\n\\n      "],[8,[39,4],[[24,0,"small"]],[["@id","@value","@onChange"],["new-topic-category-selector",[30,0,["categoryId"]],[28,[37,5],[[30,0],[28,[37,6],[[30,0,["categoryId"]]],null]],null]]],null],[1,"\\n\\n"],[41,[30,0,["canAddTags"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable","@categoryId"],[[30,0,["tags"]],true,[30,0,["categoryId"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["existingTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["existingTopicInstruction"]]],[13],[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[39,8],null,[["@selectedTopicId"],[[30,0,["selectedTopicId"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[37,9],[[30,0,["allowNewMessage"]],[30,0,["newMessage"]]],null],[[[1,"    "],[10,2],[12],[1,[30,0,["newMessageInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-message-title"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.move_to_new_message.message_title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-message-title"]],null],[1,"\\n\\n"],[41,[30,0,["canTagMessages"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable"],[[30,0,["tags"]],true]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],[],false,["radio-button","i18n","if","text-field","category-chooser","action","mut","tag-chooser","choose-topic","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-to-topic-selector.hbs",isStrictMode:!1}),h=e.NEW_TOPIC_SELECTION="new_topic",p=e.EXISTING_TOPIC_SELECTION="existing_topic",m=e.NEW_MESSAGE_SELECTION="new_message"
e.default=(0,t.setComponentTemplate)(d,t.default.extend((s=(0,r.default)(),o=(0,r.default)(),l=(0,r.default)(),u(c={newTopicSelection:h,existingTopicSelection:p,newMessageSelection:m,selection:null,newTopic:(0,i.equal)("selection",h),existingTopic:(0,i.equal)("selection",p),newMessage:(0,i.equal)("selection",m),canAddTags:(0,i.alias)("site.can_create_tag"),canTagMessages:(0,i.alias)("site.can_tag_pms"),topicTitle:null,categoryId:null,tags:null,selectedTopicId:null,chatMessageIds:null,chatChannelId:null,newTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[h])},existingTopicInstruction(){return(0,n.htmlSafe)(this.instructionLabels[p])},newMessageInstruction(){return(0,n.htmlSafe)(this.instructionLabels[m])}},"newTopicInstruction",[s],Object.getOwnPropertyDescriptor(c,"newTopicInstruction"),c),u(c,"existingTopicInstruction",[o],Object.getOwnPropertyDescriptor(c,"existingTopicInstruction"),c),u(c,"newMessageInstruction",[l],Object.getOwnPropertyDescriptor(c,"newMessageInstruction"),c),c)))})),define("discourse/plugins/chat/discourse/components/chat-upload-drop-zone",["exports","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/models/chat-thread","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s
function o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var l=new WeakSet
class c extends t.default{constructor(){super(...arguments),o(this,l)}get title(){return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,l,u).call(this)?i.default.t("chat.upload_to_thread"):i.default.t("chat.upload_to_channel",{title:this.args.model.title})}}function u(){return this.args.model instanceof n.default}e.default=c,s=c,(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"9AdGyOVy",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone"],[12],[1,"\\n      "],[10,0],[14,0,"chat-upload-drop-zone__content"],[12],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__background"],[12],[1,"\\n          "],[10,"svg"],[14,"width","94"],[14,"height","90"],[14,"viewBox","0 0 94 90"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n            "],[10,"path"],[14,"d","M94 40.5591C94 69.8685 64.0686 90 40.9592 90C17.8499 90 0 83.9085 0 60.6907C0 37.4729 28.458 0 51.5674 0C74.6768 0 94 17.3413 94 40.5591Z"],[14,"fill","#D1F0FF"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__illustration"],[12],[1,"\\n          "],[10,"svg"],[14,"width","106"],[14,"height","84"],[14,"viewBox","0 0 106 84"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n            "],[10,"rect"],[14,"x","55.832"],[14,"y","6.82959"],[14,"width","45.7854"],[14,"height","33.8408"],[14,"transform","rotate(13.4039 55.832 6.82959)"],[14,"fill","#D9D9D9"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M100.66 13.7645L61.1414 4.34705C58.6715 3.75846 56.1786 5.37298 55.59 7.84288L47.6214 41.2815C47.0102 43.8464 48.5297 46.3167 50.9996 46.9053L90.518 56.3227C92.9879 56.9113 95.5532 55.4145 96.1644 52.8496L104.133 19.4109C104.722 16.941 103.225 14.3757 100.66 13.7645ZM58.7093 41.5144C58.5961 41.9894 58.1482 42.1838 57.7682 42.0933L53.2084 41.0067C52.7334 40.8935 52.5163 40.5406 52.6295 40.0656L53.7161 35.5058C53.8067 35.1258 54.1822 34.8137 54.6572 34.9269L59.122 35.9909C59.502 36.0815 59.7915 36.552 59.7009 36.932L58.7093 41.5144ZM61.6069 29.3549C61.4938 29.8299 61.0459 30.0243 60.6659 29.9338L56.1061 28.8472C55.6311 28.734 55.414 28.3811 55.5272 27.9061L56.6138 23.3463C56.7044 22.9663 57.0799 22.6542 57.5549 22.7674L62.0197 23.8314C62.3997 23.922 62.6891 24.3925 62.5986 24.7725L61.5119 29.3323L61.6069 29.3549ZM64.5046 17.1954C64.3914 17.6704 63.9435 17.8648 63.5635 17.7743L59.0037 16.6877C58.5287 16.5745 58.3117 16.2216 58.4249 15.7466L59.5115 11.1868C59.602 10.8068 59.9776 10.4947 60.4526 10.6079L64.9174 11.6719C65.2974 11.7625 65.5868 12.233 65.4962 12.613L64.5046 17.1954ZM81.6894 46.1876C81.4857 47.0426 80.5673 47.5264 79.8073 47.3453L64.6079 43.7232C63.753 43.5195 63.2464 42.6961 63.4502 41.8411L65.6234 32.7215C65.8045 31.9615 66.6506 31.36 67.5056 31.5637L82.705 35.1858C83.4649 35.3669 84.0438 36.308 83.8627 37.068L81.6894 46.1876ZM86.036 27.9483C85.8322 28.8033 84.9138 29.2872 84.1538 29.1061L68.9544 25.484C68.0995 25.2802 67.593 24.4568 67.7967 23.6018L69.97 14.4822C70.1511 13.7222 70.9971 13.1207 71.8521 13.3245L87.0515 16.9466C87.8114 17.1277 88.3903 18.0687 88.2092 18.8287L86.036 27.9483ZM92.1479 49.483C92.0347 49.958 91.5868 50.1524 91.2068 50.0619L86.742 48.9979C86.267 48.8847 86.05 48.5318 86.1631 48.0568L87.2498 43.497C87.3403 43.117 87.8109 42.8276 88.1908 42.9181L92.7507 44.0048C93.1306 44.0953 93.4201 44.5659 93.3295 44.9458L92.2429 49.5057L92.1479 49.483ZM95.0456 37.3235C94.9324 37.7985 94.4845 37.9929 94.1045 37.9024L89.6397 36.8384C89.1647 36.7252 88.9476 36.3723 89.0608 35.8973L90.1474 31.3375C90.238 30.9575 90.6135 30.6455 91.0885 30.7586L95.5533 31.8226C95.9333 31.9132 96.2228 32.3837 96.1322 32.7637L95.0456 37.3235ZM97.9432 25.164C97.8301 25.639 97.3822 25.8334 97.0022 25.7429L92.5374 24.6789C92.0624 24.5657 91.8453 24.2128 91.9585 23.7378L93.0451 19.178C93.1357 18.798 93.5112 18.486 93.8912 18.5765L98.356 19.6405C98.736 19.731 99.0254 20.2016 98.9349 20.5816L97.8483 25.1414L97.9432 25.164Z"],[14,"fill","#AFAFAF"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M30.7898 24.814L27.2823 9.2672L4.41944 14.4252C2.81904 14.7863 1.95958 16.3017 2.29486 17.7878L14.2615 70.8296C14.6226 72.43 16.0236 73.3153 17.624 72.9542L56.0337 64.2887C57.5198 63.9534 58.5193 62.5266 58.1582 60.9262L49.699 23.4311L34.1523 26.9385C32.5519 27.2996 31.1508 26.4144 30.7898 24.814ZM48.719 19.0871C48.5643 18.4012 48.0666 17.7927 47.4804 17.3243L33.7501 8.64894C33.0754 8.32063 32.3121 8.13243 31.6263 8.28717L30.9404 8.44191L34.2415 23.0742L48.8738 19.773L48.719 19.0871Z"],[14,"fill","#0AADFF"],[12],[13],[1,"\\n            "],[10,"rect"],[14,"x","41.7334"],[14,"y","40.3967"],[14,"width","37.6309"],[14,"height","28.6511"],[14,"transform","rotate(6.29289 41.7334 40.3967)"],[14,"fill","#66CCFF"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M76.768 40.4721L44.4638 36.9097C42.3671 36.6785 40.548 38.2071 40.3254 40.2261L37.8591 62.5905C37.6279 64.6872 39.0788 66.4977 41.1755 66.729L73.4796 70.2913C75.4987 70.514 77.3869 69.0716 77.6181 66.9749L80.0843 44.6105C80.307 42.5915 78.787 40.6947 76.768 40.4721ZM73.4248 66.5125L42.0524 63.0529C41.7418 63.0187 41.6036 62.8462 41.6379 62.5356L44.0014 41.103C44.0271 40.8701 44.2081 40.6542 44.5187 40.6885L75.891 44.1481C76.124 44.1738 76.3312 44.4324 76.3056 44.6654L73.9421 66.098C73.9078 66.4086 73.6577 66.5382 73.4248 66.5125ZM49.9226 44.4284C48.1365 44.2314 46.6623 45.4836 46.4739 47.192C46.2769 48.978 47.4514 50.4437 49.2375 50.6407C50.9459 50.8291 52.4892 49.6631 52.6862 47.8771C52.8746 46.1687 51.631 44.6168 49.9226 44.4284ZM45.725 59.6852L70.5743 62.4255L71.2594 56.2131L65.1708 48.7036C64.8254 48.2725 64.2818 48.2126 63.8507 48.558L53.5908 56.7799L50.8186 53.4088C50.4732 52.9777 49.9296 52.9178 49.4985 53.2632L46.136 55.9578L45.725 59.6852Z"],[14,"fill","white"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M37.8174 63.0181L77.5892 66.862L77.012 72.8342C76.9057 73.9336 75.9283 74.7388 74.8288 74.6325L39.0385 71.1734C37.939 71.0671 37.1339 70.0897 37.2402 68.9902L37.8174 63.0181Z"],[14,"fill","white"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__text"],[12],[1,"\\n          "],[10,1],[14,0,"chat-upload-drop-zone__text__title"],[12],[1,"\\n            "],[1,[30,0,["title"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-upload-drop-zone.js",isStrictMode:!0}),s)})),define("discourse/plugins/chat/discourse/components/chat-upload",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","@ember/template","discourse/lib/uploads","truth-helpers/helpers/eq","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"siteSettings",h,this),b(this,"loaded",p,this),g(this,"IMAGE_TYPE","image"),g(this,"VIDEO_TYPE","video"),g(this,"AUDIO_TYPE","audio"),g(this,"ATTACHMENT_TYPE","attachment")}get type(){return(0,o.isImage)(this.args.upload.original_filename)?this.IMAGE_TYPE:(0,o.isVideo)(this.args.upload.original_filename)?this.VIDEO_TYPE:(0,o.isAudio)(this.args.upload.original_filename)?this.AUDIO_TYPE:this.ATTACHMENT_TYPE}get size(){const e=this.args.upload.width,t=this.args.upload.height,i=Math.min(this.siteSettings.max_image_width/e,this.siteSettings.max_image_height/t)
return{width:e*i,height:t*i}}get imageUrl(){return this.args.upload.thumbnail?.url??this.args.upload.url}get imageStyle(){if(this.args.upload.dominant_color&&!this.loaded)return(0,s.htmlSafe)(`background-color: #${this.args.upload.dominant_color};`)}imageLoaded(){this.loaded=!0}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"eGuoRuIs",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["type"]],[30,0,["IMAGE_TYPE"]]],null],[[[1,"      "],[11,"img"],[24,0,"chat-img-upload"],[16,"data-orig-src",[30,1,["short_url"]]],[16,"data-large-src",[30,1,["url"]]],[16,"height",[30,0,["size","height"]]],[16,"width",[30,0,["size","width"]]],[16,"src",[30,0,["imageUrl"]]],[16,5,[30,0,["imageStyle"]]],[24,"loading","lazy"],[24,"tabindex","0"],[16,"data-dominant-color",[30,1,["dominant_color"]]],[4,[32,1],["load",[30,0,["imageLoaded"]]],null],[12],[13],[1,"\\n"]],[]],[[[41,[28,[32,0],[[30,0,["type"]],[30,0,["VIDEO_TYPE"]]],null],[[[1,"      "],[10,"video"],[14,0,"chat-video-upload"],[14,"preload","metadata"],[14,"height","150"],[14,"controls",""],[12],[1,"\\n        "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[28,[32,0],[[30,0,["type"]],[30,0,["AUDIO_TYPE"]]],null],[[[1,"      "],[10,"audio"],[14,0,"chat-audio-upload"],[14,"preload","metadata"],[14,"controls",""],[12],[1,"\\n        "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,3],[14,0,"chat-other-upload"],[15,"data-orig-href",[30,1,["short_url"]]],[15,6,[30,1,["url"]]],[12],[1,"\\n        "],[1,[30,1,["original_filename"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]],[]]]],[]]],[1,"  "]],["@upload"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-upload.js",scope:()=>[l.default,n.on],isStrictMode:!0}),m),h=f((d=m).prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(d.prototype,"loaded",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f(d.prototype,"imageLoaded",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"imageLoaded"),d.prototype),d)})),define("discourse/plugins/chat/discourse/components/chat-user-avatar",["exports","@glimmer/component","@ember/service","@ember/template","discourse/helpers/concat-class","discourse/helpers/user-avatar","discourse/lib/url","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get avatar(){return(0,n.htmlSafe)((0,a.renderAvatar)(this.args.user,{imageSize:this.avatarSize}))}get interactive(){return this.args.interactive??!0}get avatarSize(){return this.args.avatarSize||"tiny"}get showPresence(){return this.args.showPresence??!0}get isOnline(){const e=(this.args.chat||this.chat).presenceChannel?.users
return this.showPresence&&!!e?.find((e=>{let{id:t,username:i}=e
return this.args.user?.id===t||this.args.user?.username===i}))}get userPath(){return(0,s.userPath)(this.args.user.username)}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"hv+lI3fX",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-user-avatar",[52,[30,0,["isOnline"]],"is-online"]],null]],[15,"data-username",[30,1,["username"]]],[12],[1,"\\n"],[41,[30,0,["interactive"]],[[[1,"        "],[10,3],[14,0,"chat-user-avatar__container"],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[1,[30,0,["avatar"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,1],[14,0,"chat-user-avatar__container"],[12],[1,"\\n          "],[1,[30,0,["avatar"]]],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-avatar.js",scope:()=>[r.default],isStrictMode:!0}),d),h=(c=d).prototype,p="chat",m=[i.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),u=f,c)
var h,p,m,b,g,f})),define("discourse/plugins/chat/discourse/components/chat-user-display-name",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse/lib/utilities","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="siteSettings",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get shouldPrioritizeNameInUx(){return!this.siteSettings.prioritize_username_in_ux}get hasValidName(){return this.args.user?.name&&this.args.user.name.trim().length>0}get formattedUsername(){return(0,r.formatUsername)(this.args.user?.username)}get shouldShowNameFirst(){return this.shouldPrioritizeNameInUx&&this.hasValidName}get shouldShowNameLast(){return!this.shouldPrioritizeNameInUx&&this.hasValidName}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"/SPi06pN",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-user-display-name"],[12],[1,"\\n"],[41,[30,0,["shouldShowNameFirst"]],[[[1,"        "],[10,1],[14,0,"chat-user-display-name__name -first"],[12],[1,[30,1,["name"]]],[13],[1,"\\n        "],[10,1],[14,0,"separator"],[12],[1,"—"],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,1],[15,0,[28,[32,0],["chat-user-display-name__username",[52,[51,[30,0,["shouldShowNameFirst"]]],"-first"]],null]],[12],[1,"\\n        "],[1,[30,0,["formattedUsername"]]],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,0,["shouldShowNameLast"]],[[[1,"        "],[10,1],[14,0,"separator"],[12],[1,"—"],[13],[1,"\\n        "],[10,1],[14,0,"chat-user-display-name__name"],[12],[1,[30,1,["name"]]],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@user"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-display-name.js",scope:()=>[n.default],isStrictMode:!0}),c),u=(o=c).prototype,d="siteSettings",h=[i.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),l=b,o)
var u,d,h,p,m,b}))
define("discourse/plugins/chat/discourse/components/chat-user-info",["exports","@glimmer/component","discourse/lib/url","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/components/chat-user-display-name","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get avatarSize(){return this.args.avatarSize??"medium"}get userPath(){return(0,i.userPath)(this.args.user.username)}get interactive(){return this.args.interactive??!1}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"RL4I1D2x",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[32,0],null,[["@user","@avatarSize","@interactive"],[[30,1],[30,0,["avatarSize"]],[30,0,["interactive"]]]],null],[1,"\\n\\n"],[41,[30,0,["interactive"]],[[[1,"        "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[8,[32,1],null,[["@user"],[[30,1]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[8,[32,1],null,[["@user"],[[30,1]]],null],[1,"\\n"]],[]]]],[]],null],[1,"  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-info.js",scope:()=>[n.default,r.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat-vh",["exports","@ember/component","@ember/service","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/zoom-check"],(function(e,t,i,n,r){"use strict"
var a,s,o
function l(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function c(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d
e.default=(o=new WeakSet,a=class extends t.default{constructor(){var e,t,i,n
super(...arguments),l(this,o),e=this,t="capabilities",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),c(this,"tagName","")}didInsertElement(){super.didInsertElement(...arguments),"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",this.setVH)),this.activeWindow=window.visualViewport||window,this.activeWindow.addEventListener("resize",this.setVH),this.setVH()}willDestroyElement(){super.willDestroyElement(...arguments),this.activeWindow?.removeEventListener("resize",this.setVH),d=null,"virtualKeyboard"in navigator&&navigator.virtualKeyboard.removeEventListener("geometrychange",this.setVH)}setVH(){if((0,r.default)())return
let e
e="virtualKeyboard"in navigator?window.visualViewport.height-navigator.virtualKeyboard.boundingRect.height:this.activeWindow?.height||window.innerHeight
const t=.01*e
d!==t&&(d=t,document.documentElement.style.setProperty("--chat-vh",`${t}px`))}},s=u(a.prototype,"capabilities",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(a.prototype,"setVH",[n.bind],Object.getOwnPropertyDescriptor(a.prototype,"setVH"),a.prototype),a)})),define("discourse/plugins/chat/discourse/components/chat/admin/export-messages",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"chatAdminApi",d,this),m(this,"dialog",h,this)}async exportMessages(){try{await this.chatAdminApi.exportMessages(),this.dialog.alert(o.default.t("chat.admin.export_messages.export_has_started"))}catch(e){(0,a.popupAjaxError)(e)}}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"wNhgVu+r",block:'[[[1,"\\n    "],[10,"section"],[14,0,"admin-section"],[12],[1,"\\n      "],[10,"h3"],[12],[1,[28,[32,0],["chat.admin.export_messages.title"],null]],[13],[1,"\\n      "],[10,2],[12],[1,[28,[32,0],["chat.admin.export_messages.description"],null]],[13],[1,"\\n      "],[8,[32,1],[[24,0,"btn-primary"]],[["@label","@title","@action"],["chat.admin.export_messages.create_export","chat.admin.export_messages.create_export",[30,0,["exportMessages"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/admin/export-messages.js",scope:()=>[s.default,r.default],isStrictMode:!0}),p),d=b((u=p).prototype,"chatAdminApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=b(u.prototype,"dialog",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(u.prototype,"exportMessages",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"exportMessages"),u.prototype),u)})),define("discourse/plugins/chat/discourse/components/chat/composer/button",["exports","discourse-common/helpers/d-icon","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"FFGdtaBb",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-button__wrapper"],[12],[1,"\\n    "],[11,"button"],[24,4,"button"],[24,0,"chat-composer-button"],[17,1],[12],[1,"\\n      "],[1,[28,[32,0],[[30,2]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","@icon"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/composer/button.js",scope:()=>[t.default],isStrictMode:!0}),(0,r.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/composer/channel",["exports","@ember/object","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function f(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=(0,i.inject)("chat-channel-composer"),o=(0,i.inject)("chat-channel-pane"),l=(0,n.debounce)(2e3),m=new WeakSet,c=class extends a.default{constructor(){super(...arguments),g(this,m),b(this,"composer",u,this),b(this,"pane",d,this),b(this,"currentUser",h,this),b(this,"chatDraftsManager",p,this),f(this,"context","channel"),f(this,"composerId","channel-composer")}persistDraft(){this.chatDraftsManager.add(this.draft,this.args.channel.id)}destroyDraft(){this.chatDraftsManager.remove(this.args.channel.id)}resetDraft(){this.args.channel.resetDraft(this.currentUser)}get draft(){return this.args.channel.draft}get presenceChannelName(){return`/chat-reply/${this.args.channel.id}`}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.channel.canModifyMessages(this.currentUser)}get lastMessage(){return this.args.channel.lastMessage}lastUserMessage(e){return this.args.channel.messagesManager.findLastUserMessage(e)}get placeholder(){return this.args.channel.canModifyMessages(this.currentUser)?this.chat.userCanInteractWithChat?function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,m,y).call(this,this.args.channel):r.default.t("chat.placeholder_silenced"):r.default.t(`chat.placeholder_new_message_disallowed.${this.args.channel.status}`)}handleEscape(e){e.stopPropagation(),this.draft?.inReplyTo?this.draft.inReplyTo=null:this.draft?.editing?this.args.channel.resetDraft(this.currentUser):e.target.blur()}},u=v(c.prototype,"composer",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=v(c.prototype,"pane",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=v(c.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=v(c.prototype,"chatDraftsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(c.prototype,"persistDraft",[l],Object.getOwnPropertyDescriptor(c.prototype,"persistDraft"),c.prototype),v(c.prototype,"destroyDraft",[t.action],Object.getOwnPropertyDescriptor(c.prototype,"destroyDraft"),c.prototype),v(c.prototype,"resetDraft",[t.action],Object.getOwnPropertyDescriptor(c.prototype,"resetDraft"),c.prototype),c)
function y(e){if(e.isDirectMessageChannel){if(e.chatable.group&&e.title)return r.default.t("chat.placeholder_channel",{channelName:`#${e.title}`})
{const t=e.chatable.users
return 1===t.length&&t[0].id===this.currentUser.id?r.default.t("chat.placeholder_self"):r.default.t("chat.placeholder_users",{commaSeparatedNames:t.map((e=>e.name||`@${e.username}`)).join(r.default.t("word_connector.comma"))})}}return r.default.t("chat.placeholder_channel",{channelName:`#${e.title}`})}})),define("discourse/plugins/chat/discourse/components/chat/composer/separator",["exports","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,t.createTemplateFactory)({id:"DwI6b+Xh",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-separator"],[12],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/composer/separator.js",isStrictMode:!0}),(0,n.default)())
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/composer/thread",["exports","@ember/object","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=(0,i.inject)("chat-channel-composer"),l=(0,i.inject)("chat-thread-composer"),c=(0,i.inject)("chat-thread-pane"),u=(0,n.debounce)(2e3),d=class extends s.default{constructor(){super(...arguments),f(this,"channelComposer",h,this),f(this,"composer",p,this),f(this,"pane",m,this),f(this,"currentUser",b,this),f(this,"chatDraftsManager",g,this),v(this,"context","thread"),v(this,"composerId","thread-composer")}persistDraft(){this.chatDraftsManager.add(this.draft,this.args.thread.channel.id,this.args.thread.id)}destroyDraft(){this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id)}resetDraft(){this.args.thread.resetDraft(this.currentUser)}get draft(){return this.args.thread.draft}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.thread.channel.canModifyMessages(this.currentUser)}get presenceChannelName(){const e=this.args.thread
return`/chat-reply/${e.channel.id}/thread/${e.id}`}get placeholder(){return r.default.t("chat.placeholder_thread")}lastUserMessage(e){return this.args.thread.messagesManager.findLastUserMessage(e)}handleEscape(e){if(this.draft.editing)return e.stopPropagation(),void(this.args.thread.draft=a.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread}))
this.isFocused?(e.stopPropagation(),this.composer.blur()):this.pane.close().then((()=>{this.channelComposer.focus()}))}},h=y(d.prototype,"channelComposer",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=y(d.prototype,"composer",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=y(d.prototype,"pane",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=y(d.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=y(d.prototype,"chatDraftsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(d.prototype,"persistDraft",[u],Object.getOwnPropertyDescriptor(d.prototype,"persistDraft"),d.prototype),y(d.prototype,"destroyDraft",[t.action],Object.getOwnPropertyDescriptor(d.prototype,"destroyDraft"),d.prototype),y(d.prototype,"resetDraft",[t.action],Object.getOwnPropertyDescriptor(d.prototype,"resetDraft"),d.prototype),d)})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/service","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-thread","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w
function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(w=class extends t.default{constructor(){super(...arguments),_(this,"chat",b,this),_(this,"chatStateManager",g,this),_(this,"chatChannelsManager",f,this),_(this,"chatHistory",v,this),_(this,"showThreadFullTitle",y,this)}get showfullTitle(){return this.chatStateManager.isDrawerExpanded&&this.showThreadFullTitle}get backButton(){const e={models:this.chat.activeChannel?.routeModels}
return"chat.channel.threads"===this.chatHistory.previousRoute?.name?(e.title=c.default.t("chat.return_to_threads_list"),e.route="chat.channel.threads"):"chat.threads"===this.chatHistory.previousRoute?.name?(e.title=c.default.t("chat.my_threads.title"),e.route="chat.threads",e.models=[]):(e.title=c.default.t("chat.return_to_channel"),e.route="chat.channel"),e}get threadTitle(){return this.chat.activeChannel?.activeThread?.title??c.default.t("chat.thread.label")}async fetchChannelAndThread(){if(this.args.params?.channelId&&this.args.params?.threadId)try{const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e,e.threadsManager.find(e.id,this.args.params.threadId).then((e=>{this.chat.activeChannel.activeThread=e}))}catch(e){(0,l.popupAjaxError)(e)}}setFullTitle(e){this.showThreadFullTitle=e}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"23Z/sxxL",block:'[[[1,"\\n    "],[8,[32,0],null,[["@onClick","@showFullTitle"],[[30,0,["chat","toggleDrawer"]],[30,0,["showfullTitle"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backButton","title"]],[30,0,["backButton","route"]],[30,0,["backButton","models"]]]],null],[1,"\\n      "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[30,0,["threadTitle"]],"discourse-threads"]],null],[1,"\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n      "]],[2]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[11,0],[24,0,"chat-drawer-content"],[4,[32,1],[[30,0,["fetchChannelAndThread"]]],null],[4,[32,2],[[30,0,["fetchChannelAndThread"]],[30,3,["channelId"]]],null],[4,[32,2],[[30,0,["fetchChannelAndThread"]],[30,3,["threadId"]]],null],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[28,[32,3],[[30,0,["chat","activeChannel","activeThread"]]],null]],null]],null],null,[[[41,[30,4],[[[1,"            "],[8,[32,4],null,[["@thread","@targetMessageId","@setFullTitle"],[[30,4],[30,3,["messageId"]],[30,0,["setFullTitle"]]]],null],[1,"\\n"]],[]],null]],[4]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["navbar","a","@params","thread"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread.js",scope:()=>[u.default,a.default,s.default,n.array,d.default],isStrictMode:!0}),w),b=j((m=w).prototype,"chat",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(m.prototype,"chatStateManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=j(m.prototype,"chatChannelsManager",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=j(m.prototype,"chatHistory",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=j(m.prototype,"showThreadFullTitle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j(m.prototype,"fetchChannelAndThread",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"fetchChannelAndThread"),m.prototype),j(m.prototype,"setFullTitle",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"setFullTitle"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-common/helpers/html-safe","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-thread-list","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"chat",m,this),f(this,"chatChannelsManager",b,this),v(this,"backLinkTitle",l.default.t("chat.return_to_list"))}get title(){return(0,o.default)(l.default.t("chat.threads.list")+" - "+(0,a.default)(this.chat.activeChannel.title))}async fetchChannel(){if(this.args.params?.channelId)try{const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e}catch(e){(0,s.popupAjaxError)(e)}}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"ta3NyhGz",block:'[[[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"      "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backLinkTitle"]],"chat.channel",[30,0,["chat","activeChannel","routeModels"]]]],null],[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[30,0,["title"]],"discourse-threads"]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n"]],[]],null],[1,"\\n    "],[11,0],[24,0,"chat-drawer-content"],[4,[32,1],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"        "],[8,[32,2],null,[["@channel","@includeHeader"],[[30,0,["chat","activeChannel"]],false]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads.js",scope:()=>[c.default,n.default,u.default],isStrictMode:!0}),g),m=y((p=g).prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=y(p.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(p.prototype,"fetchChannel",[i.action],Object.getOwnPropertyDescriptor(p.prototype,"fetchChannel"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/service","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=class extends t.default{constructor(){super(...arguments),g(this,"chat",h,this),g(this,"chatStateManager",p,this),g(this,"chatChannelsManager",m,this)}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"UIpYDQ/F",block:'[[[1,"\\n    "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["BackButton"]],null,null,null],[1,"\\n      "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,2,["ThreadsListButton"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n        "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n      "]],[2]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[11,0],[24,0,"chat-drawer-content"],[4,[32,1],[[30,0,["fetchChannel"]]],null],[4,[32,2],[[30,0,["fetchChannel"]],[30,3,["channelId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[42,[28,[31,2],[[28,[31,2],[[28,[32,3],[[30,0,["chat","activeChannel"]]],null]],null]],null],null,[[[41,[30,4],[[[1,"              "],[8,[32,4],null,[["@targetMessageId","@channel"],[[28,[31,3],[[30,3,["messageId"]]],null],[30,4]]],null],[1,"\\n"]],[]],null]],[4]],null]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["navbar","a","@params","channel"],false,["if","each","-track-array","readonly"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel.js",scope:()=>[o.default,r.default,a.default,i.array,l.default],isStrictMode:!0}),b),h=f((d=b).prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(d.prototype,"chatStateManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(d.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(d.prototype,"fetchChannel",[n.action],Object.getOwnPropertyDescriptor(d.prototype,"fetchChannel"),d.prototype),d)})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channels",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list","discourse/plugins/chat/discourse/components/chat/navbar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){super(...arguments),h(this,"chat",c,this),h(this,"chatStateManager",u,this)}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"Rdwib/Su",block:'[[[1,"\\n    "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.heading"],null]]],null],[1,"\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n      "]],[2]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n        "],[8,[32,2],null,null,null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["navbar","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channels.js",scope:()=>[a.default,n.default,r.default],isStrictMode:!0}),d),c=p((l=d).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l)})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/threads",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/user-threads","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){super(...arguments),p(this,"chat",u,this),p(this,"chatStateManager",d,this),m(this,"backButtonTitle",r.default.t("chat.return_to_list"))}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"wcpGfmq1",block:'[[[1,"\\n    "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["BackButton"]],null,[["@title"],[[30,0,["backButtonTitle"]]]],null],[1,"\\n      "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[28,[32,1],["chat.my_threads.title"],null],"discourse-threads"]],null],[1,"\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,2,["ThreadsListButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n        "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n      "]],[2]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n        "],[8,[32,2],null,null,null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["navbar","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/threads.js",scope:()=>[a.default,n.default,s.default],isStrictMode:!0}),h),u=b((c=h).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(c.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c)})),define("discourse/plugins/chat/discourse/components/chat/footer/unread-indicator",["exports","@glimmer/component","@ember/service","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.UnreadThreadsIndicator=e.UnreadDirectMessagesIndicator=e.UnreadChannelsIndicator=void 0
const u="channels",d="threads"
e.UnreadChannelsIndicator=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[h,u],isStrictMode:!0}),(0,a.default)()),e.UnreadDirectMessagesIndicator=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[h,"dms"],isStrictMode:!0}),(0,a.default)()),e.UnreadThreadsIndicator=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[h,d],isStrictMode:!0}),(0,a.default)())
let h=e.default=(l=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatTrackingStateManager",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),c(this,"badgeType",this.args.badgeType)}get urgentCount(){return this.badgeType===u?this.chatTrackingStateManager.publicChannelMentionCount:"dms"===this.badgeType?this.chatTrackingStateManager.directMessageUnreadCount:0}get unreadCount(){return this.badgeType===u?this.chatTrackingStateManager.publicChannelUnreadCount:this.badgeType===d&&this.chatTrackingStateManager.hasUnreadThreads?1:0}get showUrgent(){return this.urgentCount>0}get showUnread(){return this.unreadCount>0}get urgentBadgeCount(){let e=this.urgentCount
return e>99?"99+":e}},(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"nfrZ+lqq",block:'[[[1,"\\n"],[41,[30,0,["showUrgent"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator -urgent"],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["urgentBadgeCount"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnread"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator"],[12],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",isStrictMode:!0}),l),p=(s=l).prototype,m="chatTrackingStateManager",b=[i.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),o=v,s)
var p,m,b,g,f,v})),define("discourse/plugins/chat/discourse/components/chat/form",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/section","@ember/template-factory","@ember/component"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get yieldableArgs(){return{section:i.default}}}e.default=s,a=s,(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"Q+UnUyWk",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-form"],[12],[1,"\\n      "],[18,1,[[30,0,["yieldableArgs"]]]],[1,"\\n    "],[13],[1,"\\n  "]],["&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form.js",isStrictMode:!0}),a)})),define("discourse/plugins/chat/discourse/components/chat/form/row",["exports","@ember/routing","discourse/helpers/concat-class","discourse-common/helpers/d-icon","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"OiuLfajB",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[8,[32,0],[[16,0,[28,[32,1],["chat-form__row -link",[52,[30,2],"-separator"]],null]]],[["@route","@models"],[[30,1],[30,3]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n        "],[1,[30,4]],[1,"\\n        "],[1,[28,[32,2],["chevron-right"],[["class"],["chat-form__row-icon"]]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[10,0],[15,0,[28,[32,1],["chat-form__row",[52,[30,2],"-separator"]],null]],[12],[1,"\\n      "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n"],[41,[30,4],[[[1,"          "],[10,1],[14,0,"chat-form__row-label"],[12],[1,[30,4]],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,5]],[[[1,"          "],[10,1],[14,0,"chat-form__row-label"],[12],[1,"\\n            "],[18,5,null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,6]],[[[1,"          "],[10,0],[14,0,"chat-form__row-action"],[12],[18,6,null],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[48,[30,7]],[[[1,"        "],[10,0],[14,0,"chat-form__row-description"],[12],[1,"\\n          "],[18,7,null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]]]],["@route","@separator","@routeModels","@label","&default","&action","&description"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/row.js",scope:()=>[t.LinkTo,i.default,n.default],isStrictMode:!0}),(0,s.default)())
e.default=o})),define("discourse/plugins/chat/discourse/components/chat/form/section",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/row","@ember/template-factory","@ember/component"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get yieldableArgs(){return{row:i.default}}}e.default=s,a=s,(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"/xrcZgND",block:'[[[1,"\\n    "],[11,0],[24,0,"chat-form__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"        "],[10,0],[14,0,"chat-form__section-title"],[12],[1,"\\n          "],[1,[30,2]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"chat-form__section-content"],[12],[1,"\\n        "],[18,3,[[30,0,["yieldableArgs"]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@title","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/section.js",isStrictMode:!0}),a)})),define("discourse/plugins/chat/discourse/components/chat/header/icon",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/lib/get-url","discourse-i18n","discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"currentUser",h,this),f(this,"site",p,this),f(this,"chatStateManager",m,this),f(this,"router",b,this)}get showUnreadIndicator(){return(!this.chatStateManager.isFullPageActive||!this.site.desktopView)&&!this.currentUserInDnD}get currentUserInDnD(){return this.args.currentUserInDnD||this.currentUser.isInDoNotDisturb()}get chatSeparateSidebarMode(){return(0,l.getUserChatSeparateSidebarMode)(this.currentUser)}get isActive(){return this.args.isActive||this.chatStateManager.isFullPageActive||this.chatStateManager.isDrawerActive}get title(){return!this.chatStateManager.isFullPageActive||this.chatSeparateSidebarMode.never||this.site.mobileView?s.default.t("chat.title_capitalized"):s.default.t("sidebar.panels.forum.label")}get icon(){return!this.chatStateManager.isFullPageActive||this.chatSeparateSidebarMode.never||this.site.mobileView?"d-chat":"random"}get href(){return this.site.mobileView&&this.chatStateManager.isFullPageActive?(0,a.default)("/chat"):this.chatStateManager.isFullPageActive&&!this.chatSeparateSidebarMode.never?(0,a.default)(this.chatStateManager.lastKnownAppURL||"/"):this.chatStateManager.isDrawerActive?(0,a.default)("/chat"):(0,a.default)(this.chatStateManager.lastKnownChatURL||"/chat")}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"lQkZgVeM",block:'[[[1,"\\n    "],[10,3],[15,6,[30,0,["href"]]],[14,"tabindex","0"],[15,0,[28,[32,0],["icon","btn-flat",[52,[30,0,["isActive"]],"active"]],null]],[15,"title",[30,0,["title"]]],[12],[1,[28,[32,1],[[30,0,["icon"]]],null]],[41,[30,0,["showUnreadIndicator"]],[[[1,"        "],[8,[32,2],null,[["@urgentCount","@unreadCount","@indicatorPreference"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@urgentCount","@unreadCount","@indicatorPreference"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon.js",scope:()=>[n.default,r.default,o.default],isStrictMode:!0}),g),h=v((d=g).prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=v(d.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=v(d.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(d.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d)})),define("discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=new WeakSet,c=class extends t.default{constructor(){super(...arguments),h(this,u),d(this,"chatTrackingStateManager",o,this),d(this,"currentUser",l,this)}get urgentCount(){return this.args.urgentCount||this.chatTrackingStateManager.allChannelUrgentCount}get mentionCount(){return this.args.mentionCount||this.chatTrackingStateManager.allChannelMentionCount}get unreadCount(){return this.args.unreadCount||this.chatTrackingStateManager.publicChannelUnreadCount}get indicatorPreference(){return this.args.indicatorPreference||this.currentUser.user_option.chat_header_indicator_preference}get showUrgentIndicator(){return this.onlyMentions?this.mentionCount>0:this.urgentCount>0&&p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ALL_NEW,n.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS])}get showUnreadIndicator(){return this.unreadCount>0&&p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ALL_NEW])}get urgentCountLabel(){let e=this.onlyMentions?this.mentionCount:this.urgentCount
return e>99?"99+":e}get onlyMentions(){return p(this,u,b).call(this,[n.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS])}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"ZelwfVyf",block:'[[[1,"\\n"],[41,[30,0,["showUrgentIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator -urgent"],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["urgentCountLabel"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator"],[12],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator.js",isStrictMode:!0}),c),o=m((s=c).prototype,"chatTrackingStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=m(s.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function b(e){return!(!this.currentUser||this.indicatorPreference===n.HEADER_INDICATOR_PREFERENCE_NEVER)&&e.includes(this.indicatorPreference)}})),define("discourse/plugins/chat/discourse/components/chat/list/empty-state",["exports","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,t.createTemplateFactory)({id:"5IieK/P5",block:'[[[1,"\\n  "],[11,0],[24,0,"c-list-empty-state"],[17,1],[12],[1,"\\n    "],[18,2,null],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/empty-state.js",isStrictMode:!0}),(0,n.default)())
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/list/index",["exports","@glimmer/component","@ember/helper","@ember/object","ember-modifier","discourse/components/conditional-loading-spinner","discourse/lib/is-element-in-viewport","discourse-common/config/environment","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/list/empty-state","discourse/plugins/chat/discourse/components/chat/list/item","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m
function b(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"loadMore",(0,r.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.loadCollection),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()})))),b(this,"fill",(0,r.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,s.default)(e)&&this.loadCollection()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()}))))}get itemComponent(){return this.args.itemComponent??u.default}loadCollection(){(0,l.default)(this,this.debouncedLoadCollection,o.INPUT_DELAY)}async debouncedLoadCollection(){await this.args.collection.load({limit:10})}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"Dr5JZae5",block:'[[[1,"\\n    "],[10,0],[14,0,"c-list"],[12],[1,"\\n      "],[11,0],[17,1],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,2,["items"]]],null]],null],null,[[[1,"          "],[18,4,[[28,[32,0],null,[["Item"],[[50,[30,0,["itemComponent"]],0,null,[["item"],[[30,3]]]]]]]]],[1,"\\n"]],[3]],[[[41,[30,2,["fetchedOnce"]],[[[1,"            "],[18,4,[[28,[32,0],null,[["EmptyState"],[[32,1]]]]]],[1,"\\n"]],[]],null]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n        "],[10,"br"],[12],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,2],null,[["@condition"],[[30,2,["loading"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@collection","item","&default"],false,["each","-track-array","yield","component","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/index.js",scope:()=>[i.hash,c.default,a.default],isStrictMode:!0}),m),g=(p=m).prototype,f="loadCollection",v=[n.action],y=Object.getOwnPropertyDescriptor(p.prototype,"loadCollection"),w=p.prototype,_={},Object.keys(y).forEach((function(e){_[e]=y[e]})),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=v.slice().reverse().reduce((function(e,t){return t(g,f,e)||e}),_),w&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(w):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(g,f,_),_=null),p)
var g,f,v,y,w,_})),define("discourse/plugins/chat/discourse/components/chat/list/item",["exports","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,t.createTemplateFactory)({id:"Ox3k3YOe",block:'[[[18,2,[[30,1]]]],["@item","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/item.js",isStrictMode:!0}),(0,n.default)())
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/message-creator/add-members",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse-i18n","truth-helpers/helpers/gte","discourse/plugins/chat/discourse/components/chat/message-creator/members-count","discourse/plugins/chat/discourse/components/chat/message-creator/members-selector","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=class extends t.default{constructor(){super(...arguments),w(this,"chat",p,this),w(this,"chatApi",m,this),w(this,"router",b,this),w(this,"toasts",g,this),w(this,"siteSettings",f,this),w(this,"loadingSlider",v,this)}get membersCount(){const e=this.args.members?.reduce(((e,t)=>"group"===t.type?e+t.model.chat_enabled_user_count:e+1),0)
return e+(this.args.channel?.membershipsCount??0)}async saveGroupMembers(){try{this.loadingSlider.transitionStarted()
const e=this.args.members.filter((e=>"user"===e.type)).mapBy("model.username"),t=this.args.members.filter((e=>"group"===e.type)).mapBy("model.name")
await this.chatApi.addMembersToChannel(this.args.channel.id,{usernames:e,groups:t}),this.toasts.success({data:{message:s.default.t("saved")}}),this.router.transitionTo("chat.channel",...this.args.channel.routeModels)}catch(e){(0,a.popupAjaxError)(e)}finally{this.loadingSlider.transitionEnded()}}},(0,d.setComponentTemplate)((0,u.createTemplateFactory)({id:"tIRZb+jd",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__add-members-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__add-members"],[12],[1,"\\n        "],[8,[32,0],null,[["@count","@max"],[[30,0,["membersCount"]],[30,0,["siteSettings","chat_max_direct_message_users"]]]],null],[1,"\\n\\n        "],[8,[32,1],null,[["@channel","@members","@onChange","@close","@cancel","@membersCount","@maxReached"],[[30,1],[30,2],[30,3],[30,4],[30,5],[30,0,["membersCount"]],[28,[32,2],[[30,0,["membersCount"]],[30,0,["siteSettings","chat_max_direct_message_users"]]],null]]],null],[1,"\\n\\n"],[41,[30,2,["length"]],[[[1,"          "],[10,0],[14,0,"chat-message-creator__add-members-footer-container"],[12],[1,"\\n            "],[10,0],[14,0,"chat-message-creator__add-members-footer"],[12],[1,"\\n              "],[8,[32,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,5]]],null],[1,"\\n\\n              "],[8,[32,3],[[24,0,"btn-primary add-to-channel"]],[["@label","@action"],["chat.direct_message_creator.add_to_channel",[30,0,["saveGroupMembers"]]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@members","@onChangeMembers","@close","@cancel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/add-members.js",scope:()=>[l.default,c.default,o.default,r.default],isStrictMode:!0}),y),p=_((h=y).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_(h.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=_(h.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_(h.prototype,"toasts",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=_(h.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=_(h.prototype,"loadingSlider",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_(h.prototype,"saveGroupMembers",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"saveGroupMembers"),h.prototype),h)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/channel",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","truth-helpers/helpers/gt","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/channel-title","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get isUrgent(){return this.args.item.model.isDirectMessageChannel||this.args.item.model.isCategoryChannel&&this.args.item.model.tracking.mentionCount>0}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"vJyGYp8Y",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -category-channel"],[15,"data-disabled",[28,[32,0],[[30,1,["enabled"]]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[32,2],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"\\n        "],[10,0],[15,0,[28,[32,3],["unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@item"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/channel.js",scope:()=>[a.default,s.default,r.default,n.default],isStrictMode:!0}),d),h=(c=d).prototype,p="currentUser",m=[i.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),u=f,c)
var h,p,m,b,g,f})),define("discourse/plugins/chat/discourse/components/chat/message-creator/constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MODES=void 0
e.MODES={search:"SEARCH",new_group:"NEW_GROUP",add_members:"ADD_MEMBERS"}})),define("discourse/plugins/chat/discourse/components/chat/message-creator/group",["exports","@glimmer/component","@ember/service","discourse-common/helpers/d-icon","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){super(...arguments),d(this,"currentUser",l,this),d(this,"siteSettings",c,this),h(this,"group_with_too_many_members",r.default.t("chat.new_message_modal.group_with_too_many_members",{membersCount:this.args.item.model.chat_enabled_user_count}))}get isDisabled(){return this.args.membersCount?this.args.membersCount+this.args.item.model.chat_enabled_user_count>this.siteSettings.chat_max_direct_message_users:!this.args.item.enabled}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"yxKDOnPR",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -group"],[15,"data-disabled",[30,0,["isDisabled"]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__group-icon"],[12],[1,"\\n        "],[1,[28,[32,0],["user-friends"],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__group-name"],[12],[1,"\\n        "],[1,[30,1,["model","name"]]],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,0,["isDisabled"]],[[[1,"        "],[10,1],[14,0,"chat-message-creator__chatable -disabled-chat"],[12],[1,"\\n          "],[1,[30,0,["group_with_too_many_members"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@item"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/group.js",scope:()=>[n.default],isStrictMode:!0}),u),l=p((o=u).prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(o.prototype,"siteSettings",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/index",["exports","@glimmer/component","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/components/chat/message-creator/add-members","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat/message-creator/new-group","discourse/plugins/chat/discourse/components/chat/message-creator/search","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"mode",d,this),m(this,"members",h,this)}get componentForMode(){switch(this.args.mode??this.mode){case a.MODES.search:return o.default
case a.MODES.new_group:return s.default
case a.MODES.add_members:return r.default}}changeMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]
this.mode=e,this.changeMembers(t)}changeMembers(e){this.members=e}cancelAction(){return this.args.onCancel?.()||this.changeMode(a.MODES.search)}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"KOmH179J",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator"],[12],[1,"\\n        "],[8,[30,0,["componentForMode"]],null,[["@channel","@onChangeMode","@onChangeMembers","@close","@cancel","@members"],[[30,1],[30,0,["changeMode"]],[30,0,["changeMembers"]],[30,2],[30,0,["cancelAction"]],[30,0,["members"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@onClose"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/index.js",isStrictMode:!0}),p),d=b((u=p).prototype,"mode",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return a.MODES.search}}),h=b(u.prototype,"members",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b(u.prototype,"changeMode",[n.action],Object.getOwnPropertyDescriptor(u.prototype,"changeMode"),u.prototype),b(u.prototype,"changeMembers",[n.action],Object.getOwnPropertyDescriptor(u.prototype,"changeMembers"),u.prototype),b(u.prototype,"cancelAction",[n.action],Object.getOwnPropertyDescriptor(u.prototype,"cancelAction"),u.prototype),u)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader",["exports","@ember/application","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-chatable"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=new WeakSet,d=new WeakSet,o=class{constructor(e){p(this,d),p(this,u),h(this,"chatChannelsManager",l,this),h(this,"loadingSlider",c,this),(0,t.setOwner)(this,(0,t.getOwner)(e))}async search(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{includeUsers:!0,includeGroups:!0,includeCategoryChannels:!0,includeDirectMessageChannels:!0,excludedUserIds:null,preloadChannels:!1}
if(this.request?.abort(),!e&&t.preloadChannels)return m(this,u,g).call(this)
if(!e)return[]
try{this.loadingSlider.transitionStarted(),this.request=(0,n.ajax)("/chat/api/chatables",{data:{term:e,include_users:t.includeUsers,include_category_channels:t.includeCategoryChannels,include_direct_message_channels:t.includeDirectMessageChannels,excluded_memberships_channel_id:t.excludedMembershipsChannelId}})
const i=await this.request
return this.loadingSlider.transitionEnded(),[...i.users,...i.groups,...i.direct_message_channels,...i.category_channels].map((e=>{const t=s.default.create(e)
return t.tracking=m(this,d,f).call(this,t),t})).slice(0,10)}catch(i){(0,r.popupAjaxError)(i)}}},l=b(o.prototype,"chatChannelsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=b(o.prototype,"loadingSlider",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(o.prototype,"search",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"search"),o.prototype),o)
function g(){return this.chatChannelsManager.allChannels.map((e=>{let t
return 1===e.chatable?.users?.length?(t=s.default.createUser(e.chatable.users[0]),t.tracking=m(this,d,f).call(this,t)):(t=s.default.createChannel(e),t.tracking=e.tracking),t})).filter(Boolean).slice(0,10)}function f(e){if("channel"!==!e.type)return this.chatChannelsManager.allChannels.find((t=>t.id===e.model.id))?.tracking}})),define("discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getNext=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t?.identifier){const i=e.mapBy("identifier").indexOf(t?.identifier)
return i<e.length-1?e.objectAt(i+1):e[0]}return e[0]},e.getPrevious=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t?.identifier){const i=e.mapBy("identifier").indexOf(t?.identifier)
return i>0?e.objectAt(i-1):e.objectAt(e.length-1)}return e.objectAt(e.length-1)}})),define("discourse/plugins/chat/discourse/components/chat/message-creator/list-action",["exports","discourse/components/d-button","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"FZmzvD8+",block:'[[[1,"\\n  "],[8,[32,0],[[24,0,"btn btn-flat"]],[["@icon","@translatedLabel"],[[30,1,["icon"]],[30,1,["label"]]]],null],[1,"\\n"]],["@item"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list-action.js",scope:()=>[t.default],isStrictMode:!0}),(0,r.default)())
e.default=a})),define("discourse/plugins/chat/discourse/components/chat/message-creator/list-handler",["exports","@glimmer/component","ember-modifier","discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s
function o(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{constructor(){super(...arguments),o(this,"handleKeydown",(0,i.modifier)((e=>{const t=e=>{"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.args.onHighlight((0,n.getNext)(this.args.items,this.args.highlightedItem))):"ArrowUp"===e.key?(e.preventDefault(),e.stopPropagation(),this.args.onHighlight((0,n.getPrevious)(this.args.items,this.args.highlightedItem))):"Enter"===e.key&&this.args.highlightedItem&&(e.preventDefault(),e.stopPropagation(),e.shiftKey&&this.args.onShifSelect?this.args.onShifSelect(this.args.highlightedItem):this.args.onSelect(this.args.highlightedItem))}
return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}})))}}e.default=l,s=l,(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"D4sxaCLN",block:'[[[1,"\\n    "],[11,1],[24,5,"display: contents"],[17,1],[4,[30,0,["handleKeydown"]],null,null],[12],[1,"\\n      "],[18,2,null],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list-handler.js",isStrictMode:!0}),s)}))
define("discourse/plugins/chat/discourse/components/chat/message-creator/list",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","discourse/helpers/concat-class","discourse-i18n","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat/message-creator/channel","discourse/plugins/chat/discourse/components/chat/message-creator/group","discourse/plugins/chat/discourse/components/chat/message-creator/list-action","discourse/plugins/chat/discourse/components/chat/message-creator/user","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b
function g(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=class extends t.default{constructor(){super(...arguments),g(this,"cantAddMoreMembersLabel",s.default.t("chat.new_message_modal.cant_add_more_members"))}componentForItem(e){switch(e){case"list-action":return u.default
case"user":return d.default
case"group":return c.default
case"channel":return l.default}}handleEnter(e,t){"Enter"===t.key&&(t.shiftKey&&this.args.onShiftSelect?this.args.onShiftSelect?.(e):this.args.onSelect?.(e))}handleClick(e,t){t.shiftKey&&this.args.onShiftSelect?this.args.onShiftSelect?.(e):this.args.onSelect?.(e)}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"9RazZaz7",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[14,0,"chat-message-creator__list-container"],[12],[1,"\\n"],[41,[30,2],[[[1,"          "],[10,0],[14,0,"chat-message-creator__warning-max-members"],[12],[1,[30,0,["cantAddMoreMembersLabel"]]],[13],[1,"\\n"]],[]],[[[1,"          "],[10,"ul"],[14,0,"chat-message-creator__list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1]],null]],null],null,[[[1,"              "],[11,"li"],[16,0,[28,[32,0],["chat-message-creator__list-item",[52,[28,[32,1],[[30,3,["identifier"]],[30,4,["identifier"]]],null],"-highlighted"]],null]],[24,"role","button"],[24,"tabindex","0"],[16,"data-identifier",[30,3,["identifier"]]],[16,1,[30,3,["id"]]],[4,[32,2],["click",[28,[32,3],[[30,0,["handleClick"]],[30,3]],null]],null],[4,[32,2],["keypress",[28,[32,3],[[30,0,["handleEnter"]],[30,3]],null]],null],[4,[32,2],["mousemove",[28,[32,3],[[30,5],[30,3]],null]],null],[4,[32,2],["mouseleave",[28,[32,3],[[30,5],null],null]],null],[12],[1,"\\n                "],[46,[28,[30,0,["componentForItem"]],[[30,3,["type"]]],null],null,[["membersCount","item"],[[30,6],[30,3]]],null],[1,"\\n              "],[13],[1,"\\n"]],[3]],null],[1,"          "],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@items","@maxReached","item","@highlightedItem","@onHighlight","@membersCount"],false,["if","each","-track-array","component"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list.js",scope:()=>[a.default,o.default,n.on,i.fn],isStrictMode:!0}),b),f((m=b).prototype,"handleEnter",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"handleEnter"),m.prototype),f(m.prototype,"handleClick",[r.action],Object.getOwnPropertyDescriptor(m.prototype,"handleClick"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/member",["exports","@ember/helper","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"T0PK7gPa",block:'[[[1,"\\n  "],[8,[32,0],[[16,0,[28,[32,1],["chat-message-creator__member btn-default",[52,[30,1],"-highlighted"]],null]]],[["@action"],[[28,[32,2],[[30,2],[30,3]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[32,3],[[30,3,["type"]],"user"],null],[[[1,"      "],[8,[32,4],null,[["@user","@interactive","@showPresence"],[[30,3,["model"]],false,false]],null],[1,"\\n      "],[10,1],[14,0,"chat-message-creator__member-username"],[12],[1,"\\n        "],[1,[30,3,["model","username"]]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[28,[32,3],[[30,3,["type"]],"group"],null],[[[1,"      "],[10,0],[14,0,"chat-message-creator__group-icon"],[12],[1,"\\n        "],[1,[28,[32,5],["user-friends"],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,1],[14,0,"chat-message-creator__member-group"],[12],[1,"\\n        "],[1,[30,3,["model","name"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]],[1,"\\n    "],[1,[28,[32,5],["times"],null]],[1,"\\n  "]],[]]]]],[1,"\\n"]],["@highlighted","@onSelect","@member"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/member.js",scope:()=>[i.default,n.default,t.fn,a.default,s.default,r.default],isStrictMode:!0}),(0,c.default)())
e.default=u})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members-count",["exports","@glimmer/component","discourse/helpers/concat-class","discourse-i18n","truth-helpers/helpers/gte","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get countLabel(){return n.default.t("chat.direct_message_creator.members_counter",{count:this.args.count,max:this.args.max})}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"DAeEDTUT",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-message-creator__members-count",[52,[28,[32,1],[[30,1],[30,2]],null],"-reached-limit"]],null]],[12],[1,"\\n      "],[1,[30,0,["countLabel"]]],[1,"\\n    "],[13],[1,"\\n  "]],["@count","@max"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members-count.js",scope:()=>[i.default,r.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members-selector",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/components/d-button","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader","discourse/plugins/chat/discourse/components/chat/message-creator/list","discourse/plugins/chat/discourse/components/chat/message-creator/list-handler","discourse/plugins/chat/discourse/components/chat/message-creator/members","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(_=class extends t.default{constructor(){super(...arguments),j(this,"siteSettings",g,this),j(this,"chatables",f,this),j(this,"filter",v,this),j(this,"highlightedMember",y,this),j(this,"highlightedChatable",w,this),M(this,"placeholder",l.default.t("chat.direct_message_creator.group_name"))}get items(){return this.chatables.filter((e=>!this.highlightedMemberIds.includes(e.model.id)))}get highlightedMemberIds(){return this.args.members.map((e=>e.model.id))}highlightMember(e){this.highlightedMember=e}highlightChatable(e){this.highlightedChatable=e}selectChatable(e){if(!e.enabled)return
const t="group"===e.type?e.model.chat_enabled_user_count:1
this.args.membersCount+t>this.siteSettings.chat_max_direct_message_users||(this.highlightedMemberIds.includes(e.model.id)?this.unselectMember(e):(this.args.onChange?.([...this.args.members,e]),this.highlightedChatable=this.items[0]),this.filter="",this.focusFilterAction?.(),this.highlightedMember=null)}registerFocusFilterAction(e){this.focusFilterAction=e}onFilter(e){this.searchHandler=(0,o.default)(this,this.fetch,e.target.value,s.INPUT_DELAY)}async fetch(e){this.highlightedMember=null
const t=new c.default(this)
this.chatables=await t.search(e,{includeCategoryChannels:!1,includeDirectMessageChannels:!1,excludedMembershipsChannelId:this.args.channel?.id}),this.highlightedChatable=this.items[0]}unselectMember(e){this.args.onChange?.(this.args.members.filter((t=>t!==e))),this.highlightedMember=null,this.highlightedChatable=this.items[0],this.focusFilterAction?.()}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"uuJp07O5",block:'[[[1,"\\n    "],[8,[32,0],null,[["@items","@highlightedItem","@onHighlight","@onSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["highlightChatable"]],[30,0,["selectChatable"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-message-creator__add-members-header-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__add-members-header"],[12],[1,"\\n          "],[8,[32,1],null,[["@filter","@members","@highlightedMember","@onFilter","@registerFocusFilterAction","@onHighlightMember","@onSelectMember"],[[30,0,["filter"]],[30,1],[30,0,["highlightedMember"]],[30,0,["onFilter"]],[30,0,["registerFocusFilterAction"]],[30,0,["highlightMember"]],[30,0,["unselectMember"]]]],null],[1,"\\n\\n          "],[8,[32,2],[[24,0,"btn-flat chat-message-creator__add-members__close-btn"]],[["@action","@icon"],[[30,2],"times"]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,3],null,[["@items","@highlightedItem","@onSelect","@onHighlight","@maxReached","@membersCount"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["selectChatable"]],[30,0,["highlightChatable"]],[30,3],[30,4]]],null],[1,"\\n\\n    "]],[]]]]],[1,"\\n  "]],["@members","@cancel","@maxReached","@membersCount"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members-selector.js",scope:()=>[d.default,h.default,a.default,u.default],isStrictMode:!0}),_),g=z((b=_).prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=z(b.prototype,"chatables",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=z(b.prototype,"filter",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y=z(b.prototype,"highlightedMember",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=z(b.prototype,"highlightedChatable",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z(b.prototype,"highlightMember",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"highlightMember"),b.prototype),z(b.prototype,"highlightChatable",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"highlightChatable"),b.prototype),z(b.prototype,"selectChatable",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"selectChatable"),b.prototype),z(b.prototype,"registerFocusFilterAction",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"registerFocusFilterAction"),b.prototype),z(b.prototype,"onFilter",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"onFilter"),b.prototype),z(b.prototype,"fetch",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"fetch"),b.prototype),z(b.prototype,"unselectMember",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"unselectMember"),b.prototype),b)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members",["exports","@glimmer/component","@ember/component","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","discourse-common/helpers/d-icon","discourse-i18n","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list","discourse/plugins/chat/discourse/components/chat/message-creator/member","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p
function m(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"addMoreMembersLabel",o.default.t("chat.new_message_modal.user_search_placeholder"))}onFilter(){this.args.onFilter(...arguments)}registerFocusFilterAction(e){this.args.registerFocusFilterAction((()=>e.focus()))}handleKeypress(e){return"Backspace"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void(this.args.highlightedMember?this.args.onSelectMember(this.args.highlightedMember):this.args.onHighlightMember(this.args.members.lastObject))):"ArrowLeft"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void this.args.onHighlightMember((0,c.getPrevious)(this.args.members,this.args.highlightedMember))):"ArrowRight"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void this.args.onHighlightMember((0,c.getNext)(this.args.members,this.args.highlightedMember))):"Enter"===e.key&&this.args.highlightedMember?(e.preventDefault(),e.stopPropagation(),void this.args.onSelectMember(this.args.highlightedMember)):void(this.highlightedMember=null)}},(0,i.setComponentTemplate)((0,d.createTemplateFactory)({id:"Q/QVIsJH",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__members-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__members"],[12],[1,"\\n        "],[1,[28,[32,0],["search"],null]],[1,"\\n\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1]],null]],null],null,[[[1,"          "],[8,[32,1],null,[["@member","@onSelect","@highlighted"],[[30,2],[30,3],[28,[32,2],[[30,2],[30,4]],null]]],null],[1,"\\n"]],[2]],null],[1,"\\n        "],[8,[32,3],[[16,"placeholder",[30,0,["addMoreMembersLabel"]]],[24,0,"chat-message-creator__members-input"],[16,"autofocus",true],[4,[32,4],["input",[30,0,["onFilter"]]],null],[4,[32,4],["keydown",[30,0,["handleKeypress"]]],null],[4,[32,5],[[30,0,["registerFocusFilterAction"]]],null]],[["@value"],[[30,5]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@members","member","@onSelectMember","@highlightedMember","@filter"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members.js",scope:()=>[s.default,u.default,l.default,i.Input,n.on,a.default],isStrictMode:!0}),p),b((h=p).prototype,"onFilter",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"onFilter"),h.prototype),b(h.prototype,"registerFocusFilterAction",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"registerFocusFilterAction"),h.prototype),b(h.prototype,"handleKeypress",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"handleKeypress"),h.prototype),h)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/new-group",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse-i18n","truth-helpers/helpers/gte","discourse/plugins/chat/discourse/components/chat/message-creator/members-count","discourse/plugins/chat/discourse/components/chat/message-creator/members-selector","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(v=class extends t.default{constructor(){super(...arguments),y(this,"chat",m,this),y(this,"router",b,this),y(this,"siteSettings",g,this),y(this,"newGroupTitle",f,this),w(this,"placeholder",l.default.t("chat.direct_message_creator.group_name"))}get membersCount(){return this.args.members?.reduce(((e,t)=>"group"===t.type?e+t.model.chat_enabled_user_count:e+1),1)}async createGroup(){try{const e=this.args.members.filter((e=>"user"===e.type)).mapBy("model.username"),t=this.args.members.filter((e=>"group"===e.type)).mapBy("model.name"),i=await this.chat.upsertDmChannel({usernames:e,groups:t},this.newGroupTitle)
if(!i)return
this.args.close?.(),this.router.transitionTo("chat.channel",...i.routeModels)}catch(e){(0,o.popupAjaxError)(e)}}},(0,n.setComponentTemplate)((0,h.createTemplateFactory)({id:"UqfhWeHr",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__new-group-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__new-group"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__new-group-header-container"],[12],[1,"\\n          "],[10,0],[14,0,"chat-message-creator__new-group-header"],[12],[1,"\\n            "],[8,[32,0],[[24,3,"channel-name"],[24,0,"chat-message-creator__new-group-header__input"],[16,"placeholder",[30,0,["placeholder"]]]],[["@value"],[[30,0,["newGroupTitle"]]]],null],[1,"\\n\\n            "],[8,[32,1],null,[["@count","@max"],[[30,0,["membersCount"]],[30,0,["siteSettings","chat_max_direct_message_users"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,2],null,[["@members","@channel","@onChange","@close","@cancel","@membersCount","@maxReached"],[[30,1],[30,2],[30,3],[30,4],[30,5],[30,0,["membersCount"]],[28,[32,3],[[30,0,["membersCount"]],[30,0,["siteSettings","chat_max_direct_message_users"]]],null]]],null],[1,"\\n\\n"],[41,[30,1,["length"]],[[[1,"          "],[10,0],[14,0,"chat-message-creator__new-group-footer-container"],[12],[1,"\\n            "],[10,0],[14,0,"chat-message-creator__new-group-footer"],[12],[1,"\\n              "],[8,[32,4],[[24,0,"btn-primary btn-flat"]],[["@label","@action"],["cancel",[30,5]]],null],[1,"\\n              "],[8,[32,4],[[24,0,"btn-primary create-chat-group"]],[["@label","@action"],["chat.new_message_modal.create_new_group_chat",[30,0,["createGroup"]]]],null],[1,"\\n\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@members","@channel","@onChangeMembers","@close","@cancel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/new-group.js",scope:()=>[n.Input,u.default,d.default,c.default,s.default],isStrictMode:!0}),v),m=_((p=v).prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=_(p.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_(p.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=_(p.prototype,"newGroupTitle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_(p.prototype,"createGroup",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"createGroup"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/search-input",["exports","@glimmer/component","@ember/component","@ember/modifier","discourse-common/helpers/d-icon","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o
function l(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{constructor(){super(...arguments),l(this,"filterPlaceholder",a.default.t("chat.new_message_modal.filter"))}}e.default=c,o=c,(0,i.setComponentTemplate)((0,s.createTemplateFactory)({id:"lVtzk+9z",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__search-input-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__search-input"],[12],[1,"\\n        "],[1,[28,[32,0],["search"],[["class"],["chat-message-creator__search-input__search-icon"]]]],[1,"\\n        "],[8,[32,1],[[24,0,"chat-message-creator__search-input__input"],[16,"placeholder",[30,0,["filterPlaceholder"]]],[4,[32,2],["input",[30,1]],null]],null,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@onFilter"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/search-input.js",scope:()=>[r.default,i.Input,n.on],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/search",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader","discourse/plugins/chat/discourse/components/chat/message-creator/list","discourse/plugins/chat/discourse/components/chat/message-creator/list-handler","discourse/plugins/chat/discourse/components/chat/message-creator/search-input","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v){"use strict"
var y,w,_,j,M,z,O,C
function k(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function S(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(C=class extends t.default{constructor(){super(...arguments),k(this,"chat",w,this),k(this,"router",_,this),k(this,"chatables",j,this),k(this,"highlightedChatable",M,this),k(this,"term",z,this),k(this,"loading",O,this)}get items(){const e=[]
return this.loading?e:(this.term?.length||e.push({identifier:"new-group",type:"list-action",label:d.default.t("chat.new_message_modal.new_group_chat"),enabled:!0,icon:"users",id:"new-group-chat"}),[...e,...this.chatables])}prefillAddMembers(e){this.args.onChangeMode(h.MODES.new_group,[e])}highlightChatable(e){this.highlightedChatable=e}async selectChatable(e){switch(e.type){case"list-action":this.args.onChangeMode(h.MODES.new_group)
break
case"user":if(!e.enabled)return
await this.startOneToOneChannel(e.model.username)
break
case"group":if(!e.enabled)return
this.args.onChangeMode(h.MODES.new_group,[e])
break
default:this.router.transitionTo("chat.channel",...e.model.routeModels),this.args.close()}}onFilter(e){this.chatables=[],this.term=e?.target?.value,this.searchHandler=(0,u.default)(this,this.fetch,e.target.value,c.INPUT_DELAY)}async fetch(){const e=new p.default(this)
this.chatables=await e.search(this.term,{preloadChannels:!this.term}),this.highlightedChatable=this.items[0]}async startOneToOneChannel(e){try{const t=await this.chat.upsertDmChannel({usernames:[e]})
if(!t)return
this.args.close?.(),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){(0,l.popupAjaxError)(t)}}async startGroupChannel(e){try{const t=await this.chat.upsertDmChannel({groups:[e]})
if(!t)return
this.args.close?.(),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){(0,l.popupAjaxError)(t)}}},(0,v.setComponentTemplate)((0,f.createTemplateFactory)({id:"QEOywO66",block:'[[[1,"\\n    "],[8,[32,0],null,[["@items","@highlightedItem","@onHighlight","@onSelect","@onShifSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["highlightChatable"]],[30,0,["selectChatable"]],[30,0,["prefillAddMembers"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-message-creator__search-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__search"],[12],[1,"\\n          "],[11,0],[24,0,"chat-message-creator__section"],[4,[32,1],[[28,[32,2],[[30,0,["fetch"]],null],null]],null],[12],[1,"\\n            "],[8,[32,3],null,[["@filter","@onFilter"],[[30,0,["term"]],[30,0,["onFilter"]]]],null],[1,"\\n\\n            "],[8,[32,4],[[24,0,"btn-flat chat-message-creator__search-input__cancel-button"]],[["@icon","@action"],["times",[30,1]]],null],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[32,5],null,[["@items","@highlightedItem","@onSelect","@onHighlight","@onShiftSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["selectChatable"]],[30,0,["highlightChatable"]],[30,0,["prefillAddMembers"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["@close"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/search.js",scope:()=>[b.default,a.default,n.fn,g.default,o.default,m.default],isStrictMode:!0}),C),w=S((y=C).prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=S(y.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=S(y.prototype,"chatables",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=S(y.prototype,"highlightedChatable",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=S(y.prototype,"term",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=S(y.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S(y.prototype,"prefillAddMembers",[r.action],Object.getOwnPropertyDescriptor(y.prototype,"prefillAddMembers"),y.prototype),S(y.prototype,"highlightChatable",[r.action],Object.getOwnPropertyDescriptor(y.prototype,"highlightChatable"),y.prototype),S(y.prototype,"selectChatable",[r.action],Object.getOwnPropertyDescriptor(y.prototype,"selectChatable"),y.prototype),S(y.prototype,"onFilter",[r.action],Object.getOwnPropertyDescriptor(y.prototype,"onFilter"),y.prototype),S(y.prototype,"fetch",[r.action],Object.getOwnPropertyDescriptor(y.prototype,"fetch"),y.prototype),y)})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user",["exports","@glimmer/component","@ember/service","discourse/helpers/user-status","discourse-i18n","truth-helpers/helpers/gt","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/components/chat-user-display-name","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p
function m(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=h)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),m(this,"disabledUserLabel",r.default.t("chat.new_message_modal.disabled_user"))}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"UKsMOzmk",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -user"],[15,"data-disabled",[28,[32,0],[[30,1,["enabled"]]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@user","@interactive"],[[30,1,["model"]],false]],null],[1,"\\n      "],[8,[32,2],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[32,3],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"        "],[10,0],[14,0,"unread-indicator -urgent"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[1,[28,[32,4],[[30,1,["model"]]],[["currentUser"],[[30,0,["currentUser"]]]]]],[1,"\\n\\n"],[41,[51,[30,1,["enabled"]]],[[[1,"        "],[10,1],[14,0,"chat-message-creator__chatable -disabled-chat"],[12],[1,"\\n          "],[1,[30,0,["disabledUserLabel"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@item"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/user.js",scope:()=>[s.default,o.default,l.default,a.default,n.default],isStrictMode:!0}),p),b=(d=p).prototype,g="currentUser",f=[i.inject],v={configurable:!0,enumerable:!0,writable:!0,initializer:null},w={},Object.keys(v).forEach((function(e){w[e]=v[e]})),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=f.slice().reverse().reduce((function(e,t){return t(b,g,e)||e}),w),y&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(y):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(b,g,w),w=null),h=w,d)
var b,g,f,v,y,w})),define("discourse/plugins/chat/discourse/components/chat/message/avatar",["exports","discourse/plugins/chat/discourse/components/chat-emoji-avatar","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"LdIBqD01",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-message-avatar"],[12],[1,"\\n"],[41,[30,1,["chatWebhookEvent","emoji"]],[[[1,"      "],[8,[32,0],null,[["@emoji"],[[30,1,["chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,1],null,[["@user","@avatarSize"],[[30,1,["user"]],"medium"]],null],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/avatar.js",scope:()=>[t.default,i.default],isStrictMode:!0}),(0,a.default)())
e.default=s})),define("discourse/plugins/chat/discourse/components/chat/message/error",["exports","@ember/helper","discourse/components/d-button","discourse-common/helpers/i18n","truth-helpers/helpers/eq","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"VcVJSuEj",block:'[[[1,"\\n"],[41,[30,1,["error"]],[[[1,"    "],[10,0],[14,0,"chat-message-error"],[12],[1,"\\n"],[41,[28,[32,0],[[30,1,["error"]],"network_error"],null],[[[1,"        "],[8,[32,1],[[24,0,"chat-message-error__retry-btn"]],[["@action","@icon"],[[28,[32,2],[[30,2],[30,1]],null],"exclamation-circle"]],[["default"],[[[[1,"\\n          "],[10,1],[14,0,"chat-message-error__retry-btn-title"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.retry_staged_message.title"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,1],[14,0,"chat-message-error__retry-btn-action"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.retry_staged_message.action"],null]],[1,"\\n          "],[13],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,1,["error"]]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n"]],[]],null]],["@message","@onRetry"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/error.js",scope:()=>[r.default,i.default,t.fn,n.default],isStrictMode:!0}),(0,o.default)())
e.default=l})),define("discourse/plugins/chat/discourse/components/chat/message/info",["exports","@glimmer/component","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/service","discourse/components/bookmark-icon","discourse/components/user-status-message","discourse/helpers/concat-class","discourse/lib/settings","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/utils/decorators","discourse/plugins/chat/discourse/helpers/format-chat-date","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v,y,w
function _(e,t,i){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function j(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=new WeakMap,w=new WeakMap,v=class extends t.default{constructor(){var e,t,i,n
super(...arguments),_(this,w,{get:O,set:void 0}),_(this,y,{get:z,set:void 0}),e=this,t="siteSettings",n=this,(i=f)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}trackStatus(){j(this,y)?.trackStatus?.()}stopTrackingStatus(){j(this,y)?.stopTrackingStatus?.()}get usernameClasses(){const e=j(this,y),t=this.prioritizeName?["is-full-name"]:["is-username"]
return e?(e.staff&&t.push("is-staff"),e.admin&&t.push("is-admin"),e.moderator&&t.push("is-moderator"),e.new_user&&t.push("is-new-user"),e.primary_group_name&&t.push("group--"+e.primary_group_name),t.join(" ")):t}get name(){return this.prioritizeName?j(this,y)?.get("name"):j(this,y)?.get("username")}get isFlagged(){return j(this,w)?.reviewableId||0===j(this,w)?.userFlagStatus}get prioritizeName(){return this.siteSettings.display_name_on_posts&&(0,c.prioritizeNameInUx)(j(this,y)?.get("name"))}get showStatus(){return!!j(this,y)?.get("status")}},(0,b.setComponentTemplate)((0,m.createTemplateFactory)({id:"t99+oxr0",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[11,0],[24,0,"chat-message-info"],[4,[32,0],[[30,0,["trackStatus"]]],null],[4,[32,1],[[30,0,["stopTrackingStatus"]]],null],[12],[1,"\\n"],[41,[30,2,["chatWebhookEvent"]],[[[41,[30,2,["chatWebhookEvent","username"]],[[[1,"            "],[10,1],[15,0,[28,[32,2],["chat-message-info__username",[30,0,["usernameClasses"]]],null]],[12],[1,"\\n              "],[1,[30,2,["chatWebhookEvent","username"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,1],[14,0,"chat-message-info__bot-indicator"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.bot"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,1],[14,"role","button"],[15,0,[28,[32,2],["chat-message-info__username",[30,0,["usernameClasses"]],"clickable"],null]],[15,"data-user-card",[30,2,["user","username"]]],[12],[1,"\\n            "],[10,1],[14,0,"chat-message-info__username__name"],[12],[1,[30,0,["name"]]],[13],[1,"\\n"],[41,[30,0,["showStatus"]],[[[1,"              "],[10,0],[14,0,"chat-message-info__status"],[12],[1,"\\n                "],[8,[32,4],null,[["@status"],[[30,2,["user","status"]]]],null],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n"]],[]]],[1,"\\n        "],[10,1],[14,0,"chat-message-info__date"],[12],[1,"\\n          "],[1,[28,[32,5],[[30,2]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,2,["bookmark"]],[[[1,"          "],[10,1],[14,0,"chat-message-info__bookmark"],[12],[1,"\\n            "],[8,[32,6],null,[["@bookmark"],[[30,2,["bookmark"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["isFlagged"]],[[[1,"          "],[10,1],[14,0,"chat-message-info__flag"],[12],[1,"\\n"],[41,[30,2,["reviewableId"]],[[[1,"              "],[8,[32,7],null,[["@route","@model"],["review.show",[30,2,["reviewableId"]]]],[["default"],[[[[1,"\\n                "],[1,[28,[32,8],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],[[[1,"              "],[1,[28,[32,8],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@show","@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/info.js",scope:()=>[i.default,n.default,l.default,d.default,o.default,p.default,s.default,r.LinkTo,u.default],isStrictMode:!0}),v),f=M((g=v).prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M(g.prototype,"trackStatus",[h.bind],Object.getOwnPropertyDescriptor(g.prototype,"trackStatus"),g.prototype),M(g.prototype,"stopTrackingStatus",[h.bind],Object.getOwnPropertyDescriptor(g.prototype,"stopTrackingStatus"),g.prototype),g)
function z(){return j(this,w)?.user}function O(){return this.args.message}})),define("discourse/plugins/chat/discourse/components/chat/message/left-gutter",["exports","@glimmer/component","@ember/routing","@ember/service","discourse/components/bookmark-icon","discourse-common/helpers/d-icon","truth-helpers/helpers/eq","discourse/plugins/chat/discourse/helpers/format-chat-date","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"swtnif+9",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-left-gutter"],[12],[1,"\\n"],[41,[30,1,["reviewableId"]],[[[1,"        "],[8,[32,0],[[24,0,"chat-message-left-gutter__flag"]],[["@route","@model"],["review.show",[30,1,["reviewableId"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[32,1],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],[[[41,[28,[32,2],[[30,1,["userFlagStatus"]],0],null],[[[1,"        "],[10,0],[14,0,"chat-message-left-gutter__flag"],[12],[1,"\\n          "],[1,[28,[32,1],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,0,["site","desktopView"]],[[[1,"        "],[10,1],[14,0,"chat-message-left-gutter__date"],[12],[1,"\\n          "],[1,[28,[32,3],[[30,1],"tiny"],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]],null]],[]]]],[]]],[41,[30,1,["bookmark"]],[[[1,"        "],[10,1],[14,0,"chat-message-left-gutter__bookmark"],[12],[1,"\\n          "],[8,[32,4],null,[["@bookmark"],[[30,1,["bookmark"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/left-gutter.js",scope:()=>[i.LinkTo,a.default,s.default,o.default,r.default],isStrictMode:!0}),h),p=(u=h).prototype,m="site",b=[n.inject],g={configurable:!0,enumerable:!0,writable:!0,initializer:null},v={},Object.keys(g).forEach((function(e){v[e]=g[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=b.slice().reverse().reduce((function(e,t){return t(p,m,e)||e}),v),f&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(f):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(p,m,v),v=null),d=v,u)
var p,m,b,g,f,v})),define("discourse/plugins/chat/discourse/components/chat/modal/archive-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/later","discourse-i18n","discourse/plugins/chat/discourse/components/chat-to-topic-selector","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g){"use strict"
var f,v,y,w,_,j,M,z,O,C,k,S,P
function T(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function E(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function x(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(P=new WeakSet,S=class extends t.default{constructor(){super(...arguments),E(this,P),T(this,"chatApi",v,this),T(this,"siteSettings",y,this),T(this,"selection",w,this),T(this,"saving",_,this),T(this,"topicTitle",j,this),T(this,"categoryId",M,this),T(this,"tags",z,this),T(this,"selectedTopicId",O,this),T(this,"flash",C,this),T(this,"flashType",k,this)}get channel(){return this.args.model.channel}get newTopic(){return this.selection===p.NEW_TOPIC_SELECTION}get existingTopic(){return this.selection===p.EXISTING_TOPIC_SELECTION}get buttonDisabled(){return!!this.saving||(!(!this.newTopic||!(!this.topicTitle||this.topicTitle.length<this.siteSettings.min_topic_title_length||this.topicTitle.length>this.siteSettings.max_topic_title_length))||!(!this.existingTopic||!(0,s.isEmpty)(this.selectedTopicId)))}get instructionLabels(){const e={}
return e[p.NEW_TOPIC_SELECTION]=h.default.t("chat.selection.new_topic.instructions_channel_archive"),e[p.EXISTING_TOPIC_SELECTION]=h.default.t("chat.selection.existing_topic.instructions_channel_archive"),e}get instructionsText(){return(0,a.htmlSafe)(h.default.t("chat.channel_archive.instructions",{channelTitle:this.channel.escapedTitle}))}archiveChannel(){return this.saving=!0,this.chatApi.createChannelArchive(this.channel.id,function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,P,D).call(this)).then((()=>{this.flash=h.default.t("chat.channel_archive.process_started"),this.flashType="success",this.channel.status=m.CHANNEL_STATUSES.archived,(0,d.default)((()=>{this.args.closeModal()}),3e3)})).catch(c.popupAjaxError).finally((()=>this.saving=!1))}},(0,g.setComponentTemplate)((0,b.createTemplateFactory)({id:"tWdu31AS",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-archive-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[32,1],["chat.channel_archive.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-archive-channel__instructions"],[12],[1,"\\n          "],[1,[30,0,["instructionsText"]]],[1,"\\n        "],[13],[1,"\\n        "],[8,[32,2],null,[["@selection","@topicTitle","@categoryId","@tags","@selectedTopicId","@instructionLabels","@allowNewMessage"],[[30,0,["selection"]],[30,0,["topicTitle"]],[30,0,["categoryId"]],[30,0,["tags"]],[30,0,["selectedTopicId"]],[30,0,["instructionLabels"]],false]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,1,"chat-confirm-archive-channel"],[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["archiveChannel"]],"chat.channel_archive.title"]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/archive-channel.js",scope:()=>[l.default,u.default,p.default,o.default],isStrictMode:!0}),S),v=x((f=S).prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=x(f.prototype,"siteSettings",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=x(f.prototype,"selection",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.NEW_TOPIC_SELECTION}}),_=x(f.prototype,"saving",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=x(f.prototype,"topicTitle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=x(f.prototype,"categoryId",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=x(f.prototype,"tags",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=x(f.prototype,"selectedTopicId",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=x(f.prototype,"flash",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=x(f.prototype,"flashType",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x(f.prototype,"archiveChannel",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"archiveChannel"),f.prototype),f)
function D(){const e={type:this.selection}
return this.newTopic&&(e.title=this.topicTitle,e.category_id=this.categoryId,e.tags=this.tags),this.existingTopic&&(e.topic_id=this.selectedTopicId),e}})),define("discourse/plugins/chat/discourse/components/chat/modal/channel-summary",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/components/conditional-loading-section","discourse/components/d-modal","discourse/components/d-modal-cancel","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","select-kit/components/combo-box","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(y=class extends t.default{constructor(){super(...arguments),w(this,"chatApi",b,this),w(this,"sinceHours",g,this),w(this,"loading",f,this),w(this,"summary",v,this),_(this,"availableSummaries",{}),_(this,"sinceOptions",[1,3,6,12,24,72,168].map((e=>({name:u.default.t("chat.summarization.since",{count:e}),value:e}))))}get channelId(){return this.args.model.channelId}summarize(e){return this.sinceHours=e,this.loading=!0,this.availableSummaries[e]?(this.summary=this.availableSummaries[e],void(this.loading=!1)):this.chatApi.summarize(this.channelId,{since:e}).then((e=>{this.availableSummaries[this.sinceHours]=e.summary,this.summary=this.availableSummaries[this.sinceHours]})).catch(l.popupAjaxError).finally((()=>this.loading=!1))}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"Wd6UNPWs",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-channel-summary"]],[["@closeModal","@title"],[[30,1],[28,[32,1],["chat.summarization.title"],null]]],[["body","footer"],[[[[1,"\\n        "],[10,1],[12],[1,[28,[32,1],["chat.summarization.description"],null]],[13],[1,"\\n        "],[8,[32,2],[[24,0,"summarization-since"]],[["@value","@content","@onChange","@valueProperty"],[[30,0,["sinceHours"]],[30,0,["sinceOptions"]],[30,0,["summarize"]],"value"]],null],[1,"\\n        "],[8,[32,3],null,[["@isLoading"],[[30,0,["loading"]]]],[["default"],[[[[1,"\\n          "],[10,2],[14,0,"summary-area"],[12],[1,[30,0,["summary"]]],[13],[1,"\\n        "]],[]]]]],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,4],null,[["@close"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/channel-summary.js",scope:()=>[s.default,c.default,d.default,a.default,o.default],isStrictMode:!0}),y),b=j((m=y).prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=j(m.prototype,"sinceHours",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=j(m.prototype,"loading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=j(m.prototype,"summary",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j(m.prototype,"summarize",[n.action],Object.getOwnPropertyDescriptor(m.prototype,"summarize"),m.prototype),m)})),define("discourse/plugins/chat/discourse/components/chat/modal/create-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/lib/debounce","discourse-i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D,A,N,I,L,U
function R(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function F(e,t){B(e,t),t.add(e)}function B(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,V(e,t,"set"),i),i}function H(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function $(e,t){return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,V(e,t,"get"))}function V(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function G(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const q=(0,m.createTemplateFactory)({id:"d48yUZBc",block:'[[[8,[39,0],[[24,0,"chat-modal-create-channel"],[4,[38,2],["submit",[30,0,["onSave"]]],null]],[["@closeModal","@inline","@title","@flash","@tagName"],[[30,1],[30,2],[28,[37,1],["chat.create_channel.title"],null],[30,0,["flash"]],"form"]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -name"],[12],[1,"\\n      "],[10,"label"],[14,"for","name"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"name"],[24,0,"chat-modal-create-channel__input"],[4,[38,2],["input",[28,[37,4],[[30,0],[30,0,["onNameChange"]]],[["value"],["target.value"]]]],null]],[["@type","@value"],["text",[30,0,["name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -slug"],[12],[1,"\\n      "],[10,"label"],[14,"for","slug"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.slug"],null]],[1," \\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,5],["info-circle"],null]],[1,"\\n          "],[8,[39,6],null,null,[["default"],[[[[1,"\\n            "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug_description"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"slug"],[24,0,"chat-modal-create-channel__input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]]],[["@type","@value"],["text",[30,0,["slug"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -description"],[12],[1,"\\n      "],[10,"label"],[14,"for","description"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"description"],[24,0,"chat-modal-create-channel__input"]],[["@type","@value"],["textarea",[30,0,["description"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.choose_category.label"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value","@onChange","@options"],[[30,0,["categoryId"]],[28,[37,4],[[30,0],[30,0,["onCategoryChange"]]],null],[28,[37,8],null,[["formName","none"],["chatable_id","chat.create_channel.choose_category.none"]]]]],null],[1,"\\n\\n"],[41,[30,0,["categoryPermissionsHint"]],[[[1,"        "],[10,0],[15,0,[28,[37,10],["chat-modal-create-channel__hint",[52,[30,0,["loadingPermissionHint"]],"loading-permissions"]],null]],[12],[1,"\\n          "],[1,[30,0,["categoryPermissionsHint"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"      "],[10,0],[14,0,"chat-modal-create-channel__control -auto-join"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n          "],[8,[39,3],[[24,3,"auto_join_users"]],[["@type","@checked"],["checkbox",[30,0,["autoJoinUsers"]]]],null],[1,"\\n          "],[10,0],[14,0,"auto-join-channel"],[12],[1,"\\n            "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n              "],[1,[28,[35,1],["chat.settings.auto_join_users_label"],null]],[1,"\\n            "],[13],[1,"\\n            "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n"],[41,[30,0,["categoryName"]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info"],[["category"],[[30,0,["categoryName"]]]]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info_no_category"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -threading-toggle"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[8,[39,3],[[24,3,"threading_enabled"]],[["@type","@checked"],["checkbox",[30,0,["threadingEnabled"]]]],null],[1,"\\n        "],[10,0],[14,0,"threading-channel"],[12],[1,"\\n          "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.create_channel.threading.label"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.settings.channel_threading_description"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[10,"button"],[14,0,"btn btn-primary create"],[15,"disabled",[30,0,["createDisabled"]]],[14,4,"submit"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.create_channel.create"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","on","input","action","d-icon","d-tooltip","category-chooser","hash","if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/create-channel.hbs",isStrictMode:!1}),K=(0,o.htmlSafe)(p.default.t("chat.create_channel.choose_category.default_hint",{link:"/categories",category:"category"}))
let J=e.default=(x=new WeakMap,D=new WeakSet,A=new WeakSet,N=new WeakSet,I=new WeakSet,L=new WeakSet,U=new WeakSet,b=class extends i.default{constructor(){var e,t,i
super(...arguments),F(this,U),F(this,L),F(this,I),F(this,N),F(this,A),F(this,D),R(this,"chat",g,this),R(this,"dialog",f,this),R(this,"chatChannelsManager",v,this),R(this,"chatApi",y,this),R(this,"router",w,this),R(this,"currentUser",_,this),R(this,"siteSettings",j,this),R(this,"site",M,this),R(this,"flash",z,this),R(this,"name",O,this),R(this,"category",C,this),R(this,"categoryId",k,this),R(this,"autoGeneratedSlug",S,this),R(this,"categoryPermissionsHint",P,this),R(this,"autoJoinWarning",T,this),R(this,"loadingPermissionHint",E,this),i={writable:!0,value:null},B(e=this,t=x),t.set(e,i)}willDestroy(){super.willDestroy(...arguments),(0,a.cancel)($(this,x))}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0}get categorySelected(){return(0,l.isPresent)(this.category)}get createDisabled(){return!this.categorySelected||(0,l.isBlank)(this.name)}get categoryName(){return this.categorySelected&&(0,l.isPresent)(this.name)?(0,d.escapeExpression)(this.name):null}onShow(){this.categoryPermissionsHint=K}onCategoryChange(e){const t=e?this.site.categories.findBy("id",e):null
H(this,I,Q).call(this,t)
const i=this.name||t?.name||""
this.categoryId=e,this.category=t,this.name=i,H(this,U,te).call(this,i)}onNameChange(e){H(this,U,te).call(this,e)}onSave(e){if(e.preventDefault(),this.createDisabled)return
const t=new FormData(e.currentTarget),i=Object.fromEntries(t.entries())
i.auto_join_users="on"===i.auto_join_users,i.slug??=this.autoGeneratedSlug,i.threading_enabled="on"===i.threading_enabled,i.auto_join_users?this.dialog.yesNoConfirm({message:this.autoJoinWarning,didConfirm:()=>H(this,D,Y).call(this,i)}):H(this,D,Y).call(this,i)}},g=G(b.prototype,"chat",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=G(b.prototype,"dialog",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=G(b.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=G(b.prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=G(b.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=G(b.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=G(b.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=G(b.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=G(b.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=G(b.prototype,"name",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=G(b.prototype,"category",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=G(b.prototype,"categoryId",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=G(b.prototype,"autoGeneratedSlug",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),P=G(b.prototype,"categoryPermissionsHint",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=G(b.prototype,"autoJoinWarning",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=G(b.prototype,"loadingPermissionHint",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),G(b.prototype,"onShow",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onShow"),b.prototype),G(b.prototype,"onCategoryChange",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onCategoryChange"),b.prototype),G(b.prototype,"onNameChange",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onNameChange"),b.prototype),G(b.prototype,"onSave",[r.action],Object.getOwnPropertyDescriptor(b.prototype,"onSave"),b.prototype),b)
async function Y(e){try{const t=await this.chatApi.createChannel(e)
this.args.closeModal(),this.chatChannelsManager.follow(t),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){this.flash=(0,u.extractError)(t)}}function Z(e){const t=e.parentCategory
return t?`${H(this,A,Z).call(this,t)}/${e.slug}`:e.slug}function X(e,t){const i=t.allowed_groups
let n
if(t.private)switch(i.length){case 1:n=p.default.t("chat.create_channel.auto_join_users.warning_1_group",{count:t.members_count,group:(0,d.escapeExpression)(i[0])})
break
case 2:n=p.default.t("chat.create_channel.auto_join_users.warning_2_groups",{count:t.members_count,group1:(0,d.escapeExpression)(i[0]),group2:(0,d.escapeExpression)(i[1])})
break
default:n=p.default.messageFormat("chat.create_channel.auto_join_users.warning_multiple_groups_MF",{groupCount:i.length-1,userCount:t.members_count,groupName:(0,d.escapeExpression)(i[0])})}else n=p.default.t("chat.create_channel.auto_join_users.public_category_warning",{category:(0,d.escapeExpression)(e.name)})
this.autoJoinWarning=n}function Q(e){if(e){const t=H(this,A,Z).call(this,e)
return this.loadingPermissionHint=!0,this.chatApi.categoryPermissions(e.id).then((i=>{H(this,N,X).call(this,e,i)
const n=i.allowed_groups,r=`/c/${(0,d.escapeExpression)(t)}/edit/security`
let a
switch(n.length){case 1:a=p.default.t("chat.create_channel.choose_category.hint_1_group",{settingLink:r,group:(0,d.escapeExpression)(n[0])})
break
case 2:a=p.default.t("chat.create_channel.choose_category.hint_2_groups",{settingLink:r,group1:(0,d.escapeExpression)(n[0]),group2:(0,d.escapeExpression)(n[1])})
break
default:a=p.default.t("chat.create_channel.choose_category.hint_multiple_groups",{settingLink:r,group:(0,d.escapeExpression)(n[0]),count:n.length-1})}this.categoryPermissionsHint=(0,o.htmlSafe)(a)})).finally((()=>{this.loadingPermissionHint=!1}))}this.categoryPermissionsHint=K,this.autoJoinWarning=""}function ee(e){return(0,c.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}function te(e){(0,a.cancel)($(this,x)),this.autoGeneratedSlug="",e&&W(this,x,(0,h.default)(this,H(this,L,ee),e,300))}(0,t.setComponentTemplate)(q,J)})),define("discourse/plugins/chat/discourse/components/chat/modal/delete-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/components/text-field","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/later","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v,y,w,_,j,M,z
function O(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(z=class extends t.default{constructor(){super(...arguments),O(this,"chatApi",f,this),O(this,"router",v,this),O(this,"channelNameConfirmation",y,this),O(this,"deleting",w,this),O(this,"confirmed",_,this),O(this,"flash",j,this),O(this,"flashType",M,this)}get channel(){return this.args.model.channel}get buttonDisabled(){return!(!this.deleting&&!this.confirmed)||!(!(0,s.isEmpty)(this.channelNameConfirmation)&&this.channelNameConfirmation.toLowerCase()===this.channel.title.toLowerCase())}get instructionsText(){return(0,a.htmlSafe)(p.default.t("chat.channel_delete.instructions",{name:this.channel.escapedTitle}))}deleteChannel(){return this.deleting=!0,this.chatApi.destroyChannel(this.channel.id,this.channelNameConfirmation).then((()=>{this.confirmed=!0,this.flash=p.default.t("chat.channel_delete.process_started"),this.flashType="success",(0,h.default)((()=>{this.args.closeModal(),this.router.transitionTo("chat")}),3e3)})).catch(u.popupAjaxError).finally((()=>this.deleting=!1))}},(0,b.setComponentTemplate)((0,m.createTemplateFactory)({id:"Oj2Ntn8W",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-delete-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[32,1],["chat.channel_delete.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-delete-channel__instructions"],[12],[1,"\\n          "],[1,[30,0,["instructionsText"]]],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,2],null,[["@value","@id","@placeholderKey","@autocorrect","@autocapitalize"],[[30,0,["channelNameConfirmation"]],"channel-delete-confirm-name","chat.channel_delete.confirm_channel_name","off","off"]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,1,"chat-confirm-delete-channel"],[24,0,"btn-danger"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["deleteChannel"]],"chat.channel_delete.confirm"]],null],[1,"\\n        "],[8,[32,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/delete-channel.js",scope:()=>[l.default,d.default,c.default,o.default],isStrictMode:!0}),z),f=C((g=z).prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=C(g.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=C(g.prototype,"channelNameConfirmation",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=C(g.prototype,"deleting",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=C(g.prototype,"confirmed",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=C(g.prototype,"flash",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=C(g.prototype,"flashType",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C(g.prototype,"deleteChannel",[n.action],Object.getOwnPropertyDescriptor(g.prototype,"deleteChannel"),g.prototype),g)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"TZprB0qD",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-description"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_description_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[14,0,"chat-modal-edit-channel-description__description"],[12],[1,[28,[35,1],["chat.channel_edit_description_modal.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@max"],[[30,0,["editedDescription"]],[30,0,["descriptionMaxLength"]]]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[24,0,"chat-modal-edit-channel-description__description-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_description_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0],[30,0,["onChangeChatChannelDescription"]]],[["value"],["target.value"]]]],null],[12],[1,[30,0,["editedDescription"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,5],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSaveChatChannelDescription"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,6],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","char-counter","on","action","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),h(this,"chatApi",c,this),h(this,"editedDescription",u,this),h(this,"flash",d,this)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.description===this.editedDescription||this.editedDescription?.length>280}get descriptionMaxLength(){return 280}async onSaveChatChannelDescription(){try{const e=await this.chatApi.updateChannel(this.channel.id,{description:this.editedDescription})
this.channel.description=e.channel.description,this.args.closeModal()}catch(e){this.flash=(0,s.extractError)(e)}}onChangeChatChannelDescription(e){this.flash=null,this.editedDescription=e}},c=p(l.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"editedDescription",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.description||""}}),d=p(l.prototype,"flash",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"onSaveChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"onSaveChatChannelDescription"),l.prototype),p(l.prototype,"onChangeChatChannelDescription",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"onChangeChatChannelDescription"),l.prototype),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/modifier","@ember/object","@ember/runloop","@ember/service","discourse/components/d-button","discourse/components/d-modal","discourse/components/d-modal-cancel","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/debounce","float-kit/components/d-tooltip","discourse/plugins/chat/discourse/lib/slugify-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f){"use strict"
var v,y,w,_,j,M,z,O,C,k,S,P
function T(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function E(e,t){x(e,t),t.add(e)}function x(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i)
else{if(!t.writable)throw new TypeError("attempted to set read only private field")
t.value=i}}(e,A(e,t,"set"),i),i}function A(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}function N(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function I(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(k=new WeakMap,S=new WeakSet,P=new WeakSet,C=class extends t.default{constructor(){var e,t,i
super(...arguments),E(this,P),E(this,S),T(this,"chatApi",y,this),T(this,"router",w,this),T(this,"siteSettings",_,this),T(this,"editedName",j,this),T(this,"editedSlug",M,this),T(this,"autoGeneratedSlug",z,this),T(this,"flash",O,this),i={writable:!0,value:null},x(e=this,t=k),t.set(e,i)}get channel(){return this.args.model}get isSaveDisabled(){return this.channel.title===this.editedName&&this.channel.slug===this.editedSlug||this.editedName?.length>this.siteSettings.max_topic_title_length||this.editedSlug?.length>100}async onSave(){try{const e=await this.chatApi.updateChannel(this.channel.id,{name:this.editedName,slug:this.editedSlug||this.autoGeneratedSlug||this.channel.slug})
this.channel.title=e.channel.title,this.channel.slug=e.channel.slug,await this.args.closeModal(),await this.router.replaceWith("chat.channel",...this.channel.routeModels)}catch(e){this.flash=(0,h.extractError)(e)}}onChangeChatChannelName(e){this.flash=null,N(this,S,L).call(this,e?.target?.value)}onChangeChatChannelSlug(){this.flash=null,N(this,S,L).call(this,this.editedName)}},(0,n.setComponentTemplate)((0,f.createTemplateFactory)({id:"P+wEu0O6",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-edit-channel-name"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[32,1],["chat.channel_edit_name_slug_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n        "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n          "],[10,"label"],[14,"for","channel-name"],[14,0,"edit-channel-label"],[12],[1,"\\n            "],[1,[28,[32,1],["chat.channel_edit_name_slug_modal.name"],null]],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,2],[[24,3,"channel-name"],[24,0,"chat-channel-edit-name-slug-modal__name-input"],[16,"placeholder",[28,[32,1],["chat.channel_edit_name_slug_modal.input_placeholder"],null]],[4,[32,3],["input",[30,0,["onChangeChatChannelName"]]],null]],[["@type","@value"],["text",[30,0,["editedName"]]]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n          "],[10,"label"],[14,"for","channel-slug"],[14,0,"edit-channel-label"],[12],[1,"\\n            "],[1,[28,[32,1],["chat.channel_edit_name_slug_modal.slug"],null]],[1," \\n            "],[8,[32,4],null,[["@icon","@content"],["info-circle",[28,[32,1],["chat.channel_edit_name_slug_modal.slug_description"],null]]],null],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,2],[[24,3,"channel-slug"],[24,0,"chat-channel-edit-name-slug-modal__slug-input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]],[4,[32,3],["input",[30,0,["onChangeChatChannelSlug"]]],null]],[["@type","@value"],["text",[30,0,["editedSlug"]]]],null],[1,"\\n        "],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,5],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSave"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n        "],[8,[32,6],null,[["@close"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name.js",scope:()=>[c.default,p.default,n.Input,r.on,b.default,l.default,u.default],isStrictMode:!0}),C),y=I((v=C).prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=I(v.prototype,"router",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=I(v.prototype,"siteSettings",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=I(v.prototype,"editedName",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.title}}),M=I(v.prototype,"editedSlug",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.slug}}),z=I(v.prototype,"autoGeneratedSlug",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.channel.slug??(0,g.default)(this.channel)}}),O=I(v.prototype,"flash",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I(v.prototype,"onSave",[a.action],Object.getOwnPropertyDescriptor(v.prototype,"onSave"),v.prototype),I(v.prototype,"onChangeChatChannelName",[a.action],Object.getOwnPropertyDescriptor(v.prototype,"onChangeChatChannelName"),v.prototype),I(v.prototype,"onChangeChatChannelSlug",[a.action],Object.getOwnPropertyDescriptor(v.prototype,"onChangeChatChannelSlug"),v.prototype),v)
function L(e){var t;(0,s.cancel)(function(e,t){return t.get?t.get.call(e):t.value}(t=this,A(t,k,"get"))),this.autoGeneratedSlug="",e&&D(this,k,(0,m.default)(this,N(this,P,U),e,300))}async function U(e){try{await(0,d.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}catch(t){console.log(t)}}})),define("discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/components/chat-channel-chooser","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(_=class extends t.default{constructor(){super(...arguments),j(this,"chat",g,this),j(this,"chatApi",f,this),j(this,"router",v,this),j(this,"chatChannelsManager",y,this),j(this,"destinationChannelId",w,this)}get sourceChannel(){return this.args.model.sourceChannel}get selectedMessageIds(){return this.args.model.selectedMessageIds}get selectedMessageCount(){return this.selectedMessageIds?.length}get disableMoveButton(){return(0,s.isBlank)(this.destinationChannelId)}get availableChannels(){return(this.args.model.availableChannels||this.chatChannelsManager.publicMessageChannels).rejectBy("id",this.sourceChannel.id)}get instructionsText(){return(0,a.htmlSafe)(d.default.t("chat.move_to_channel.instructions",{channelTitle:this.sourceChannel.escapedTitle,count:this.selectedMessageCount}))}moveMessages(){return this.chatApi.moveChannelMessages(this.sourceChannel.id,{message_ids:this.selectedMessageIds,destination_channel_id:this.destinationChannelId}).then((e=>{this.args.closeModal(),this.router.transitionTo("chat.channel.near-message","-",e.destination_channel_id,e.first_moved_message_id)})).catch(c.popupAjaxError)}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"Wh4NZMbf",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-move-message-to-channel"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],["chat.move_to_channel.title"],null]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["selectedMessageCount"]],[[[1,"          "],[10,2],[12],[1,[30,0,["instructionsText"]]],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,2],[[24,0,"chat-modal-move-message-to-channel__channel-chooser"]],[["@content","@value","@nameProperty"],[[30,0,["availableChannels"]],[30,0,["destinationChannelId"]],"title"]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,0,"btn-primary"]],[["@icon","@disabled","@action","@label"],["sign-out-alt",[30,0,["disableMoveButton"]],[30,0,["moveMessages"]],"chat.move_to_channel.confirm_move"]],null],[1,"\\n        "],[8,[32,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel.js",scope:()=>[l.default,u.default,h.default,o.default],isStrictMode:!0}),_),g=M((b=_).prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=M(b.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=M(b.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=M(b.prototype,"chatChannelsManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=M(b.prototype,"destinationChannelId",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M(b.prototype,"moveMessages",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"moveMessages"),b.prototype),b)})),define("discourse/plugins/chat/discourse/components/chat/modal/new-message",["exports","@glimmer/component","@ember/service","discourse/components/d-modal","discourse/plugins/chat/discourse/components/chat/message-creator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"siteSettings",c,this)}get shouldRender(){return this.siteSettings.enable_public_channels||this.chat.userCanDirectMessage}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"m24w3NYX",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"chat-modal-new-message"]],[["@closeModal","@title","@inline","@hideHeader"],[[30,1],"chat.new_message_modal.title",[30,2],true]],[["default"],[[[[1,"\\n        "],[8,[32,1],null,[["@onClose","@channel"],[[30,1],[30,3]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@closeModal","@inline","@model"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/new-message.js",scope:()=>[n.default,r.default],isStrictMode:!0}),u),l=h((o=u).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"siteSettings",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/components/chat/modal/thread-settings",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","@ember/service","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=class extends t.default{constructor(){super(...arguments),g(this,"chatApi",h,this),g(this,"editedTitle",p,this),g(this,"saving",m,this)}get buttonDisabled(){return this.saving}get thread(){return this.args.model}saveThread(){this.saving=!0,this.chatApi.editThread(this.thread.channel.id,this.thread.id,{title:this.editedTitle}).then((()=>{this.thread.title=this.editedTitle,this.args.closeModal()})).catch(l.popupAjaxError).finally((()=>{this.saving=!1}))}},(0,n.setComponentTemplate)((0,u.createTemplateFactory)({id:"1/aZ9I0E",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-thread-settings"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],["chat.thread.settings"],null]]],[["body","footer"],[[[[1,"\\n        "],[10,"label"],[14,"for","thread-title"],[14,0,"thread-title-label"],[12],[1,"\\n          "],[1,[28,[32,1],["chat.thread.title"],null]],[1,"\\n        "],[13],[1,"\\n        "],[8,[32,2],[[24,3,"thread-title"],[24,0,"chat-modal-thread-settings__title-input"]],[["@type","@value"],["text",[30,0,["editedTitle"]]]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["saveThread"]],"save"]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/thread-settings.js",scope:()=>[o.default,c.default,n.Input,s.default],isStrictMode:!0}),b),h=f((d=b).prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(d.prototype,"editedTitle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.thread.title||""}}),m=f(d.prototype,"saving",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f(d.prototype,"saveThread",[r.action],Object.getOwnPropertyDescriptor(d.prototype,"saveThread"),d.prototype),d)})),define("discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status",["exports","@glimmer/component","@ember/object","@ember/service","@ember/template","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"chatApi",m,this),f(this,"router",b,this)}get channel(){return this.args.model}get buttonLabel(){return this.channel?.isClosed?"chat.channel_settings.open_channel":"chat.channel_settings.close_channel"}get instructions(){return this.channel?.isClosed?(0,r.htmlSafe)(c.default.t("chat.channel_open.instructions")):(0,r.htmlSafe)(c.default.t("chat.channel_close.instructions"))}get modalTitle(){return this.channel?.isClosed?"chat.channel_open.title":"chat.channel_close.title"}onStatusChange(){const e=this.channel.isClosed?u.CHANNEL_STATUSES.open:u.CHANNEL_STATUSES.closed
return this.chatApi.updateChannelStatus(this.channel.id,e).then((()=>{this.args.closeModal(),this.router.transitionTo("chat.channel",...this.channel.routeModels)})).catch(o.popupAjaxError)}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"S6HBIoaZ",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-toggle-channel-status"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],[[30,0,["modalTitle"]]],null]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-toggle-channel-status__instructions"],[12],[1,[30,0,["instructions"]]],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,2],[[24,1,"chat-channel-toggle-btn"],[24,0,"btn-primary"]],[["@action","@label"],[[30,0,["onStatusChange"]],[30,0,["buttonLabel"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status.js",scope:()=>[s.default,l.default,a.default],isStrictMode:!0}),g),m=v((p=g).prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(p.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(p.prototype,"onStatusChange",[i.action],Object.getOwnPropertyDescriptor(p.prototype,"onStatusChange"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat/navbar/actions",["exports","@ember/helper","discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button","discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button","discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button","discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button","discourse/plugins/chat/discourse/components/chat/navbar/full-page-button","discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button","discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button","discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button","discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button","discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown","discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button","discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,b.setComponentTemplate)((0,m.createTemplateFactory)({id:"luKcWzo7",block:'[[[1,"\\n  "],[10,"nav"],[14,0,"c-navbar__actions"],[12],[1,"\\n    "],[18,1,[[28,[32,0],null,[["OpenDrawerButton","BrowseChannelsButton","NewDirectMessageButton","NewChannelButton","ThreadTrackingDropdown","CloseThreadButton","CloseThreadsButton","ThreadSettingsButton","ThreadsListButton","CloseDrawerButton","ToggleDrawerButton","FullPageButton"],[[32,1],[32,2],[32,3],[32,4],[32,5],[32,6],[32,7],[32,8],[32,9],[32,10],[32,11],[32,12]]]]]],[1,"\\n  "],[13],[1,"\\n"]],["&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/actions.js",scope:()=>[t.hash,c.default,i.default,l.default,o.default,d.default,r.default,a.default,u.default,h.default,n.default,p.default,s.default],isStrictMode:!0}),(0,g.default)())
e.default=f})),define("discourse/plugins/chat/discourse/components/chat/navbar/back-button",["exports","@glimmer/component","@ember/routing","discourse-common/helpers/d-icon","I18n","discourse/plugins/chat/discourse/lib/chat-constants","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{get icon(){return this.args.icon??"chevron-left"}get title(){return this.args.title??r.default.t("chat.browse.back")}get targetRoute(){return a.FOOTER_NAV_ROUTES.includes(this.args.route)?this.args.route:"chat"}}e.default=c,l=c,(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"+gduAWVD",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__back-button no-text btn-transparent btn"],[16,"title",[30,0,["title"]]]],[["@route","@models"],[[30,2],[30,1]]],[["default"],[[[[1,"\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,1],[[30,0,["icon"]]],null]],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n"]],[]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__back-button no-text btn-transparent btn"],[16,"title",[30,0,["title"]]]],[["@route"],[[30,0,["targetRoute"]]]],[["default"],[[[[1,"\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,1],[[30,0,["icon"]]],null]],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n"]],[]]],[1,"  "]],["@routeModels","@route","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/back-button.js",scope:()=>[i.LinkTo,n.default],isStrictMode:!0}),l)})),define("discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),d(this,"browseChannelsLabel",a.default.t("chat.channels_list_popup.browse"))}get showBrowseChannelsButton(){return"chat.channels"===this.router.currentRoute.name}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"HK/QLQbC",block:'[[[1,"\\n"],[41,[30,0,["showBrowseChannelsButton"]],[[[1,"      "],[8,[32,0],[[24,0,"btn no-text btn-flat c-navbar__browse-button"],[16,"title",[30,0,["browseChannelsLabel"]]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["pencil-alt"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button.js",scope:()=>[i.LinkTo,r.default],isStrictMode:!0}),u),h=(l=u).prototype,p="router",m=[n.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),c=f,l)
var h,p,m,b,g,f})),define("discourse/plugins/chat/discourse/components/chat/navbar/channel-title",["exports","@ember/routing","discourse/plugins/chat/discourse/components/channel-title","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"yAKowc1R",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[8,[32,0],[[24,0,"c-navbar__channel-title"]],[["@route","@models"],["chat.channel.info.members",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/channel-title.js",scope:()=>[t.LinkTo,i.default],isStrictMode:!0}),(0,a.default)())
e.default=s})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){super(...arguments),d(this,"chat",l,this),d(this,"chatStateManager",c,this)}closeDrawer(){this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"uK1pNWsT",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"btn-flat no-text c-navbar__close-drawer-button"]],[["@icon","@action","@title"],["times",[30,0,["closeDrawer"]],"chat.close"]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button.js",scope:()=>[r.default],isStrictMode:!0}),u),l=h((o=u).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(o.prototype,"closeDrawer",[i.action],Object.getOwnPropertyDescriptor(o.prototype,"closeDrawer"),o.prototype),o)})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"r+XOcfFj",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__close-thread-button btn-flat btn btn-icon no-text"],[16,"title",[28,[32,1],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,2],["times"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@thread"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button.js",scope:()=>[i.LinkTo,a.default,r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="site",p=[n.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),d(this,"closeButtonTitle",a.default.t("chat.thread.close"))}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"aakW19Se",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__close-threads-button btn-flat btn btn-icon no-text"],[16,"title",[30,0,["closeButtonTitle"]]]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["times"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button.js",scope:()=>[i.LinkTo,r.default],isStrictMode:!0}),u),h=(l=u).prototype,p="site",m=[n.inject],b={configurable:!0,enumerable:!0,writable:!0,initializer:null},f={},Object.keys(b).forEach((function(e){f[e]=b[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,p,e)||e}),f),g&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(g):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,p,f),f=null),c=f,l)
var h,p,m,b,g,f}))
define("discourse/plugins/chat/discourse/components/chat/navbar/full-page-button",["exports","@glimmer/component","@ember/object","@ember/runloop","@ember/service","discourse/components/d-button","discourse/lib/url","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){super(...arguments),p(this,"chat",u,this),p(this,"chatStateManager",d,this)}async openInFullPage(){this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,await new Promise((e=>(0,n.next)(e))),s.default.routeTo(this.chatStateManager.lastKnownChatURL)}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"wyScA7NH",block:'[[[1,"\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-flat no-text c-navbar__full-page-button"]],[["@icon","@title","@action"],["discourse-expand","chat.open_full_page",[30,0,["openInFullPage"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/full-page-button.js",scope:()=>[a.default],isStrictMode:!0}),h),u=m((c=h).prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"chatStateManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(c.prototype,"openInFullPage",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"openInFullPage"),c.prototype),c)})),define("discourse/plugins/chat/discourse/components/chat/navbar/index",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","discourse/helpers/concat-class","discourse/helpers/noop","discourse/plugins/chat/discourse/modifiers/chat/on-resize","discourse/plugins/chat/discourse/components/chat/navbar/actions","discourse/plugins/chat/discourse/components/chat/navbar/back-button","discourse/plugins/chat/discourse/components/chat/navbar/channel-title","discourse/plugins/chat/discourse/components/chat/navbar/title","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=class extends t.default{handleResize(e){for(let t of e){const e=t.target.clientHeight
requestAnimationFrame((()=>{document.documentElement.style.setProperty("--chat-header-expanded-offset",`${e}px`)}))}}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"6bA69P/o",block:'[[[1,"\\n"],[1,"    "],[11,0],[16,0,[28,[32,0],["c-navbar-container",[52,[30,1],"-clickable"],[52,[30,2],"-full-title"]],null]],[4,[32,1],["click",[52,[30,1],[30,1],[28,[32,2],null,null]]],null],[4,[32,3],[[30,0,["handleResize"]]],null],[12],[1,"\\n      "],[10,"nav"],[14,0,"c-navbar"],[12],[1,"\\n        "],[18,3,[[28,[32,4],null,[["BackButton","ChannelTitle","Title","Actions"],[[32,5],[32,6],[32,7],[32,8]]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@onClick","@showFullTitle","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/index.js",scope:()=>[a.default,n.on,s.default,o.default,i.hash,c.default,u.default,d.default,l.default],isStrictMode:!0}),b),g=(m=b).prototype,f="handleResize",v=[r.action],y=Object.getOwnPropertyDescriptor(m.prototype,"handleResize"),w=m.prototype,_={},Object.keys(y).forEach((function(e){_[e]=y[e]})),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=v.slice().reverse().reduce((function(e,t){return t(g,f,e)||e}),_),w&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(w):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(g,f,_),_=null),m)
var g,f,v,y,w,_})),define("discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/helpers/concat-class","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"chatStateManager",u,this),b(this,"currentUser",d,this),b(this,"modal",h,this),b(this,"site",p,this)}createChannel(){this.modal.show(s.default)}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"WsRMqeZz",block:'[[[1,"\\n"],[41,[30,0,["currentUser","staff"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["c-navbar__new-channel-button",[52,[30,0,["site","mobileView"]],"btn-flat"]],null]]],[["@action","@icon","@label"],[[30,0,["createChannel"]],"plus",[52,[30,0,["site","desktopView"]],"chat.create_channel.title"]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button.js",scope:()=>[r.default,a.default],isStrictMode:!0}),m),u=g((c=m).prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(c.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(c.prototype,"modal",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(c.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(c.prototype,"createChannel",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"createChannel"),c.prototype),c)})),define("discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","I18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"router",u,this),m(this,"modal",d,this),m(this,"chat",h,this),b(this,"buttonLabel",a.default.t("chat.channels_list_popup.browse"))}get showButtonComponent(){return"chat.direct-messages"===this.router.currentRoute.name&&this.canCreateDirectMessageChannel}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}openNewMessageModal(){this.modal.show(s.default)}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"hO5vSjgE",block:'[[[1,"\\n"],[41,[30,0,["showButtonComponent"]],[[[1,"      "],[8,[32,0],[[24,0,"btn no-text btn-flat c-navbar__new-dm-button"],[16,"title",[30,0,["buttonLabel"]]]],[["@action","@icon"],[[30,0,["openNewMessageModal"]],"plus"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button.js",scope:()=>[r.default],isStrictMode:!0}),p),u=g((c=p).prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=g(c.prototype,"modal",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(c.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g(c.prototype,"openNewMessageModal",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"openNewMessageModal"),c.prototype),c)})),define("discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/url","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){super(...arguments),h(this,"chatStateManager",c,this),h(this,"site",u,this)}async openDrawer(){this.chatStateManager.prefersDrawer(),a.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{a.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"JP3LipbZ",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__open-drawer-button btn-flat"]],[["@icon","@title","@action"],["discourse-compress","chat.close_full_page",[30,0,["openDrawer"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button.js",scope:()=>[r.default],isStrictMode:!0}),d),c=p((l=d).prototype,"chatStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"openDrawer",[i.action],Object.getOwnPropertyDescriptor(l.prototype,"openDrawer"),l.prototype),l)})),define("discourse/plugins/chat/discourse/components/chat/navbar/sub-title",["exports","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,t.createTemplateFactory)({id:"v8Ekg8XF",block:'[[[1,"\\n  "],[10,0],[14,0,"c-navbar__sub-title"],[12],[1,"\\n"],[41,[48,[30,2]],[[[1,"      "],[18,2,null],[1,"\\n"]],[]],[[[1,"      "],[1,[30,1]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],["@title","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/sub-title.js",isStrictMode:!0}),(0,n.default)())
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){super(...arguments),h(this,"currentUser",c,this),h(this,"modal",u,this)}get canChangeThreadSettings(){return!!this.args.thread&&(this.currentUser.staff||this.currentUser.id===this.args.thread.originalMessage.user.id)}openThreadSettings(){this.modal.show(a.default,{model:this.args.thread})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"YVF2WosG",block:'[[[1,"\\n"],[41,[30,0,["canChangeThreadSettings"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-flat c-navbar__thread-settings-button"]],[["@action","@icon","@title"],[[30,0,["openThreadSettings"]],"cog","chat.thread.settings"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button.js",scope:()=>[r.default],isStrictMode:!0}),d),c=p((l=d).prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"modal",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"openThreadSettings",[i.action],Object.getOwnPropertyDescriptor(l.prototype,"openThreadSettings"),l.prototype),l)})),define("discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/notification-levels","discourse/plugins/chat/discourse/components/chat-thread-tracking-dropdown","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=class extends t.default{constructor(){super(...arguments),g(this,"chatApi",p,this),g(this,"persistedNotificationLevel",m,this)}get threadNotificationLevel(){return this.membership?.notificationLevel||o.NotificationLevels.REGULAR}get membership(){return this.args.thread.currentUserMembership}async updateThreadNotificationLevel(e){let t
this.persistedNotificationLevel=!1,this.membership?(t=this.membership.notificationLevel,this.membership.notificationLevel=e):this.args.thread.currentUserMembership=c.default.create({notification_level:e,last_read_message_id:null})
try{const t=await this.chatApi.updateCurrentUserThreadNotificationsSettings(this.args.thread.channel.id,this.args.thread.id,{notificationLevel:e})
this.membership.last_read_message_id=t.membership.last_read_message_id,this.persistedNotificationLevel=!0}catch(i){this.membership.notificationLevel=t,(0,s.popupAjaxError)(i)}}},(0,d.setComponentTemplate)((0,u.createTemplateFactory)({id:"saHWpeA3",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["c-navbar__thread-tracking-dropdown",[52,[30,0,["persistedNotificationLevel"]],"-persisted"]],null]]],[["@value","@onChange"],[[30,0,["threadNotificationLevel"]],[30,0,["updateThreadNotificationLevel"]]]],null],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown.js",scope:()=>[l.default,a.default],isStrictMode:!0}),b),p=f((h=b).prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(h.prototype,"persistedNotificationLevel",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f(h.prototype,"updateThreadNotificationLevel",[n.action],Object.getOwnPropertyDescriptor(h.prototype,"updateThreadNotificationLevel"),h.prototype),h)})),define("discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse/helpers/concat-class","discourse-common/helpers/d-icon","I18n","discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),p(this,"threadsListLabel",s.default.t("chat.threads.list"))}get showThreadsListButton(){return this.args.channel?.threadingEnabled&&"chat.channel.threads"!==this.router.currentRoute.name&&"chat.channel.thread"!==this.router.currentRoute.name&&"chat.channel.thread.index"!==this.router.currentRoute.name}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"HrF2otwx",block:'[[[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"      "],[8,[32,0],[[16,"title",[30,0,["threadsListLabel"]]],[16,0,[28,[32,1],["c-navbar__threads-list-button","btn","no-text","btn-flat",[52,[30,1,["threadsManager","unreadThreadCount"]],"has-unreads"]],null]]],[["@route","@models"],["chat.channel.threads",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,2],["discourse-threads"],null]],[1,"\\n        "],[8,[32,3],null,[["@channel"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button.js",scope:()=>[i.LinkTo,r.default,a.default,o.default],isStrictMode:!0}),h),m=(u=h).prototype,b="router",g=[n.inject],f={configurable:!0,enumerable:!0,writable:!0,initializer:null},y={},Object.keys(f).forEach((function(e){y[e]=f[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=g.slice().reverse().reduce((function(e,t){return t(m,b,e)||e}),y),v&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(v):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(m,b,y),y=null),d=y,u)
var m,b,g,f,v,y})),define("discourse/plugins/chat/discourse/components/chat/navbar/title",["exports","@ember/helper","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat/navbar/sub-title","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"GXVZM7WA",block:'[[[1,"\\n  "],[10,0],[15,"title",[30,1]],[15,0,[28,[32,0],["c-navbar__title",[52,[30,2],"full-title"]],null]],[12],[1,"\\n"],[41,[48,[30,4]],[[[1,"      "],[10,1],[14,0,"c-navbar__title-text"],[12],[1,[52,[30,3],[28,[32,1],[[30,3]],null]]],[1,"\\n        "],[1,[30,1]],[13],[1,"\\n      "],[18,4,[[28,[32,2],null,[["SubTitle"],[[32,3]]]]]],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,0,"c-navbar__title-text"],[12],[1,[52,[30,3],[28,[32,1],[[30,3]],null]]],[1,[30,1]],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],["@title","@showFullTitle","@icon","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/title.js",scope:()=>[i.default,n.default,t.hash,r.default],isStrictMode:!0}),(0,o.default)())
e.default=l})),define("discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button",["exports","@glimmer/component","@ember/service","discourse/components/d-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=class extends t.default{constructor(){super(...arguments),u(this,"chat",o,this),u(this,"chatStateManager",l,this)}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"1RdBtHPu",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"btn-flat no-text c-navbar__toggle-drawer-button"]],[["@icon","@action","@title"],[[52,[30,0,["chatStateManager","isDrawerExpanded"]],"angle-double-down","angle-double-up"],[30,0,["chat","toggleDrawer"]],[52,[30,0,["chatStateManager","isDrawerExpanded"]],"chat.collapse","chat.expand"]]],null],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button.js",scope:()=>[n.default],isStrictMode:!0}),c),o=d((s=c).prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(s.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)})),define("discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/modifiers/chat/later-fn","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d){"use strict"
var h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=(0,a.inject)("chat-api"),g=class extends t.default{constructor(){super(...arguments),f(this,"chatApi",m,this),f(this,"invitationsSent",b,this)}get userIds(){return this.args.notice.data.user_ids}async sendInvitations(e){e.preventDefault()
try{await this.chatApi.invite(this.args.channel.id,this.userIds,{messageId:this.args.notice.data.messageId}),this.invitationsSent=!0}catch(t){(0,s.popupAjaxError)(t)}}},(0,d.setComponentTemplate)((0,u.createTemplateFactory)({id:"43SYY4H4",block:'[[[1,"\\n    "],[10,0],[14,0,"mention-without-membership-notice"],[12],[1,"\\n"],[41,[30,0,["invitationsSent"]],[[[1,"        "],[11,1],[24,0,"mention-without-membership-notice__invitation-sent"],[4,[32,0],[[30,1],3000],null],[12],[1,"\\n          "],[1,[28,[32,1],["check"],null]],[1,"\\n          "],[10,1],[12],[1,"\\n            "],[1,[28,[32,2],["chat.mention_warning.invitations_sent"],[["count"],[[30,0,["userIds","length"]]]]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,2],[14,0,"mention-without-membership-notice__body -without-membership"],[12],[1,"\\n          "],[10,1],[14,0,"mention-without-membership-notice__body__text"],[12],[1,[30,2,["data","text"]]],[13],[1,"\\n          "],[11,3],[24,0,"mention-without-membership-notice__body__link"],[24,6,""],[4,[32,3],["click",[30,0,["sendInvitations"]]],null],[12],[1,"\\n            "],[1,[28,[32,2],["chat.mention_warning.invite"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@clearNotice","@notice"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership.js",scope:()=>[c.default,o.default,l.default,n.on],isStrictMode:!0}),g),m=v((p=g).prototype,"chatApi",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v(p.prototype,"invitationsSent",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v(p.prototype,"sendInvitations",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"sendInvitations"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/chat/routes/browse",["exports","@glimmer/tracking","@ember/component","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/routing","@ember/runloop","@ember/service","discourse/components/d-button","discourse-common/config/environment","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/list","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-channel-card","discourse/plugins/chat/discourse/components/dc-filter-input","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v){"use strict"
var y,w,_,j,M,z
function O(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const k=["all","open","closed","archived"]
e.default=(y=(0,r.computed)("siteSettings.chat_allow_archiving_channels"),z=class extends i.default{constructor(){super(...arguments),O(this,"chatApi",_,this),O(this,"modal",j,this),O(this,"filter",M,this)}get channelsCollection(){return this.chatApi.channels({filter:this.filter,status:this.status})}get tabs(){return this.siteSettings.chat_allow_archiving_channels?k:[...k].removeObject("archived")}showChatNewMessageModal(){this.modal.show(m.default)}setFilter(e){this.filter=e.target.value,(0,h.default)(this.debouncedLoad,u.INPUT_DELAY)}debouncedLoad(){this.channelsCollection.load({limit:10})}focusFilterInput(e){(0,o.schedule)("afterRender",(()=>e?.focus()))}},(0,i.setComponentTemplate)((0,v.createTemplateFactory)({id:"qxrGEdO0",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-browse"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["BackButton"]],null,null,null],[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.browse.title"],null]]],null],[1,"\\n\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["NewChannelButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[10,0],[14,0,"chat-browse-view"],[12],[1,"\\n        "],[10,0],[14,0,"chat-browse-view__actions"],[12],[1,"\\n          "],[10,"nav"],[12],[1,"\\n            "],[10,"ul"],[14,0,"nav-pills chat-browse-view__filters"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["tabs"]]],null]],null],null,[[[1,"                "],[10,"li"],[15,0,[28,[32,2],["chat-browse-view__filter -",[30,3]],null]],[12],[1,"\\n                  "],[8,[32,3],[[16,0,[28,[32,2],["chat-browse-view__filter-link -",[30,3]],null]]],[["@route"],[[28,[32,2],["chat.browse.",[30,3]],null]]],[["default"],[[[[1,"\\n                    "],[1,[28,[32,1],[[28,[32,2],["chat.browse.filter_",[30,3]],null]],null]],[1,"\\n                  "]],[]]]]],[1,"\\n                "],[13],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[32,4],[[16,"placeholder",[28,[32,1],["chat.browse.filter_input_placeholder"],null]],[4,[32,6],[[30,0,["focusFilterInput"]]],null]],[["@filterAction","@icons","@containerClass"],[[30,0,["setFilter"]],[28,[32,5],null,[["right"],["search"]]],"filter-input"]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-browse-view__content_wrapper"],[12],[1,"\\n          "],[10,0],[14,0,"chat-browse-view__content"],[12],[1,"\\n            "],[8,[32,7],[[24,0,"chat-browse-view__cards"]],[["@collection"],[[30,0,["channelsCollection"]]]],[["default"],[[[[1,"\\n              "],[8,[30,4,["Item"]],null,null,[["default"],[[[[1,"\\n                "],[8,[32,8],null,[["@channel"],[[30,5]]],null],[1,"\\n              "]],[5]]]]],[1,"\\n\\n              "],[8,[30,4,["EmptyState"]],null,null,[["default"],[[[[1,"\\n                "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n                  "],[1,[28,[32,1],["chat.empty_state.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n                  "],[10,2],[12],[1,[28,[32,1],["chat.empty_state.direct_message"],null]],[13],[1,"\\n                  "],[8,[32,9],null,[["@action","@label"],[[30,0,["showChatNewMessageModal"]],"chat.empty_state.direct_message_cta"]],null],[1,"\\n                "],[13],[1,"\\n              "]],[]]]]],[1,"\\n            "]],[4]]]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","a","tab","list","channel"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/browse.js",scope:()=>[b.default,d.default,n.concat,s.LinkTo,f.default,n.hash,a.default,p.default,g.default,c.default],isStrictMode:!0}),z),_=C((w=z).prototype,"chatApi",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=C(w.prototype,"modal",[l.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=C(w.prototype,"filter",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C(w.prototype,"channelsCollection",[t.cached],Object.getOwnPropertyDescriptor(w.prototype,"channelsCollection"),w.prototype),C(w.prototype,"tabs",[y],Object.getOwnPropertyDescriptor(w.prototype,"tabs"),w.prototype),C(w.prototype,"showChatNewMessageModal",[r.action],Object.getOwnPropertyDescriptor(w.prototype,"showChatNewMessageModal"),w.prototype),C(w.prototype,"setFilter",[r.action],Object.getOwnPropertyDescriptor(w.prototype,"setFilter"),w.prototype),C(w.prototype,"debouncedLoad",[r.action],Object.getOwnPropertyDescriptor(w.prototype,"debouncedLoad"),w.prototype),C(w.prototype,"focusFilterInput",[r.action],Object.getOwnPropertyDescriptor(w.prototype,"focusFilterInput"),w.prototype),w)})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info-members",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","ember-modifier","discourse/lib/is-element-in-viewport","discourse/lib/url","discourse/modifiers/auto-focus","discourse-common/config/environment","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat-user-info","discourse/plugins/chat/discourse/components/dc-filter-input","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j){"use strict"
var M,z,O,C,k,S,P,T,E
function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function D(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function A(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(E=class extends t.default{constructor(){super(...arguments),x(this,"appEvents",z,this),x(this,"chatApi",O,this),x(this,"modal",C,this),x(this,"loadingSlider",k,this),x(this,"site",S,this),x(this,"filter",P,this),x(this,"showAddMembers",T,this),D(this,"addMemberLabel",g.default.t("chat.members_view.add_member")),D(this,"filterPlaceholder",g.default.t("chat.members_view.filter_placeholder")),D(this,"noMembershipsFoundLabel",g.default.t("chat.channel.no_memberships_found")),D(this,"noMembershipsLabel",g.default.t("chat.channel.no_memberships")),D(this,"onEnter",(0,l.modifier)(((e,t)=>{let[i]=t
const n=e=>{"Enter"===e.key&&i(e)}
return e.addEventListener("keydown",n),()=>{e.removeEventListener("keydown",n)}}))),D(this,"fill",(0,l.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,c.default)(e)&&this.load()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()})))),D(this,"loadMore",(0,l.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.load),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))}get noResults(){return this.members.fetchedOnce&&!this.members.loading}get members(){const e={}
return this.filter?.length&&(e.username=this.filter),this.chatApi.listChannelMemberships(this.args.channel.id,e)}load(){(0,b.default)(this,this.debouncedLoad,h.INPUT_DELAY)}mutFilter(e){this.filter=e.target.value,this.load()}addMember(){this.showAddMembers=!0}hideAddMember(){this.showAddMembers=!1}openMemberCard(e,t){t.preventDefault(),u.default.routeTo((0,u.userPath)(e.username_lower))}async debouncedLoad(){this.loadingSlider.transitionStarted(),await this.members.load({limit:20}),this.loadingSlider.transitionEnded()}get addMembersMode(){return v.MODES.add_members}},(0,j.setComponentTemplate)((0,_.createTemplateFactory)({id:"eZBRWn4a",block:'[[[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-back-button"]],[["@route","@model"],["chat.channel.info.settings",[30,1]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["chevron-left"],null]],[1,"\\n        "],[1,[28,[32,2],["chat.members_view.back_to_settings"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[41,[30,0,["showAddMembers"]],[[[1,"      "],[8,[32,3],null,[["@mode","@channel","@onClose","@onCancel"],[[30,0,["addMembersMode"]],[30,1],[30,0,["hideAddMember"]],[30,0,["hideAddMember"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"c-channel-members"],[12],[1,"\\n        "],[8,[32,4],[[16,"placeholder",[30,0,["filterPlaceholder"]]],[4,[32,6],null,null]],[["@filterAction","@icons","@containerClass"],[[30,0,["mutFilter"]],[28,[32,5],null,[["right"],["search"]]],"c-channel-members__filter"]],null],[1,"\\n\\n        "],[11,"ul"],[24,0,"c-channel-members__list"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[41,[30,1,["chatable","group"]],[[[1,"            "],[11,"li"],[24,0,"c-channel-members__list-item -add-member"],[24,"role","button"],[24,"tabindex","0"],[4,[32,7],["click",[30,0,["addMember"]]],null],[4,[30,0,["onEnter"]],[[30,0,["addMember"]]],null],[12],[1,"\\n              "],[1,[28,[32,1],["plus"],null]],[1,"\\n              "],[10,1],[12],[1,[30,0,["addMemberLabel"]]],[13],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[42,[28,[31,2],[[28,[31,2],[[30,0,["members"]]],null]],null],null,[[[1,"            "],[11,"li"],[24,0,"c-channel-members__list-item -member"],[24,"tabindex","0"],[4,[32,7],["click",[28,[32,8],[[30,0,["openMemberCard"]],[30,2,["user"]]],null]],null],[4,[30,0,["onEnter"]],[[28,[32,8],[[30,0,["openMemberCard"]],[30,2,["user"]]],null]],null],[12],[1,"\\n              "],[8,[32,9],null,[["@user","@avatarSize","@interactive"],[[30,2,["user"]],"tiny",false]],null],[1,"\\n            "],[13],[1,"\\n"]],[2]],[[[41,[30,0,["noResults"]],[[[1,"              "],[10,"li"],[14,0,"c-channel-members__list-item -no-results alert alert-info"],[12],[1,"\\n                "],[1,[30,0,["noMembershipsFoundLabel"]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"        "],[13],[1,"\\n\\n        "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n          "],[10,"br"],[12],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]]],[1,"  "]],["@channel","membership"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info-members.js",scope:()=>[s.LinkTo,p.default,m.default,f.default,w.default,n.hash,d.default,r.on,n.fn,y.default],isStrictMode:!0}),E),z=A((M=E).prototype,"appEvents",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=A(M.prototype,"chatApi",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=A(M.prototype,"modal",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=A(M.prototype,"loadingSlider",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=A(M.prototype,"site",[o.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=A(M.prototype,"filter",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),T=A(M.prototype,"showAddMembers",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A(M.prototype,"members",[i.cached],Object.getOwnPropertyDescriptor(M.prototype,"members"),M.prototype),A(M.prototype,"load",[a.action],Object.getOwnPropertyDescriptor(M.prototype,"load"),M.prototype),A(M.prototype,"mutFilter",[a.action],Object.getOwnPropertyDescriptor(M.prototype,"mutFilter"),M.prototype),A(M.prototype,"addMember",[a.action],Object.getOwnPropertyDescriptor(M.prototype,"addMember"),M.prototype),A(M.prototype,"hideAddMember",[a.action],Object.getOwnPropertyDescriptor(M.prototype,"hideAddMember"),M.prototype),A(M.prototype,"openMemberCard",[a.action],Object.getOwnPropertyDescriptor(M.prototype,"openMemberCard"),M.prototype),M)})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info-settings",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","discourse/components/d-button","discourse/components/d-toggle-switch","discourse/helpers/category-badge","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-i18n","select-kit/components/combo-box","discourse/plugins/chat/discourse/components/chat/form","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O){"use strict"
var C,k,S,P,T,E,x,D,A,N,I,L
function U(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function R(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function F(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const B=[{name:m.default.t("chat.notification_levels.never"),value:"never"},{name:m.default.t("chat.notification_levels.mention"),value:"mention"},{name:m.default.t("chat.notification_levels.always"),value:"always"}]
e.default=(L=class extends t.default{constructor(){super(...arguments),U(this,"chatApi",k,this),U(this,"chatGuardian",S,this),U(this,"chatChannelsManager",P,this),U(this,"currentUser",T,this),U(this,"siteSettings",E,this),U(this,"dialog",x,this),U(this,"modal",D,this),U(this,"site",A,this),U(this,"toasts",N,this),U(this,"router",I,this),R(this,"notificationLevels",B),R(this,"settingsSectionTitle",m.default.t("chat.settings.settings_title")),R(this,"channelInfoSectionTitle",m.default.t("chat.settings.info_title")),R(this,"categoryLabel",m.default.t("chat.settings.category_label")),R(this,"historyLabel",m.default.t("chat.settings.history_label")),R(this,"adminSectionTitle",m.default.t("chat.settings.admin_title")),R(this,"membersLabel",m.default.t("chat.channel_info.tabs.members")),R(this,"descriptionSectionTitle",m.default.t("chat.about_view.description")),R(this,"titleSectionTitle",m.default.t("chat.about_view.title")),R(this,"descriptionPlaceholder",m.default.t("chat.channel_edit_description_modal.description")),R(this,"toggleThreadingLabel",m.default.t("chat.settings.channel_threading_label")),R(this,"toggleThreadingDescription",m.default.t("chat.settings.channel_threading_description")),R(this,"muteSectionLabel",m.default.t("chat.settings.mute")),R(this,"channelWideMentionsLabel",m.default.t("chat.settings.channel_wide_mentions_label")),R(this,"autoJoinLabel",m.default.t("chat.settings.auto_join_users_label")),R(this,"desktopNotificationsLevelLabel",m.default.t("chat.settings.desktop_notification_level")),R(this,"mobileNotificationsLevelLabel",m.default.t("chat.settings.mobile_notification_level"))}get canEditChannel(){return!(!this.args.channel.isCategoryChannel||!this.chatGuardian.canEditChatChannel())||!(!this.args.channel.isDirectMessageChannel||!this.args.channel.chatable.group)}get shouldRenderDescriptionSection(){return this.args.channel.isCategoryChannel}get shouldRenderStatusSection(){return this.args.channel.isCategoryChannel}get shouldRenderArchiveRow(){return this.chatGuardian.canArchiveChannel(this.args.channel)}get toggleChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get toggleThreadingAvailable(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get channelWideMentionsDescription(){return m.default.t("chat.settings.channel_wide_mentions_description",{channel:this.args.channel.title})}get isChannelMuted(){return this.args.channel.currentUserMembership.muted}get shouldRenderChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel}get shouldRenderDesktopNotificationsLevelSection(){return!this.isChannelMuted}get shouldRenderMobileNotificationsLevelSection(){return!this.isChannelMuted}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0&&this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get shouldRenderAdminSection(){return this.canEditChannel&&(this.toggleChannelWideMentionsAvailable||this.args.channel.isCategoryChannel)}async onToggleChannelWideMentions(){const e=!this.args.channel.allowChannelWideMentions
if(this.args.channel.allowChannelWideMentions!==e)try{this.args.channel.allowChannelWideMentions=e
const t=await this._updateChannelProperty(this.args.channel,"allow_channel_wide_mentions",e)
this.args.channel.allowChannelWideMentions=t.channel.allow_channel_wide_mentions}catch(t){(0,d.popupAjaxError)(t)}}async onToggleAutoJoinUsers(){return this.args.channel.autoJoinUsers?await this.onDisableAutoJoinUsers():await this.onEnableAutoJoinUsers()}async onDisableAutoJoinUsers(){if(!1!==this.args.channel.autoJoinUsers)try{this.args.channel.autoJoinUsers=!1
const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!1)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,d.popupAjaxError)(e)}}onEnableAutoJoinUsers(){if(!0!==this.args.channel.autoJoinUsers)return this.dialog.confirm({message:m.default.t("chat.settings.auto_join_users_warning",{category:this.args.channel.chatable.name}),didConfirm:async()=>{try{const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!0)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,d.popupAjaxError)(e)}}})}onToggleMuted(){const e=!this.args.channel.currentUserMembership.muted
this.saveNotificationSettings("muted","muted",e)}async saveNotificationSettings(e,t,i){if(this.args.channel.currentUserMembership[e]===i)return
this.args.channel.currentUserMembership[e]=i
const n={}
n[t]=i
try{const i=await this.chatApi.updateCurrentUserChannelNotificationsSettings(this.args.channel.id,n)
this.args.channel.currentUserMembership[e]=i.membership[t],this.toasts.success({data:{message:m.default.t("saved")}})}catch(r){(0,d.popupAjaxError)(r)}}async _updateChannelProperty(e,t,i){try{const n=await this.chatApi.updateChannel(e.id,{[t]:i})
return this.toasts.success({data:{message:m.default.t("saved")}}),n}catch(n){(0,d.popupAjaxError)(n)}}async onToggleThreadingEnabled(e){try{this.args.channel.threadingEnabled=!e
const t=await this._updateChannelProperty(this.args.channel,"threading_enabled",!e)
this.args.channel.threadingEnabled=t.channel.threading_enabled}catch(t){(0,d.popupAjaxError)(t)}}onToggleChannelState(){return this.modal.show(_.default,{model:this.args.channel})}onArchiveChannel(){return this.modal.show(f.default,{model:{channel:this.args.channel}})}onDeleteChannel(){return this.modal.show(v.default,{model:{channel:this.args.channel}})}onEditChannelTitle(){return this.modal.show(w.default,{model:this.args.channel})}onLeaveChannel(e){return this.chatChannelsManager.remove(e),this.router.transitionTo("chat")}onEditChannelDescription(){return this.modal.show(y.default,{model:this.args.channel})}},(0,O.setComponentTemplate)((0,z.createTemplateFactory)({id:"shgGsOXv",block:'[[[1,"\\n    "],[10,0],[14,0,"c-channel-settings"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["titleSectionTitle"]]]],[["default"],[[[[1,"\\n          "],[8,[30,2,["row"]],null,null,[["default","action"],[[[[1,"\\n              "],[10,0],[14,0,"c-channel-settings__name"],[12],[1,"\\n                "],[1,[28,[32,1],[[30,3,["title"]]],null]],[1,"\\n              "],[13],[1,"\\n\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"                "],[10,0],[14,0,"c-channel-settings__slug"],[12],[1,"\\n                  "],[8,[32,2],null,[["@route","@models"],["chat.channel",[30,3,["routeModels"]]]],[["default"],[[[[1,"\\n                    /chat/c/"],[1,[30,3,["slug"]]],[1,"/"],[1,[30,3,["id"]]],[1,"\\n                  "]],[]]]]],[1,"\\n                "],[13],[1,"\\n"]],[]],null],[1,"            "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                "],[8,[32,3],[[24,0,"edit-name-slug-btn btn-flat"]],[["@label","@action"],["chat.channel_settings.edit",[30,0,["onEditChannelTitle"]]]],null],[1,"\\n"]],[]],null],[1,"            "]],[]]]]],[1,"\\n        "]],[2]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderDescriptionSection"]],[[[1,"          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["descriptionSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,4,["row"]],null,null,[["default","action"],[[[[1,"\\n"],[41,[30,3,["description","length"]],[[[1,"                  "],[1,[30,3,["description"]]],[1,"\\n"]],[]],[[[1,"                  "],[1,[30,0,["descriptionPlaceholder"]]],[1,"\\n"]],[]]],[1,"              "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                  "],[8,[32,3],[[24,0,"edit-description-btn btn-flat"]],[["@label","@action"],[[52,[30,3,["description","length"]],"chat.channel_settings.edit","chat.channel_settings.add"],[30,0,["onEditChannelDescription"]]]],null],[1,"\\n"]],[]],null],[1,"              "]],[]]]]],[1,"\\n          "]],[4]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"          "],[8,[30,1,["section"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,5,["row"]],null,[["@label","@route","@routeModels"],[[30,0,["membersLabel"]],"chat.channel.info.members",[30,3,["routeModels"]]]],null],[1,"\\n          "]],[5]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["settingsSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["muteSectionLabel"]]]],[["action"],[[[[1,"\\n                "],[8,[32,4],[[24,0,"c-channel-settings__mute-switch"],[4,[32,5],["click",[30,0,["onToggleMuted"]]],null]],[["@state"],[[30,3,["currentUserMembership","muted"]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderDesktopNotificationsLevelSection"]],[[[1,"              "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["desktopNotificationsLevelLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,6],[[24,0,"c-channel-settings__selector c-channel-settings__desktop-notifications-selector"]],[["@content","@value","@valueProperty","@onChange"],[[30,0,["notificationLevels"]],[30,3,["currentUserMembership","desktopNotificationLevel"]],"value",[28,[32,7],[[30,0,["saveNotificationSettings"]],"desktopNotificationLevel","desktop_notification_level"],null]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderMobileNotificationsLevelSection"]],[[[1,"              "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["mobileNotificationsLevelLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,6],[[24,0,"c-channel-settings__selector c-channel-settings__mobile-notifications-selector"]],[["@content","@value","@valueProperty","@onChange"],[[30,0,["notificationLevels"]],[30,3,["currentUserMembership","mobileNotificationLevel"]],"value",[28,[32,7],[[30,0,["saveNotificationSettings"]],"mobileNotificationLevel","mobile_notification_level"],null]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"          "]],[6]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["channelInfoSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"            "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["categoryLabel"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,8],[[30,3,["chatable"]]],[["link","allowUncategorized"],[true,true]]]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["historyLabel"]]]],[["default"],[[[[1,"\\n            "],[8,[32,9],null,[["@channel","@type"],[[30,3],"short"]],null],[1,"\\n          "]],[]]]]],[1,"\\n        "]],[7]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderAdminSection"]],[[[1,"          "],[8,[30,1,["section"]],[[24,"data-section","admin"]],[["@title"],[[30,0,["adminSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["autoJoinLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"c-channel-settings__auto-join-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleAutoJoinUsers"]],[30,3,["autoJoinUsers"]]],null]],null]],[["@state"],[[30,3,["autoJoinUsers"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleChannelWideMentionsAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["channelWideMentionsLabel"]]]],[["action","description"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"c-channel-settings__channel-wide-mentions"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleChannelWideMentions"]],[30,3,["allowChannelWideMentions"]]],null]],null]],[["@state"],[[30,3,["allowChannelWideMentions"]]]],null],[1,"\\n                "]],[]],[[[1,"\\n                  "],[1,[30,0,["channelWideMentionsDescription"]]],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleThreadingAvailable"]],[[[1,"              "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["toggleThreadingLabel"]]]],[["action","description"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"c-channel-settings__threading-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleThreadingEnabled"]],[30,3,["threadingEnabled"]]],null]],null]],[["@state"],[[30,3,["threadingEnabled"]]]],null],[1,"\\n                "]],[]],[[[1,"\\n                  "],[1,[30,0,["toggleThreadingDescription"]]],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderStatusSection"]],[[[41,[30,0,["shouldRenderArchiveRow"]],[[[1,"                "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                    "],[8,[32,3],[[24,0,"archive-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onArchiveChannel"]],"chat.channel_settings.archive_channel","archive"]],null],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n              "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"                    "],[8,[32,3],[[24,0,"close-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.close_channel","lock"]],null],[1,"\\n"]],[]],[[[1,"                    "],[8,[32,3],[[24,0,"open-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.open_channel","unlock"]],null],[1,"\\n"]],[]]],[1,"                "]],[]]]]],[1,"\\n\\n              "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                  "],[8,[32,3],[[24,0,"delete-btn chat-form__btn btn-flat"]],[["@action","@label","@icon"],[[30,0,["onDeleteChannel"]],"chat.channel_settings.delete_channel","trash-alt"]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "]],[8]]]]],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[30,1,["section"]],[[24,0,"--leave-channel"]],null,[["default"],[[[[1,"\\n          "],[8,[30,9,["row"]],null,null,[["action"],[[[[1,"\\n              "],[8,[32,10],null,[["@channel","@onLeave","@options"],[[30,3],[30,0,["onLeaveChannel"]],[28,[32,11],null,[["joinClass","leaveClass","joinIcon","leaveIcon"],["btn-primary","btn-danger","sign-in-alt","sign-out-alt"]]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"],[41,[30,3,["chatable","group"]],[[[1,"            "],[10,0],[14,0,"c-channel-settings__leave-info"],[12],[1,"\\n              "],[1,[28,[32,12],["exclamation-triangle"],null]],[1,"\\n              "],[1,[28,[32,13],["chat.channel_settings.leave_groupchat_info"],null]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "]],[9]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["form","section","@channel","section","section","section","section","section","section"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info-settings.js",scope:()=>[g.default,u.default,a.LinkTo,o.default,l.default,n.on,b.default,i.fn,c.default,j.default,M.default,i.hash,h.default,p.default],isStrictMode:!0}),L),k=F((C=L).prototype,"chatApi",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=F(C.prototype,"chatGuardian",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=F(C.prototype,"chatChannelsManager",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=F(C.prototype,"currentUser",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=F(C.prototype,"siteSettings",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=F(C.prototype,"dialog",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=F(C.prototype,"modal",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=F(C.prototype,"site",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=F(C.prototype,"toasts",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=F(C.prototype,"router",[s.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F(C.prototype,"onToggleChannelWideMentions",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onToggleChannelWideMentions"),C.prototype),F(C.prototype,"onToggleAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onToggleAutoJoinUsers"),C.prototype),F(C.prototype,"onDisableAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onDisableAutoJoinUsers"),C.prototype),F(C.prototype,"onEnableAutoJoinUsers",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onEnableAutoJoinUsers"),C.prototype),F(C.prototype,"onToggleMuted",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onToggleMuted"),C.prototype),F(C.prototype,"saveNotificationSettings",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"saveNotificationSettings"),C.prototype),F(C.prototype,"_updateChannelProperty",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"_updateChannelProperty"),C.prototype),F(C.prototype,"onToggleThreadingEnabled",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onToggleThreadingEnabled"),C.prototype),F(C.prototype,"onToggleChannelState",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onToggleChannelState"),C.prototype),F(C.prototype,"onArchiveChannel",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onArchiveChannel"),C.prototype),F(C.prototype,"onDeleteChannel",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onDeleteChannel"),C.prototype),F(C.prototype,"onEditChannelTitle",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onEditChannelTitle"),C.prototype),F(C.prototype,"onLeaveChannel",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onLeaveChannel"),C.prototype),F(C.prototype,"onEditChannelDescription",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"onEditChannelDescription"),C.prototype),C)})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info",["exports","@glimmer/component","@ember/object","@ember/routing","@ember/service","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-channel-status","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g
function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function v(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(g=class extends t.default{constructor(){super(...arguments),f(this,"chatChannelInfoRouteOriginManager",h,this),f(this,"site",p,this),f(this,"modal",m,this),f(this,"chatGuardian",b,this),v(this,"membersLabel",a.default.t("chat.channel_info.tabs.members")),v(this,"settingsLabel",a.default.t("chat.channel_info.tabs.settings")),v(this,"backToChannelLabel",a.default.t("chat.channel_info.back_to_all_channels")),v(this,"backToAllChannelsLabel",a.default.t("chat.channel_info.back_to_channel"))}get showTabs(){return this.site.desktopView&&this.args.channel.isOpen}get canEditChannel(){return this.chatGuardian.canEditChatChannel()&&(this.args.channel.isCategoryChannel||this.args.channel.isDirectMessageChannel&&this.args.channel.chatable.group)}editChannelTitle(){return this.modal.show(s.default,{model:this.args.channel})}},(0,u.setComponentTemplate)((0,c.createTemplateFactory)({id:"qny2Z+gg",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-channel-info"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["chatChannelInfoRouteOriginManager","isBrowse"]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route","@title"],["chat.browse",[30,0,["backToAllChannelsLabel"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route","@routeModels","@title"],["chat.channel",[30,2,["routeModels"]],[30,0,["backToChannelLabel"]]]],null],[1,"\\n"]],[]]],[1,"        "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,2]]],null],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,1],null,[["@channel"],[[30,2]]],null],[1,"\\n\\n      "],[10,0],[14,0,"c-channel-info"],[12],[1,"\\n"],[41,[30,0,["showTabs"]],[[[1,"          "],[10,"nav"],[14,0,"c-channel-info__nav"],[12],[1,"\\n            "],[10,"ul"],[14,0,"nav nav-pills"],[12],[1,"\\n              "],[10,"li"],[12],[1,"\\n                "],[8,[32,2],null,[["@route","@model","@replace"],["chat.channel.info.settings",[30,2],true]],[["default"],[[[[1,"\\n                  "],[1,[30,0,["settingsLabel"]]],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,"li"],[12],[1,"\\n                "],[8,[32,2],null,[["@route","@model","@replace"],["chat.channel.info.members",[30,2],true]],[["default"],[[[[1,"\\n                  "],[1,[30,0,["membersLabel"]]],[1,"\\n"],[41,[30,2,["isCategoryChannel"]],[[[1,"                    "],[10,1],[14,0,"c-channel-info__member-count"],[12],[1,"("],[1,[30,2,["membershipsCount"]]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[46,[28,[31,2],null,null],null,null,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","@channel"],false,["if","component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info.js",scope:()=>[o.default,l.default,n.LinkTo],isStrictMode:!0}),g),h=y((d=g).prototype,"chatChannelInfoRouteOriginManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=y(d.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=y(d.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=y(d.prototype,"chatGuardian",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(d.prototype,"editChannelTitle",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"editChannelTitle"),d.prototype),d)})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","discourse/plugins/chat/discourse/components/chat/thread/header","discourse/plugins/chat/discourse/components/chat-thread","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="showfullTitle",n=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}setFullTitle(e){this.showfullTitle=e}},(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"JiE1xX8c",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-channel-thread"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[28,[32,0],[[30,1]],null]],null]],null],null,[[[1,"        "],[8,[32,1],null,[["@thread","@showFullTitle"],[[30,2],[30,0,["showfullTitle"]]]],null],[1,"\\n\\n        "],[8,[32,2],null,[["@thread","@targetMessageId","@includeHeader","@setFullTitle"],[[30,2],[30,3],true,[30,0,["setFullTitle"]]]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n  "]],["@thread","thread","@targetMessageId"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-thread.js",scope:()=>[n.array,a.default,s.default],isStrictMode:!0}),d),u=h((c=d).prototype,"showfullTitle",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h(c.prototype,"setFullTitle",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"setFullTitle"),c.prototype),c)})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-threads",["exports","discourse/plugins/chat/discourse/components/chat/thread-list/header","discourse/plugins/chat/discourse/components/chat-thread-list","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,r.setComponentTemplate)((0,n.createTemplateFactory)({id:"W8Zf9bGo",block:'[[[1,"\\n  "],[10,0],[14,0,"c-routes-channel-threads"],[12],[1,"\\n    "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n    "],[8,[32,1],null,[["@channel","@includeHeader"],[[30,1],true]],null],[1,"\\n  "],[13],[1,"\\n"]],["@channel"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-threads.js",scope:()=>[t.default,i.default],isStrictMode:!0}),(0,a.default)())
e.default=s})),define("discourse/plugins/chat/discourse/components/chat/routes/channel",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-side-panel","discourse/plugins/chat/discourse/components/full-page-chat","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get getChannelsRoute(){return this.args.channel.isDirectMessageChannel?"chat.direct-messages":"chat.channels"}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"1ezSWffb",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-channel"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route"],[[30,0,["getChannelsRoute"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,2]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,3,["OpenDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,3,["ThreadsListButton"]],null,[["@channel"],[[30,2]]],null],[1,"\\n        "]],[3]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,1],null,[["@channel","@targetMessageId"],[[30,2],[30,4]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,2],null,null,[["default"],[[[[1,"\\n      "],[46,[28,[31,2],null,null],null,null,null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["navbar","@channel","action","@targetMessageId"],false,["if","component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel.js",scope:()=>[n.default,a.default,r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="site",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat/routes/channels",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-public","discourse/plugins/chat/discourse/components/chat/navbar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"cVTVDHby",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-channels"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.chat_channels"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["BrowseChannelsButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channels.js",scope:()=>[a.default,n.default,r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="site",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat/routes/direct-messages",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-direct","discourse/plugins/chat/discourse/components/chat/navbar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"SSlqXZxM",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-direct-messages"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.direct_messages.title"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["NewDirectMessageButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/direct-messages.js",scope:()=>[a.default,n.default,r.default],isStrictMode:!0}),u),d=(l=u).prototype,h="site",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat/routes/threads",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/user-threads","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="site",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,o.setComponentTemplate)((0,s.createTemplateFactory)({id:"uaqzOm1E",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes-threads"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.my_threads.title"],null]]],null],[1,"\\n\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["OpenDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/threads.js",scope:()=>[r.default,n.default,a.default],isStrictMode:!0}),u),d=(l=u).prototype,h="site",p=[i.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),c=g,l)
var d,h,p,m,b,g})),define("discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow",["exports","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"pDQSNCUh",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-scroll-to-bottom"],[12],[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["btn-flat","chat-scroll-to-bottom__button",[52,[30,1],"visible"]],null]]],[["@action"],[[30,2]]],[["default"],[[[[1,"\\n      "],[10,1],[14,0,"chat-scroll-to-bottom__arrow"],[12],[1,"\\n        "],[1,[28,[32,2],["arrow-down"],null]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"]],["@isVisible","@onScrollToBottom"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow.js",scope:()=>[t.default,i.default,n.default],isStrictMode:!0}),(0,s.default)())
e.default=o})),define("discourse/plugins/chat/discourse/components/chat/selection-manager",["exports","@glimmer/component","@ember/application","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","truth-helpers/helpers/not","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v,y,w,_,j,M,z
function O(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(b=(0,r.inject)("composer"),g=(0,r.inject)("chat-api"),z=class extends t.default{constructor(){super(...arguments),O(this,"topicComposer",v,this),O(this,"router",y,this),O(this,"modal",w,this),O(this,"site",_,this),O(this,"toasts",j,this),O(this,"api",M,this)}get enableMove(){return this.args.enableMove??!1}get anyMessagesSelected(){return this.args.pane.selectedMessageIds.length>0}async generateQuote(){const{markdown:e}=await this.api.generateQuote(this.args.pane.channel.id,this.args.pane.selectedMessageIds)
return new Blob([e],{type:"text/plain"})}openMoveMessageModal(){this.modal.show(h.default,{model:{sourceChannel:this.args.pane.channel,selectedMessageIds:this.args.pane.selectedMessageIds}})}async quoteMessages(){let e
try{const t=await this.generateQuote()
e=await t.text()}catch(n){(0,s.popupAjaxError)(n)}const t={}
if(this.args.pane.channel.isCategoryChannel&&(t.categoryId=this.args.pane.channel.chatableId),this.site.mobileView)this.args.pane.channel.chatableUrl&&this.router.transitionTo(this.args.pane.channel.chatableUrl),await this.topicComposer.focusComposer({fallbackToNewTopic:!0,insertText:e,openOpts:t})
else{const n=(0,i.getOwner)(this).lookup("controller:topic")
await this.topicComposer.focusComposer({fallbackToNewTopic:!0,topic:n?.model,insertText:e,openOpts:t})}}async copyMessages(){try{(0,l.isTesting)()||(await(0,o.clipboardCopyAsync)(this.generateQuote),this.toasts.success({duration:3e3,data:{message:u.default.t("chat.quote.copy_success")}}))}catch(e){(0,s.popupAjaxError)(e)}}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"pwb+T3M4",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-selection-management"],[15,"data-last-copy-successful",[30,0,["lastCopySuccessful"]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-selection-management__buttons"],[12],[1,"\\n        "],[8,[32,0],[[24,1,"chat-quote-btn"]],[["@icon","@label","@disabled","@action"],["quote-left","chat.selection.quote_selection",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["quoteMessages"]]]],null],[1,"\\n\\n        "],[8,[32,0],[[24,1,"chat-copy-btn"]],[["@icon","@label","@disabled","@action"],["copy","chat.selection.copy",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["copyMessages"]]]],null],[1,"\\n\\n"],[41,[30,0,["enableMove"]],[[[1,"          "],[8,[32,0],[[24,1,"chat-move-to-channel-btn"]],[["@icon","@label","@disabled","@action"],["sign-out-alt","chat.selection.move_selection_to_channel",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["openMoveMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,0],[[24,1,"chat-cancel-selection-btn"],[24,0,"btn-secondary cancel-btn"]],[["@icon","@label","@action"],["times","chat.selection.cancel",[30,1,["cancelSelecting"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@pane"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/selection-manager.js",scope:()=>[a.default,d.default],isStrictMode:!0}),z),v=C((f=z).prototype,"topicComposer",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=C(f.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=C(f.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=C(f.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=C(f.prototype,"toasts",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=C(f.prototype,"api",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C(f.prototype,"generateQuote",[c.bind],Object.getOwnPropertyDescriptor(f.prototype,"generateQuote"),f.prototype),C(f.prototype,"openMoveMessageModal",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"openMoveMessageModal"),f.prototype),C(f.prototype,"quoteMessages",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"quoteMessages"),f.prototype),C(f.prototype,"copyMessages",[n.action],Object.getOwnPropertyDescriptor(f.prototype,"copyMessages"),f.prototype),f)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/header",["exports","@glimmer/component","@ember/service","@ember/template","discourse/helpers/replace-emoji","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=class extends t.default{constructor(){super(...arguments),m(this,"router",d,this),m(this,"site",h,this),b(this,"threadListTitle",s.default.t("chat.threads.list"))}get title(){let e=(0,r.default)(this.threadListTitle)
return this.site.mobileView&&(e+=" - "+(0,r.default)(this.args.channel.title)),(0,n.htmlSafe)(e)}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"AB7Sztyh",block:'[[[1,"\\n    "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[8,[30,1,["BackButton"]],null,[["@route","@routeModels","@title"],["chat.channel",[30,2,["routeModels"]],[28,[32,1],["chat.return_to_channel"],null]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[30,0,["title"]],"discourse-threads"]],null],[1,"\\n\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,3,["CloseThreadsButton"]],null,[["@channel"],[[30,2]]],null],[1,"\\n      "]],[3]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n  "]],["navbar","@channel","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread-list/header.js",scope:()=>[o.default,a.default],isStrictMode:!0}),p),d=g((u=p).prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/helpers/concat-class","discourse/helpers/format-date","discourse/helpers/replace-emoji","discourse-common/helpers/i18n","truth-helpers/helpers/gt","discourse/plugins/chat/discourse/components/thread-unread-indicator","discourse/plugins/chat/discourse/components/chat-thread-participants","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b){"use strict"
var g,f,v
function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(v=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=f)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openThread(e){this.router.transitionTo("chat.channel.thread",...e.routeModels)}},(0,b.setComponentTemplate)((0,m.createTemplateFactory)({id:"yeNG3yy4",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-thread-list-item",[52,[28,[32,1],[[30,1,["tracking","unreadCount"]],0],null],"-is-unread"]],null]],[16,"data-thread-id",[30,1,["id"]]],[17,2],[12],[1,"\\n      "],[10,0],[14,0,"chat-thread-list-item__main"],[12],[1,"\\n        "],[11,0],[16,"title",[28,[32,2],["chat.thread.view_thread"],null]],[24,"role","button"],[24,0,"chat-thread-list-item__open-button"],[4,[32,3],["click",[28,[32,4],[[30,0,["openThread"]],[30,1]],null]],[["passive"],[true]]],[12],[1,"\\n          "],[10,0],[14,0,"chat-thread-list-item__header"],[12],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__title"],[12],[1,"\\n"],[41,[30,1,["title"]],[[[1,"                "],[1,[28,[32,5],[[30,1,["title"]]],null]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[32,5],[[30,1,["originalMessage","excerpt"]]],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__unread-indicator"],[12],[1,"\\n              "],[8,[32,6],null,[["@thread"],[[30,1]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"chat-thread-list-item__metadata"],[12],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__members"],[12],[1,"\\n              "],[8,[32,7],null,[["@user","@showPresence","@interactive"],[[30,1,["originalMessage","user"]],false,false]],null],[1,"\\n              "],[8,[32,8],[[24,0,"chat-thread-list-item__participants"]],[["@thread","@includeOriginalMessageUser"],[[30,1],false]],null],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[14,0,"chat-thread-list-item__last-reply-timestamp"],[12],[1,"\\n"],[41,[30,1,["preview","lastReplyCreatedAt"]],[[[1,"                "],[1,[28,[32,9],[[30,1,["preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@thread","&attrs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread-list/item.js",scope:()=>[s.default,u.default,c.default,n.on,i.fn,l.default,d.default,p.default,h.default,o.default],isStrictMode:!0}),v),f=y((g=v).prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(g.prototype,"openThread",[r.action],Object.getOwnPropertyDescriptor(g.prototype,"openThread"),g.prototype),g)})),define("discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator",["exports","@glimmer/component","@ember/service","I18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a){"use strict"
var s,o,l
function c(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=class extends t.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="currentUser",r=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),c(this,"unreadCountLabel",n.default.t("chat.unread_threads_count",{count:this.cappedUnreadCount}))}get unreadCount(){return this.args.channel.threadsManager.unreadThreadCount}get showUnreadIndicator(){return!this.currentUser.isInDoNotDisturb()&&this.unreadCount>0}get cappedUnreadCount(){return this.unreadCount>99?"99+":this.unreadCount}},(0,a.setComponentTemplate)((0,r.createTemplateFactory)({id:"z2Rw0liX",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-thread-header-unread-indicator"],[15,"title",[30,0,["unreadCountLabel"]]],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-header-unread-indicator__number"],[12],[1,[30,0,["cappedUnreadCount"]]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator.js",isStrictMode:!0}),l),u=(s=l).prototype,d="currentUser",h=[i.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),o=b,s)
var u,d,h,p,m,b})),define("discourse/plugins/chat/discourse/components/chat/thread/header",["exports","@glimmer/component","@ember/service","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(m=class extends t.default{constructor(){super(...arguments),b(this,"currentUser",d,this),b(this,"chatHistory",h,this),b(this,"site",p,this)}get backLink(){const e=this.chatHistory.previousRoute?.name
let t,i,n
return"chat.channel.threads"===e?(t="chat.channel.threads",i=a.default.t("chat.return_to_threads_list"),n=this.channel?.routeModels):"chat.channel.index"!==e||this.site.mobileView?!this.currentUser.isInDoNotDisturb()&&this.unreadCount>0?(t="chat.channel.threads",i=a.default.t("chat.return_to_threads_list"),n=this.channel?.routeModels):"chat.threads"===e?(t="chat.threads",i=a.default.t("chat.my_threads.title"),n=[]):(t="chat.channel.index",i=a.default.t("chat.return_to_channel"),n=this.channel?.routeModels):(t="chat.channel.threads",i=a.default.t("chat.return_to_threads_list"),n=this.channel?.routeModels),{route:t,models:n,title:i}}get channel(){return this.args.thread?.channel}get headerTitle(){return this.args.thread?.title??a.default.t("chat.thread.label")}get unreadCount(){return this.channel?.threadsManager?.unreadThreadCount}},(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"4pjQPita",block:'[[[1,"\\n    "],[8,[32,0],null,[["@showFullTitle"],[[30,1]]],[["default"],[[[[1,"\\n"],[41,[30,3],[[[1,"        "],[8,[30,2,["BackButton"]],null,[["@route","@routeModels","@title"],[[30,0,["backLink","route"]],[30,0,["backLink","models"]],[30,0,["backLink","title"]]]],[["default"],[[[[1,"\\n          "],[8,[32,1],null,[["@channel"],[[30,0,["channel"]]]],null],[1,"\\n          "],[1,[28,[32,2],["chevron-left"],null]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[30,2,["Title"]],null,[["@title"],[[28,[32,3],[[30,0,["headerTitle"]]],null]]],null],[1,"\\n      "],[8,[30,2,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,4,["ThreadTrackingDropdown"]],null,[["@thread"],[[30,3]]],null],[1,"\\n        "],[8,[30,4,["ThreadSettingsButton"]],null,[["@thread"],[[30,3]]],null],[1,"\\n        "],[8,[30,4,["CloseThreadButton"]],null,[["@thread"],[[30,3]]],null],[1,"\\n      "]],[4]]]]],[1,"\\n    "]],[2]]]]],[1,"\\n  "]],["@showFullTitle","navbar","@thread","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread/header.js",scope:()=>[s.default,o.default,r.default,n.default],isStrictMode:!0}),m),d=g((u=m).prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"chatHistory",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(u.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/components/chat/user-card-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=class extends t.default{constructor(){super(...arguments),h(this,"chat",l,this),h(this,"appEvents",c,this),h(this,"router",u,this)}get shouldRender(){return this.chat.userCanDirectMessage&&!this.args.user.suspended}startChatting(){return this.chat.upsertDmChannel({usernames:[this.args.user.username]}).then((e=>{this.router.transitionTo("chat.channel",...e.routeModels),this.appEvents.trigger("card:close")}))}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"TOD2cIYT",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-primary chat-user-card-btn"]],[["@action","@label","@icon"],[[30,0,["startChatting"]],"chat.title_capitalized","d-chat"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/user-card-button.js",scope:()=>[r.default],isStrictMode:!0}),d),l=p((o=d).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=p(o.prototype,"appEvents",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(o.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(o.prototype,"startChatting",[i.action],Object.getOwnPropertyDescriptor(o.prototype,"startChatting"),o.prototype),o)})),define("discourse/plugins/chat/discourse/components/collapser",["exports","@ember/component","@ember/object","@ember/template-factory"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s=(0,n.createTemplateFactory)({id:"hDh7V21u",block:'[[[10,0],[14,0,"chat-message-collapser-header"],[12],[1,"\\n  "],[1,[30,0,["header"]]],[1,"\\n\\n"],[41,[30,0,["collapsed"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-closed"]],[["@action","@icon"],[[30,0,["open"]],"caret-right"]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-opened"]],[["@action","@icon"],[[30,0,["close"]],"caret-down"]],null],[1,"\\n"]],[]]],[13],[1,"\\n\\n"],[10,0],[15,0,[28,[37,2],["chat-message-collapser-body",[52,[30,0,["collapsed"]],"hidden"]],null]],[12],[1,"\\n  "],[18,1,[[30,0,["collapsed"]]]],[1,"\\n"],[13]],["&default"],false,["if","d-button","concat-class","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/collapser.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(s,t.default.extend((a(r={tagName:"",collapsed:!1,header:null,onToggle:null,open(){this.set("collapsed",!1),this.onToggle?.(!1)},close(){this.set("collapsed",!0),this.onToggle?.(!0)}},"open",[i.action],Object.getOwnPropertyDescriptor(r,"open"),r),a(r,"close",[i.action],Object.getOwnPropertyDescriptor(r,"close"),r),r)))}))
define("discourse/plugins/chat/discourse/components/dc-filter-input",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/modifier","ember-modifier","discourse/helpers/concat-class","discourse/helpers/noop","discourse-common/helpers/d-icon","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h
function p(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(h=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="isFocused",n=this,(i=d)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),p(this,"focusState",(0,a.modifier)((e=>{const t=()=>{this.isFocused=!0},i=()=>{this.isFocused=!1}
return e.addEventListener("focusin",t),e.addEventListener("focusout",i),()=>{e.removeEventListener("focusin",t),e.removeEventListener("focusout",i)}})))}},(0,n.setComponentTemplate)((0,c.createTemplateFactory)({id:"oVtoWO4Q",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],[[30,1],"dc-filter-input-container",[52,[30,0,["isFocused"]],"is-focused"]],null]],[12],[1,"\\n"],[41,[30,2,["left"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["left"]]],[["class"],["-left"]]]],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[32,2],[[24,0,"dc-filter-input"],[17,3],[4,[30,0,["focusState"]],null,null],[4,[32,3],["input",[52,[30,5],[30,5],[28,[32,4],null,null]]],null]],[["@value"],[[30,4]]],null],[1,"\\n\\n      "],[18,6,null],[1,"\\n\\n"],[41,[30,2,["right"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["right"]]],[["class"],["-right"]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@containerClass","@icons","&attrs","@value","@filterAction","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/dc-filter-input.js",scope:()=>[s.default,l.default,n.Input,r.on,o.default],isStrictMode:!0}),h),m=(u=h).prototype,b="isFocused",g=[i.tracked],f={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}},y={},Object.keys(f).forEach((function(e){y[e]=f[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=g.slice().reverse().reduce((function(e,t){return t(m,b,e)||e}),y),v&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(v):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(m,b,y),y=null),d=y,u)
var m,b,g,f,v,y})),define("discourse/plugins/chat/discourse/components/full-page-chat",["exports","@glimmer/component","@ember/helper","@ember/service","discourse/plugins/chat/discourse/components/chat-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"gGk4kwJK",block:'[[[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[28,[32,0],[[30,1]],null]],null]],null],null,[[[1,"      "],[8,[32,1],null,[["@channel","@targetMessageId"],[[30,2],[30,3]]],null],[1,"\\n"]],[2]],null],[1,"  "]],["@channel","channel","@targetMessageId"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/full-page-chat.js",scope:()=>[i.array,r.default],isStrictMode:!0}),c),u=(o=c).prototype,d="chat",h=[n.inject],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},b={},Object.keys(p).forEach((function(e){b[e]=p[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=h.slice().reverse().reduce((function(e,t){return t(u,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(u,d,b),b=null),l=b,o)
var u,d,h,p,m,b})),define("discourse/plugins/chat/discourse/components/reviewable-chat-message",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/routing","@ember/service","discourse/components/reviewable-created-by","discourse/components/reviewable-post-header","discourse-common/helpers/html-safe","discourse-common/helpers/i18n","truth-helpers/helpers/or","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
var b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(v=class extends t.default{constructor(){super(...arguments),y(this,"store",g,this),y(this,"chatChannelsManager",f,this)}get channel(){if(this.args.reviewable.chat_channel)return h.default.create(this.args.reviewable.chat_channel)}},(0,m.setComponentTemplate)((0,p.createTemplateFactory)({id:"ivj7Nzci",block:'[[[1,"\\n"],[41,[30,0,["channel"]],[[[1,"      "],[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n        "],[8,[32,0],null,[["@route","@models"],["chat.channel.near-message",[28,[32,1],[[30,0,["channel","slugifiedTitle"]],[30,0,["channel","id"]],[30,1,["target_id"]]],null]]],[["default"],[[[[1,"\\n          "],[8,[32,2],null,[["@channel"],[[30,0,["channel"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n      "],[8,[32,3],null,[["@user","@tagName"],[[30,1,["target_created_by"]],""]],null],[1,"\\n      "],[10,0],[14,0,"post-contents"],[12],[1,"\\n        "],[8,[32,4],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n\\n        "],[10,0],[14,0,"post-body"],[12],[1,"\\n          "],[1,[28,[32,5],[[28,[32,6],[[30,1,["payload","message_cooked"]],[30,1,["cooked"]]],null]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,1,["payload","transcript_topic_id"]],[[[1,"          "],[10,0],[14,0,"transcript"],[12],[1,"\\n            "],[8,[32,0],[[24,0,"btn btn-small"]],[["@route","@models"],["topic",[28,[32,1],["-",[30,1,["payload","transcript_topic_id"]]],null]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,7],["review.transcript.view"],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[18,2,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@reviewable","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/reviewable-chat-message.js",scope:()=>[r.LinkTo,n.array,d.default,s.default,o.default,l.default,u.default,c.default],isStrictMode:!0}),v),g=w((b=v).prototype,"store",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=w(b.prototype,"chatChannelsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(b.prototype,"channel",[i.cached],Object.getOwnPropertyDescriptor(b.prototype,"channel"),b.prototype),b)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,o.createTemplateFactory)({id:"UdTTMEaX",block:'[[[8,[39,0],null,[["@title"],["<ChatComposerMessageDetails>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message"],[[30,0,["message"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Mode"]],[["default"],[[[[1,"\\n"],[41,[30,0,["message","editing"]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Reply"]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Editing"]],null],[1,"\\n"]],[]]],[1,"    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-composer-message-details","styleguide/controls","styleguide/controls/row","if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details.hbs",isStrictMode:!1})
let g=e.default=(l=class extends i.default{constructor(){super(...arguments),p(this,"site",c,this),p(this,"session",u,this),p(this,"keyValueStore",d,this),p(this,"currentUser",h,this)}get message(){return s.default.message({user:this.currentUser})}toggleMode(){this.message.editing?(this.message.editing=!1,this.message.inReplyTo=s.default.message()):(this.message.editing=!0,this.message.inReplyTo=null)}},c=m(l.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(l.prototype,"session",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(l.prototype,"keyValueStore",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(l.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(l.prototype,"message",[n.cached],Object.getOwnPropertyDescriptor(l.prototype,"message"),l.prototype),m(l.prototype,"toggleMode",[r.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleMode"),l.prototype),l);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const m=(0,o.createTemplateFactory)({id:"44rPT0VR",block:'[[[8,[39,0],null,[["@title"],["<ChatComposer>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel","@onSendMessage"],[[30,0,["channel"]],[30,0,["onSendMessage"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Disabled"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDisabled"]]],null]],[["@state"],[[30,0,["channel","isReadOnly"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Sending"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleSending"]]],null]],[["@state"],[[30,0,["chatChannelPane","sending"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/composer/channel","styleguide/controls","styleguide/controls/row","d-toggle-switch","on"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer.hbs",isStrictMode:!1})
let b=e.default=(l=class extends i.default{constructor(){super(...arguments),d(this,"chatChannelComposer",c,this),d(this,"chatChannelPane",u,this),h(this,"channel",a.default.channel({id:-999}))}toggleDisabled(){this.channel.status===s.CHANNEL_STATUSES.open?this.channel.status=s.CHANNEL_STATUSES.readOnly:this.channel.status=s.CHANNEL_STATUSES.open}toggleSending(){this.chatChannelPane.sending=!this.chatChannelPane.sending}onSendMessage(){this.chatChannelComposer.reset()}},c=p(l.prototype,"chatChannelComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=p(l.prototype,"chatChannelPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p(l.prototype,"toggleDisabled",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleDisabled"),l.prototype),p(l.prototype,"toggleSending",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"toggleSending"),l.prototype),p(l.prototype,"onSendMessage",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"onSendMessage"),l.prototype),l);(0,t.setComponentTemplate)(m,b)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-header-icon",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,s.createTemplateFactory)({id:"3vsUy2AB",block:'[[[8,[39,0],null,[["@title"],["<Chat::Header::Icon>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[10,"header"],[14,0,"d-header"],[14,5,"display: flex; align-items: center; justify-content: center;"],[12],[1,"\\n      "],[10,"ul"],[14,0,"d-header-icons"],[12],[1,"\\n        "],[10,"li"],[14,0,"header-dropdown-toggle chat-header-icon"],[12],[1,"\\n          "],[8,[39,2],null,[["@isActive","@currentUserInDnD","@unreadCount","@urgentCount","@indicatorPreference"],[[30,0,["isActive"]],[30,0,["currentUserInDnD"]],[30,0,["unreadCount"]],[30,0,["urgentCount"]],[30,0,["indicatorPreference"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["isActive"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleIsActive"]]],null]],[["@state"],[[30,0,["isActive"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["currentUserInDnD"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleCurrentUserInDnD"]]],null]],[["@state"],[[30,0,["currentUserInDnD"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Unread count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["unreadCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUnreadCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Urgent count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["urgentCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUrgentCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Indicator preference"]],[["default"],[[[[1,"\\n    "],[8,[39,7],null,[["@value","@content","@onChange","@valueProperty","@nameProperty"],[[30,0,["indicatorPreference"]],[30,0,["indicatorPreferences"]],[30,0,["updateIndicatorPreference"]],null,null]],null],[1,"\\n\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/header/icon","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","combo-box"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-header-icon.hbs",isStrictMode:!1})
let g=e.default=(o=class extends i.default{constructor(){super(...arguments),p(this,"isActive",l,this),p(this,"currentUserInDnD",c,this),p(this,"urgentCount",u,this),p(this,"unreadCount",d,this),p(this,"indicatorPreference",h,this)}get indicatorPreferences(){return[a.HEADER_INDICATOR_PREFERENCE_ALL_NEW,a.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,a.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,a.HEADER_INDICATOR_PREFERENCE_NEVER]}toggleIsActive(){this.isActive=!this.isActive}toggleCurrentUserInDnD(){this.currentUserInDnD=!this.currentUserInDnD}updateUnreadCount(e){this.unreadCount=e.target.value}updateUrgentCount(e){this.urgentCount=e.target.value}updateIndicatorPreference(e){this.indicatorPreference=e}},l=m(o.prototype,"isActive",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=m(o.prototype,"currentUserInDnD",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(o.prototype,"urgentCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(o.prototype,"unreadCount",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(o.prototype,"indicatorPreference",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return a.HEADER_INDICATOR_PREFERENCE_ALL_NEW}}),m(o.prototype,"toggleIsActive",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleIsActive"),o.prototype),m(o.prototype,"toggleCurrentUserInDnD",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"toggleCurrentUserInDnD"),o.prototype),m(o.prototype,"updateUnreadCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUnreadCount"),o.prototype),m(o.prototype,"updateUrgentCount",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateUrgentCount"),o.prototype),m(o.prototype,"updateIndicatorPreference",[r.action],Object.getOwnPropertyDescriptor(o.prototype,"updateIndicatorPreference"),o.prototype),o);(0,t.setComponentTemplate)(b,g)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-message",["exports","@ember/component","@glimmer/component","@ember/application","@ember/object","@ember/service","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u
function d(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,l.createTemplateFactory)({id:"4ZwlpP03",block:'[[[8,[39,0],null,[["@title"],["<ChatMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message","@context"],[[30,0,["message"]],"channel"]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Last Visit"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleLastVisit"]]],null]],[["@state"],[[30,0,["message","newest"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Deleted"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDeleted"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","deletedAt"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Bookmark"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleBookmarked"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","bookmark"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Thread"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleThread"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","thread"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Reactions"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleReaction"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","reactions"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Upload"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleUpload"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","uploads"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Message"]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[4,[38,6],["input",[30,0,["updateMessage"]]],null],[12],[1,[30,0,["message","message"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-message","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","not"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-message.hbs",isStrictMode:!1})
let m=e.default=(c=class extends i.default{constructor(){var e,t,i,r
super(...arguments),e=this,t="currentUser",r=this,(i=u)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0}),d(this,"manager",new s.default((0,n.getOwner)(this))),this.message=o.default.message({user:this.currentUser}),this.message.cook()}toggleDeleted(){this.message.deletedAt?this.message.deletedAt=null:this.message.deletedAt=moment()}toggleBookmarked(){this.message.bookmark?this.message.bookmark=null:this.message.bookmark=o.default.bookmark()}toggleHighlighted(){this.message.highlighted=!this.message.highlighted}toggleEdited(){this.message.edited=!this.message.edited}toggleLastVisit(){this.message.newest=!this.message.newest}toggleThread(){this.message.thread?(this.message.channel.threadingEnabled=!1,this.message.thread=null):(this.message.thread=o.default.thread({channel:this.message.channel}),this.message.thread.preview.replyCount=1,this.message.channel.threadingEnabled=!0)}async updateMessage(e){this.message.message=e.target.value,await this.message.cook()}toggleReaction(){this.message.reactions?.length?this.message.reactions=[]:this.message.reactions=[o.default.reaction({emoji:"heart"}),o.default.reaction({emoji:"rocket",reacted:!0})]}toggleUpload(){this.message.uploads?.length?this.message.uploads=[]:this.message.uploads=[o.default.upload(),o.default.upload()]}},u=h(c.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(c.prototype,"toggleDeleted",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleDeleted"),c.prototype),h(c.prototype,"toggleBookmarked",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleBookmarked"),c.prototype),h(c.prototype,"toggleHighlighted",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleHighlighted"),c.prototype),h(c.prototype,"toggleEdited",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleEdited"),c.prototype),h(c.prototype,"toggleLastVisit",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleLastVisit"),c.prototype),h(c.prototype,"toggleThread",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleThread"),c.prototype),h(c.prototype,"updateMessage",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"updateMessage"),c.prototype),h(c.prototype,"toggleReaction",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleReaction"),c.prototype),h(c.prototype,"toggleUpload",[r.action],Object.getOwnPropertyDescriptor(c.prototype,"toggleUpload"),c.prototype),c);(0,t.setComponentTemplate)(p,m)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"6txBnytZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ArchiveChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/channel-summary","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"9Nkr9oRZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ChannelSummary>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:{channelId:s.default.channel().id}})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,s.createTemplateFactory)({id:"W0WNy+Vl",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::CreateChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel.hbs",isStrictMode:!1})
let d=e.default=(o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default)}},l=c(o.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o);(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"RePA6/AH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::DeleteChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:{channel:this.channel}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"3ae/A2qR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelDescription>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"ilAVl2Kg",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelName>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel())}openModal(){return this.modal.show(a.default,{model:this.channel})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,o.createTemplateFactory)({id:"ATPl85dR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::MoveMessageToChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel.hbs",isStrictMode:!1})
let p=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),u(this,"channel",s.default.channel()),u(this,"selectedMessageIds",[s.default.message({channel:this.channel})].mapBy("id"))}openModal(){return this.modal.show(a.default,{model:{sourceChannel:this.channel,selectedMessageIds:[s.default.message({channel:this.channel})].mapBy("id")}})}},c=d(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(h,p)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory"],(function(e,t,i,n,r,a,s){"use strict"
var o,l
function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u=(0,s.createTemplateFactory)({id:"tf8RWlBH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::NewMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message.hbs",isStrictMode:!1})
let d=e.default=(o=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=l)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default)}},l=c(o.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(o.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(o.prototype,"openModal"),o.prototype),o);(0,t.setComponentTemplate)(u,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"fzsrgZZ3",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ThreadSettings>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:s.default.thread()})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c
function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.createTemplateFactory)({id:"h5sT+PPJ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ToggleChannelStatus>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status.hbs",isStrictMode:!1})
let h=e.default=(l=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="modal",n=this,(i=c)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}openModal(){return this.modal.show(a.default,{model:s.default.channel()})}},c=u(l.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(l.prototype,"openModal",[n.action],Object.getOwnPropertyDescriptor(l.prototype,"openModal"),l.prototype),l);(0,t.setComponentTemplate)(d,h)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item",["exports","@ember/component","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,i,n,r,a){"use strict"
var s,o
function l(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,a.createTemplateFactory)({id:"lR91t83a",block:'[[[8,[39,0],null,[["@title"],["<Chat::ThreadList::Item>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@thread"],[[30,0,["thread"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/thread-list/item"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item.hbs",isStrictMode:!1})
let u=e.default=(s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="currentUser",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),l(this,"thread",r.default.thread())}},d=s.prototype,h="currentUser",p=[n.inject],m={configurable:!0,enumerable:!0,writable:!0,initializer:null},g={},Object.keys(m).forEach((function(e){g[e]=m[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(d,h,e)||e}),g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(d,h,g),g=null),o=g,s)
var d,h,p,m,b,g;(0,t.setComponentTemplate)(c,u)})),define("discourse/plugins/chat/discourse/components/styleguide/organisms/chat",["exports","discourse/plugins/chat/discourse/components/styleguide/chat-composer","discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details","discourse/plugins/chat/discourse/components/styleguide/chat-header-icon","discourse/plugins/chat/discourse/components/styleguide/chat-message","discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-channel-summary","discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description","discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name","discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message","discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings","discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status","discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item","@ember/template-factory","@ember/component","@ember/component/template-only"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const y=(0,f.setComponentTemplate)((0,g.createTemplateFactory)({id:"iXa3zGnY",block:'[[[1,"\\n  "],[8,[32,0],null,null,null],[1,"\\n  "],[8,[32,1],null,null,null],[1,"\\n  "],[8,[32,2],null,null,null],[1,"\\n  "],[8,[32,3],null,null,null],[1,"\\n  "],[8,[32,4],null,null,null],[1,"\\n\\n  "],[10,"h2"],[12],[1,"Modals"],[13],[1,"\\n\\n  "],[8,[32,5],null,null,null],[1,"\\n  "],[8,[32,6],null,null,null],[1,"\\n  "],[8,[32,7],null,null,null],[1,"\\n  "],[8,[32,8],null,null,null],[1,"\\n  "],[8,[32,9],null,null,null],[1,"\\n  "],[8,[32,10],null,null,null],[1,"\\n  "],[8,[32,11],null,null,null],[1,"\\n  "],[8,[32,12],null,null,null],[1,"\\n  "],[8,[32,13],null,null,null],[1,"\\n  "],[8,[32,14],null,null,null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/styleguide/organisms/chat.js",scope:()=>[r.default,t.default,b.default,i.default,n.default,a.default,d.default,l.default,c.default,u.default,p.default,o.default,m.default,h.default,s.default],isStrictMode:!0}),(0,v.default)())
e.default=y})),define("discourse/plugins/chat/discourse/components/thread-title/index",["exports","@glimmer/component","@ember/routing","@ember/template","discourse/helpers/replace-emoji","discourse/lib/utilities","discourse/plugins/chat/discourse/components/thread-unread-indicator","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{get title(){return this.args.thread.title?(0,r.default)((0,n.htmlSafe)((0,a.escapeExpression)(this.args.thread.title))):(0,r.default)((0,n.htmlSafe)(this.args.thread.originalMessage.excerpt))}}e.default=u,c=u,(0,l.setComponentTemplate)((0,o.createTemplateFactory)({id:"buLLULLV",block:'[[[1,"\\n    "],[10,0],[14,0,"chat__thread-title-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat__thread-title"],[12],[1,"\\n        "],[8,[32,0],[[24,0,"chat__thread-title__name"]],[["@route","@models"],["chat.channel.thread",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n          "],[1,[30,0,["title"]]],[1,"\\n        "]],[]]]]],[1,"\\n\\n        "],[8,[32,1],null,[["@thread"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@thread"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/thread-title/index.js",scope:()=>[i.LinkTo,s.default],isStrictMode:!0}),c)})),define("discourse/plugins/chat/discourse/components/thread-unread-indicator/index",["exports","@glimmer/component","@ember/template-factory","@ember/component"],(function(e,t,i,n){"use strict"
var r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get unreadCount(){return this.args.thread.tracking.unreadCount}get showUnreadIndicator(){return this.unreadCount>0}get unreadCountLabel(){return this.unreadCount>99?"99+":this.unreadCount}}e.default=a,r=a,(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"aQpgvVe/",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-thread-list-item-unread-indicator"],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-list-item-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["unreadCountLabel"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/thread-unread-indicator/index.js",isStrictMode:!0}),r)})),define("discourse/plugins/chat/discourse/components/toggle-channel-membership-button",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse-i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(f=class extends t.default{constructor(){super(...arguments),v(this,"chat",m,this),v(this,"chatApi",b,this),v(this,"isLoading",g,this),y(this,"options",{}),this.options={labelType:"normal",joinTitle:u.default.t("chat.channel_settings.join_channel"),joinIcon:"",joinClass:"",leaveTitle:u.default.t("chat.channel_settings.leave_channel"),leaveIcon:"",leaveClass:"",...this.args.options}}get label(){return"none"===this.options.labelType?"":"short"===this.options.labelType?this.args.channel.currentUserMembership.following?u.default.t("chat.channel_settings.leave"):u.default.t("chat.channel_settings.join"):this.args.channel.currentUserMembership.following?u.default.t("chat.channel_settings.leave_channel"):u.default.t("chat.channel_settings.join_channel")}onJoinChannel(){return this.isLoading=!0,this.chat.followChannel(this.args.channel).then((()=>{this.args.onJoin?.(this.args.channel)})).catch(c.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}async onLeaveChannel(){this.isLoading=!0
try{this.args.channel.chatable.group?await this.chatApi.leaveChannel(this.args.channel.id):await this.chat.unfollowChannel(this.args.channel),this.args.onLeave?.(this.args.channel)}catch(e){(0,c.popupAjaxError)(e)}finally{this.isLoading=!1}}},(0,h.setComponentTemplate)((0,d.createTemplateFactory)({id:"7Vy5YBdY",block:'[[[1,"\\n"],[41,[30,1,["currentUserMembership","following"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["toggle-channel-membership-button -leave",[30,0,["options","leaveClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onLeaveChannel"]],[30,0,["label"]],[30,0,["options","leaveTitle"]],[30,0,["options","leaveIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,2],null,[["@name","@outletArgs","@defaultGlimmer"],["chat-join-channel-button",[28,[32,3],null,[["onJoinChannel","channel","icon","title","label","disabled"],[[30,0,["onJoinChannel"]],[30,1],[30,0,["options","joinIcon"]],[30,0,["options","joinTitle"]],[30,0,["label"]],[30,0,["isLoading"]]]]],true]],[["default"],[[[[1,"\\n        "],[8,[32,0],[[16,0,[28,[32,1],["toggle-channel-membership-button -join",[30,0,["options","joinClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onJoinChannel"]],[30,0,["label"]],[30,0,["options","joinTitle"]],[30,0,["options","joinIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]]],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/toggle-channel-membership-button.js",scope:()=>[s.default,l.default,o.default,n.hash],isStrictMode:!0}),f),m=w((p=f).prototype,"chat",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=w(p.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=w(p.prototype,"isLoading",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w(p.prototype,"onJoinChannel",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"onJoinChannel"),p.prototype),w(p.prototype,"onLeaveChannel",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"onLeaveChannel"),p.prototype),p)})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,n.createTemplateFactory)({id:"O6dDc9NT",block:'[[[10,0],[14,0,"empty-state"],[12],[1,"\\n  "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n    "],[1,[28,[35,0],["user_menu.no_chat_notifications_title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n    "],[10,2],[12],[1,"\\n      "],[1,[28,[35,1],[[28,[37,0],["user_menu.no_chat_notifications_body"],[["preferencesUrl"],[[28,[37,2],["/my/preferences/notifications"],null]]]]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,["i18n","html-safe","get-url"]]',moduleName:"discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(r,(0,i.default)())})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list",["exports","discourse/components/user-menu/notifications-list"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get dismissTypes(){return this.filterByTypes}get emptyStateComponent(){return"user-menu/chat-notifications-list-empty-state"}}e.default=i})),define("discourse/plugins/chat/discourse/components/user-threads/index",["exports","@glimmer/component","@glimmer/tracking","@ember/service","discourse-common/helpers/i18n","discourse-common/utils/decorators","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/components/chat/list","discourse/plugins/chat/discourse/components/chat-message-thread-indicator","discourse/plugins/chat/discourse/components/thread-title","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-thread","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(f=class extends t.default{constructor(){super(...arguments),v(this,"chat",b,this),v(this,"chatApi",g,this)}get threadsCollection(){return this.chatApi.userThreads(this.handleLoadedThreads)}handleLoadedThreads(e){return e.threads.map((t=>{const i=u.default.create(t.channel),n=d.default.create(i,t),r=e.tracking[n.id]
return r&&(n.tracking.mentionCount=r.mention_count,n.tracking.unreadCount=r.unread_count),n}))}},(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"IGm1QoLb",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"c-user-threads"]],[["@collection"],[[30,0,["threadsCollection"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["Item"]],null,null,[["default"],[[[[1,"\\n        "],[10,0],[14,0,"c-user-thread"],[15,"data-id",[30,2,["id"]]],[12],[1,"\\n          "],[8,[32,1],null,[["@thread"],[[30,2]]],null],[1,"\\n          "],[8,[32,2],null,[["@channel"],[[30,2,["channel"]]]],null],[1,"\\n          "],[8,[32,3],[[24,"tabindex","-1"]],[["@message","@interactiveUser","@interactiveThread"],[[30,2,["originalMessage"]],false,false]],null],[1,"\\n        "],[13],[1,"\\n      "]],[2]]]]],[1,"\\n      "],[8,[30,1,["EmptyState"]],null,null,[["default"],[[[[1,"\\n        "],[10,0],[14,0,"empty-state-threads"],[12],[1,"\\n          "],[1,[28,[32,4],["chat.empty_state.my_threads"],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n  "]],["list","thread"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/user-threads/index.js",scope:()=>[o.default,c.default,s.default,l.default,r.default],isStrictMode:!0}),f),b=y((m=f).prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=y(m.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(m.prototype,"threadsCollection",[i.cached],Object.getOwnPropertyDescriptor(m.prototype,"threadsCollection"),m.prototype),y(m.prototype,"handleLoadedThreads",[a.bind],Object.getOwnPropertyDescriptor(m.prototype,"handleLoadedThreads"),m.prototype),m)})),define("discourse/plugins/chat/discourse/connectors/user-preferences-nav/chat-preferences",["exports","@glimmer/component","@ember/routing","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/template-factory","@ember/component"],(function(e,t,i,n,r,a,s){"use strict"
var o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static shouldRender(e,t){let{model:i}=e,{siteSettings:n,currentUser:r}=t
return n.chat_enabled&&(i.can_chat||r?.admin)}}e.default=l,o=l,(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"xAutR0Eb",block:'[[[1,"\\n    "],[10,"li"],[14,0,"user-nav__preferences-chat"],[12],[1,"\\n      "],[8,[32,0],null,[["@route"],["preferences.chat"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["d-chat"],null]],[1,"\\n        "],[10,1],[12],[1,[28,[32,2],["chat.title_capitalized"],null]],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/connectors/user-preferences-nav/chat-preferences.js",scope:()=>[i.LinkTo,n.default,r.default],isStrictMode:!0}),o)})),define("discourse/plugins/chat/discourse/controllers/admin-plugins-chat",["exports","@ember/controller","@ember/object","@ember/object/computed","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse-i18n"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=(0,n.and)("newWebhookName","newWebhookChannelId"),c=(0,i.computed)("model.incoming_chat_webhooks.@each.updated_at"),u=(0,i.computed)("selectedWebhookId"),d=(0,i.computed)("selectedWebhook.name","selectedWebhook.chat_channel.id"),h=class extends t.default{constructor(){super(...arguments),b(this,"dialog",p,this),g(this,"queryParams",[{selectedWebhookId:"id"}]),g(this,"loading",!1),g(this,"creatingNew",!1),g(this,"newWebhookName",""),g(this,"newWebhookChannelId",null),g(this,"emojiPickerIsActive",!1),b(this,"nameAndChannelValid",m,this)}get sortedWebhooks(){return this.model.incoming_chat_webhooks?.sortBy("updated_at").reverse()||[]}get selectedWebhook(){if(!this.selectedWebhookId)return
const e=parseInt(this.selectedWebhookId,10)
return this.model.incoming_chat_webhooks.findBy("id",e)}get saveEditDisabled(){return!this.selectedWebhook.name||!this.selectedWebhook.chat_channel.id}createNewWebhook(){if(this.loading)return
this.set("loading",!0)
const e={name:this.newWebhookName,chat_channel_id:this.newWebhookChannelId}
return(0,a.ajax)("/admin/plugins/chat/hooks",{data:e,type:"POST"}).then((e=>{const t=i.default.create(e)
this.set("model.incoming_chat_webhooks",[t].concat(this.model.incoming_chat_webhooks)),this.resetNewWebhook(),this.setProperties({loading:!1,selectedWebhookId:t.id})})).catch(s.popupAjaxError)}resetNewWebhook(){this.setProperties({creatingNew:!1,newWebhookName:"",newWebhookChannelId:null})}destroyWebhook(e){this.dialog.deleteConfirm({message:o.default.t("chat.incoming_webhooks.confirm_destroy"),didConfirm:()=>(this.set("loading",!0),(0,a.ajax)(`/admin/plugins/chat/hooks/${e.id}`,{type:"DELETE"}).then((()=>{this.model.incoming_chat_webhooks.removeObject(e),this.set("loading",!1)})).catch(s.popupAjaxError))})}emojiSelected(e){return this.selectedWebhook.set("emoji",`:${e}:`),this.set("emojiPickerIsActive",!1)}saveEdit(){this.set("loading",!0)
const e={name:this.selectedWebhook.name,chat_channel_id:this.selectedWebhook.chat_channel.id,description:this.selectedWebhook.description,emoji:this.selectedWebhook.emoji,username:this.selectedWebhook.username}
return(0,a.ajax)(`/admin/plugins/chat/hooks/${this.selectedWebhook.id}`,{data:e,type:"PUT"}).then((()=>{this.selectedWebhook.set("updated_at",new Date),this.setProperties({loading:!1,selectedWebhookId:null})})).catch(s.popupAjaxError)}changeChatChannel(e){this.selectedWebhook.set("chat_channel",this.model.chat_channels.findBy("id",e))}},p=f(h.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(h.prototype,"nameAndChannelValid",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(h.prototype,"sortedWebhooks",[c],Object.getOwnPropertyDescriptor(h.prototype,"sortedWebhooks"),h.prototype),f(h.prototype,"selectedWebhook",[u],Object.getOwnPropertyDescriptor(h.prototype,"selectedWebhook"),h.prototype),f(h.prototype,"saveEditDisabled",[d],Object.getOwnPropertyDescriptor(h.prototype,"saveEditDisabled"),h.prototype),f(h.prototype,"createNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"createNewWebhook"),h.prototype),f(h.prototype,"resetNewWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"resetNewWebhook"),h.prototype),f(h.prototype,"destroyWebhook",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"destroyWebhook"),h.prototype),f(h.prototype,"emojiSelected",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"emojiSelected"),h.prototype),f(h.prototype,"saveEdit",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"saveEdit"),h.prototype),f(h.prototype,"changeChatChannel",[i.action],Object.getOwnPropertyDescriptor(h.prototype,"changeChatChannel"),h.prototype),h)})),define("discourse/plugins/chat/discourse/controllers/chat-channel-index",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/controllers/chat-channel-thread",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this)}},a=l(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"targetMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)})),define("discourse/plugins/chat/discourse/controllers/chat-channel",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"targetMessageId",s,this),l(this,"queryParams",["messageId"])}},a=c(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"targetMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r)}))
define("discourse/plugins/chat/discourse/controllers/chat-draft-channel",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},a=n.prototype,s="chat",o=[i.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/controllers/chat-index",["exports","@ember/controller","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chat",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}},a=n.prototype,s="chat",o=[i.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/controllers/chat",["exports","@ember/controller","@ember/service","discourse/plugins/chat/discourse/lib/chat-constants"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends t.default{constructor(){super(...arguments),l(this,"chat",a,this),l(this,"chatStateManager",s,this),l(this,"router",o,this)}get shouldUseChatSidebar(){return!this.site.mobileView&&!this.shouldUseCoreSidebar}get shouldUseCoreSidebar(){return"sidebar"===this.siteSettings.navigation_menu}get shouldUseChatFooter(){return this.site.mobileView&&n.FOOTER_NAV_ROUTES.includes(this.router.currentRouteName)}get mainOutletModifierClasses(){let e=[]
return this.chatStateManager.isSidePanelExpanded&&e.push("has-side-panel-expanded"),this.router.currentRouteName.startsWith("chat.channel.info")||this.router.currentRouteName.startsWith("chat.browse")||e.push("chat-view"),e.join(" ")}},a=c(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/controllers/preferences-chat",["exports","@ember/controller","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/services/chat-audio-manager"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_NEVER=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW=void 0
const b=["chat_enabled","only_chat_push_notifications","ignore_channel_wide_mention","chat_sound","chat_email_frequency","chat_header_indicator_preference","chat_separate_sidebar_mode"],g=[{name:o.default.t("chat.email_frequency.never"),value:"never"},{name:o.default.t("chat.email_frequency.when_away"),value:"when_away"}],f=e.HEADER_INDICATOR_PREFERENCE_NEVER="never",v=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS="dm_and_mentions",y=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW="all_new",w=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS="only_mentions",_=[{name:o.default.t("chat.header_indicator_preference.all_new"),value:y},{name:o.default.t("chat.header_indicator_preference.dm_and_mentions"),value:v},{name:o.default.t("chat.header_indicator_preference.only_mentions"),value:w},{name:o.default.t("chat.header_indicator_preference.never"),value:f}],j=[{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.always"),value:"always"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.fullscreen"),value:"fullscreen"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.never"),value:"never"}]
e.default=(c=class extends t.default{constructor(){super(...arguments),h(this,"chatAudioManager",u,this),h(this,"siteSettings",d,this),p(this,"subpageTitle",o.default.t("chat.admin.title")),p(this,"emailFrequencyOptions",g),p(this,"headerIndicatorOptions",_),p(this,"chatSeparateSidebarModeOptions",j)}get chatSeparateSidebarMode(){const e=this.model.get("user_option.chat_separate_sidebar_mode")
return"default"===e?this.siteSettings.chat_separate_sidebar_mode:e}chatSounds(){return Object.keys(l.CHAT_SOUNDS).map((e=>({name:o.default.t(`chat.sounds.${e}`),value:e})))}onChangeChatSound(e){e&&this.chatAudioManager.playImmediately(e),this.model.set("user_option.chat_sound",e)}save(){return this.set("saved",!1),this.model.save(b).then((()=>{this.set("saved",!0),(0,a.isTesting)()||location.reload()})).catch(r.popupAjaxError)}},u=m(c.prototype,"chatAudioManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(c.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(c.prototype,"chatSounds",[s.default],Object.getOwnPropertyDescriptor(c.prototype,"chatSounds"),c.prototype),m(c.prototype,"onChangeChatSound",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"onChangeChatSound"),c.prototype),m(c.prototype,"save",[i.action],Object.getOwnPropertyDescriptor(c.prototype,"save"),c.prototype),c)})),define("discourse/plugins/chat/discourse/helpers/chat-guardian",["exports","@ember/component/helper","@ember/service","@ember/string"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends t.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatGuardian",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}compute(e){const[t,...i]=e
if(t)return this.chatGuardian[(0,n.camelize)(t)]?.(...i)}},s=r.prototype,o="chatGuardian",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a=d,r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/helpers/format-chat-date",["exports","@ember/template","discourse/models/user","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,a){const s=i.default.current(),o=s?s.user_option.timezone:moment.tz.guess(),l=moment(new Date(e.createdAt),o),c=l.format(r.default.t("dates.long_with_year")),u="tiny"===a?l.format(r.default.t("chat.dates.time_tiny")):l.format(r.default.t("dates.time"))
if(e.staged)return(0,t.htmlSafe)(`<span title='${c}' tabindex="-1" class='chat-time'>${u}</span>`)
{const i=(0,n.default)(`/chat/c/-/${e.channel.id}/${e.id}`)
return(0,t.htmlSafe)(`<a title='${c}' tabindex="-1" class='chat-time' href='${i}'>${u}</a>`)}}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-title",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return`:${e.name}:`
return`:${e.name}:t${t}:`}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-url",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return e.url
return e.url.split(".png")[0]+`/${t}.png`}})),define("discourse/plugins/chat/discourse/initializers/chat-audio",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=[29,30]
e.default={name:"chat-audio",initialize(e){if(!e.lookup("service:chat").userCanChat)return
const n=e.lookup("service:chat-audio-manager")
n.setup(),(0,t.withPluginApi)("0.12.1",(e=>{e.registerDesktopNotificationHandler(((e,t,r)=>{r.isInDoNotDisturb()||r.chat_sound&&i.includes(e.notification_type)&&n.play(r.chat_sound)}))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-decorators",["exports","jquery","discourse/helpers/loading-spinner","discourse/instance-initializers/onebox-decorators","discourse/lib/hashtag-decorator","discourse/lib/highlight-syntax","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/url","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-decorators",initializeWithPluginApi(e,t){const i=t.lookup("service:site-settings"),s=t.lookup("service:lightbox"),o=t.lookup("service:site")
e.decorateChatMessage((e=>(0,n.decorateGithubOneboxBody)(e)),{id:"onebox-github-body"}),e.decorateChatMessage((e=>{e.querySelectorAll(".onebox.githubblob li.selected").forEach((e=>{const t=this._getScrollParent(e,"onebox")
if(!t)return
const i=t.offsetHeight-t.clientHeight
t.scroll({top:e.offsetTop+i-t.offsetHeight/2+e.offsetHeight/2})}))}),{id:"onebox-github-scrolling"}),e.decorateChatMessage((e=>(0,a.default)(e,i,t.lookup("service:session"))),{id:"highlightSyntax"}),e.decorateChatMessage(this.renderChatTranscriptDates,{id:"transcriptDates"}),e.decorateChatMessage(this.forceLinksToOpenNewTab,{id:"linksNewTab"}),i.enable_experimental_lightbox?e.decorateChatMessage((e=>{s.setupLightboxes({container:e,selector:"img:not(.emoji, .avatar, .site-icon)"})}),{id:"experimental-chat-lightbox"}):e.decorateChatMessage((e=>this.lightbox(e.querySelectorAll("img:not(.emoji, .avatar)"))),{id:"lightbox"}),e.decorateChatMessage((e=>(0,r.decorateHashtags)(e,o)),{id:"hashtagIcons"})},_getScrollParent(e,t){return null===e||e.classList.contains(t)?null:e.scrollHeight>e.clientHeight?e:this._getScrollParent(e.parentNode,t)},renderChatTranscriptDates(e){e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,i=e.querySelector(".chat-transcript-datetime a")
i&&""===i.innerText&&(this.currentUserTimezone?i.innerText=moment.tz(t,this.currentUserTimezone).format(u.default.t("dates.long_no_year")):i.innerText=moment(t).format(u.default.t("dates.long_no_year")))}))},forceLinksToOpenNewTab(e){const t=e.querySelectorAll(".chat-message-text a:not([target='_blank'])")
for(let i=0;i<t.length;i++){const e=t[i]
l.default.isInternal(e.href)&&(0,c.samePrefix)(e.href)||e.setAttribute("target","_blank")}},lightbox(e){(0,s.default)("/javascripts/jquery.magnific-popup.min.js").then((function(){(0,t.default)(e).magnificPopup({type:"image",closeOnContentClick:!1,mainClass:"mfp-zoom-in",tClose:u.default.t("lightbox.close"),tLoading:i.spinnerHTML,image:{verticalFit:!0},gallery:{enabled:!0},callbacks:{elementParse:e=>{e.src=e.el[0].dataset.largeSrc||e.el[0].src}}})}))},initialize(e){e.lookup("service:chat").userCanChat&&(0,o.withPluginApi)("0.8.42",(t=>this.initializeWithPluginApi(t,e)))}}})),define("discourse/plugins/chat/discourse/initializers/chat-keyboard-shortcuts",["exports","discourse/lib/keyboard-shortcuts","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-keyboard-shortcuts",initialize(e){const r=e.lookup("service:chat")
if(!r.userCanChat)return
const a=e.lookup("service:router"),s=e.lookup("service:app-events"),o=e.lookup("service:modal"),l=e.lookup("service:chat-state-manager"),c=e.lookup("service:chat-thread-pane"),u=e.lookup("service:chat-thread-list-pane"),d=e.lookup("service:chat-channels-manager"),h=e=>{e.preventDefault(),e.stopPropagation(),o.show(n.default)},p=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("up")},m=e=>{e.preventDefault(),e.stopPropagation(),r.switchChannelUpOrDown("down")},b=e=>e.classList.contains("chat-composer__input"),g=(e,t)=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:modify-selection",e,{type:t,context:e.target.dataset.chatComposerContext}))};(0,i.withPluginApi)("0.12.1",(e=>{e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+k`,h,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_quick_channel_selector",definition:{keys1:["meta","k"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("alt+up",p,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.switch_channel_arrows",definition:{keys1:["alt","&uarr;"],keys2:["alt","&darr;"],keysDelimiter:"plus",shortcutsDelimiter:"slash"}}}),e.addKeyboardShortcut("alt+down",m,{global:!0}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+b`,(e=>g(e,"bold")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_bold",definition:{keys1:["meta","b"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+i`,(e=>g(e,"italic")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_italic",definition:{keys1:["meta","i"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+e`,(e=>g(e,"code")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_code",definition:{keys1:["meta","e"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+l`,(e=>(e=>{b(e.target)&&(e.preventDefault(),e.stopPropagation(),s.trigger("chat:open-insert-link-modal",e,{context:e.target.dataset.chatComposerContext}))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_insert_link_modal",definition:{keys1:["meta","l"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("-",(e=>(e=>{(e=>{const t=e?.tagName.toLowerCase()
return!["input","textarea","select","button"].includes(t)})(e.target)&&(e.preventDefault(),e.stopPropagation(),l.prefersDrawer(),a.transitionTo(l.lastKnownChatURL||"chat"))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_open",definition:{keys1:["-"]}}}),e.addKeyboardShortcut("esc",(e=>(e=>{if(!e.srcElement?.classList?.value?.includes("mfp-wrap"))return l.isDrawerActive?(e.preventDefault(),e.stopPropagation(),void s.trigger("chat:toggle-close",e)):c.isOpened?(e.preventDefault(),e.stopPropagation(),void c.close()):u.isOpened?(e.preventDefault(),e.stopPropagation(),void u.close()):void 0})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_close",definition:{keys1:["esc"]}}}),e.addKeyboardShortcut("shift+esc",(e=>(e=>{e.preventDefault(),e.stopPropagation(),l.isActive&&d.markAllChannelsRead()})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.mark_all_channels_read",definition:{keys1:["shift","esc"],keysDelimiter:"plus"}}})}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-plugin-decorators",["exports","discourse/lib/local-dates","discourse/lib/plugin-api"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-decorators",initializeWithPluginApi(e,i){if(e.decorateChatMessage((e=>{(0,t.applyLocalDates)(e.querySelectorAll(".discourse-local-date"),i)}),{id:"local-dates"}),i.spoiler_enabled){const t=requirejs("discourse/plugins/spoiler-alert/lib/apply-spoiler").default
e.decorateChatMessage((e=>{e.querySelectorAll(".spoiler").forEach((e=>{e.classList.remove("spoiler"),e.classList.add("spoiled"),t(e)}))}),{id:"spoiler"})}},initialize(e){if(e.lookup("service:chat").userCanChat){const t=e.lookup("service:site-settings");(0,i.withPluginApi)("0.8.42",(e=>{this.initializeWithPluginApi(e,t)}))}}}})),define("discourse/plugins/chat/discourse/initializers/chat-setup",["exports","discourse/lib/plugin-api","discourse-common/lib/get-owner","discourse-common/lib/icon-library","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/hashtag-types/channel","discourse/plugins/chat/discourse/components/styleguide/organisms/chat"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u
function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}let h
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;(0,n.replaceIcon)("d-chat","comment")
e.default=(d(u={name:"chat-setup",before:"hashtag-css-generator",initialize(e){this.router=e.lookup("service:router"),this.chatService=e.lookup("service:chat"),this.chatHistory=e.lookup("service:chat-history"),this.site=e.lookup("service:site"),this.siteSettings=e.lookup("service:site-settings"),this.currentUser=e.lookup("service:current-user"),this.appEvents=e.lookup("service:app-events"),this.appEvents.on("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(0,t.withPluginApi)("0.12.1",(t=>{t.onPageChange((e=>{const t=this.router.recognize(e)
t.name.startsWith("chat.")&&this.chatHistory.visit(t)})),t.registerHashtagType("channel",new l.default(e)),t.registerChatComposerButton({id:"chat-upload-btn",icon:"far-image",label:"chat.upload",position:"dropdown",action:"uploadClicked",dependentKeys:["canAttachUploads"],displayed(){return this.canAttachUploads}}),this.siteSettings.discourse_local_dates_enabled&&t.registerChatComposerButton({label:"discourse_local_dates.title",id:"local-dates",class:"chat-local-dates-btn",icon:"calendar-alt",position:"dropdown",action(){this.insertDiscourseLocalDate()}}),t.registerChatComposerButton({label:"chat.emoji",id:"emoji",class:"chat-emoji-btn",icon:"far-smile",position:this.site.desktopView?"inline":"dropdown",context:"channel",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"channel"})}}),t.registerChatComposerButton({label:"chat.emoji",id:"channel-emoji",class:"chat-emoji-btn",icon:"discourse-emojis",position:"dropdown",context:"thread",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"thread"})}})
const n=this.siteSettings.custom_summarization_allowed_groups.split("|").map((e=>parseInt(e,10)))
if(this.siteSettings.summarization_strategy&&this.currentUser&&this.currentUser.groups.some((e=>n.includes(e.id)))&&t.registerChatComposerButton({translatedLabel:"chat.summarization.title",id:"channel-summary",icon:"discourse-sparkles",position:"dropdown",action:"showChannelSummaryModal"}),t.decorateCookedElement((e=>{const t=(0,i.getOwnerWithFallback)(this).lookup("service:current-user"),n=t?.user_option?.timezone
e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,i=e.querySelector(".chat-transcript-datetime a, .chat-transcript-datetime span")
i.innerText=n?moment.tz(t,n).format(a.default.t("dates.long_no_year")):moment(t).format(a.default.t("dates.long_no_year")),i.dataset.dateFormatted=!0}))})),!this.chatService.userCanChat)return
document.body.classList.add("chat-enabled")
const r=t.getCurrentUser()
r?.chat_channels&&this.chatService.setupWithPreloadedChannels(r.chat_channels)
e.lookup("service:chat-notification-manager").start(),this._registeredDocumentTitleCountCallback||(t.addDocumentTitleCounter(this.documentTitleCountCallback),this._registeredDocumentTitleCountCallback=!0),t.addCardClickListenerSelector(".chat-drawer-outlet"),t.addToHeaderIcons("chat-header-icon"),t.addStyleguideSection?.({component:c.default,category:"organisms",id:"chat"}),t.addChatDrawerStateCallback((e=>{let{isDrawerActive:t}=e
t?document.body.classList.add("chat-drawer-active"):document.body.classList.remove("chat-drawer-active")})),t.decorateChatMessage((function(e,t){if(!this.currentUser)return
const i=[`@${this.currentUser.username}`]
t.allowChannelWideMentions&&i.push(...s.MENTION_KEYWORDS.map((e=>`@${e}`))),e.querySelectorAll(".mention").forEach((e=>{const t=e.textContent.trim()
i.includes(t)&&e.classList.add("highlighted","valid-mention")}))}))}))},documentTitleCountCallback(){return this.chatService.getDocumentTitleCount()},teardown(){this.appEvents.off("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(h=null,(0,o.clearChatComposerButtons)())},_handleFocusChanged(e){if(!this.chatService.userCanChat)return
if(!e)return void(h=Date.now())
h=h||Date.now()
Date.now()-h<=18e4||(h=Date.now())}},"documentTitleCountCallback",[r.bind],Object.getOwnPropertyDescriptor(u,"documentTitleCountCallback"),u),d(u,"_handleFocusChanged",[r.bind],Object.getOwnPropertyDescriptor(u,"_handleFocusChanged"),u),u)})),define("discourse/plugins/chat/discourse/initializers/chat-sidebar",["exports","@glimmer/tracking","@ember/service","@ember/string","@ember/template","discourse/helpers/decorate-username-selector","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/utilities","discourse-common/lib/avatar-utils","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m){"use strict"
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function f(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-sidebar",initialize(e){this.chatService=e.lookup("service:chat"),this.chatService.userCanChat&&(this.siteSettings=e.lookup("service:site-settings"),this.currentUser=e.lookup("service:current-user"),(0,s.withPluginApi)("1.8.0",(e=>{e.addSidebarPanel((e=>class extends e{constructor(){super(...arguments),f(this,"key",m.CHAT_PANEL),f(this,"switchButtonLabel",h.default.t("sidebar.panels.chat.label")),f(this,"switchButtonIcon","d-chat"),f(this,"switchButtonDefaultUrl",(0,u.default)("/chat"))}})),(0,m.initSidebarState)(e,e.getCurrentUser())})),(0,s.withPluginApi)("1.3.0",(s=>{const u=this.currentUser?.chat_channels?.public_channels?.some((e=>!0===e.threading_enabled))
u&&s.addSidebarSection(((t,i)=>{const n=class extends i{constructor(){super(...arguments),f(this,"route","chat.threads"),f(this,"text",h.default.t("chat.my_threads.title")),f(this,"title",h.default.t("chat.my_threads.title")),f(this,"name","user-threads"),f(this,"prefixType","icon"),f(this,"prefixValue","discourse-threads"),f(this,"suffixType","icon"),f(this,"suffixCSSClass","unread"),e.isDestroyed||(this.chatChannelsManager=e.lookup("service:chat-channels-manager"))}get suffixValue(){return this.chatChannelsManager.publicMessageChannels.some((e=>e.unreadThreadsCount>0))?"circle":""}}
return class extends t{constructor(){super(...arguments),f(this,"hideSectionHeader",!0),f(this,"name","user-threads"),f(this,"title","")}get links(){return[new n]}get text(){return null}}}),m.CHAT_PANEL),this.siteSettings.enable_public_channels&&s.addSidebarSection(((a,s)=>{var l,c,u
const d=class extends s{constructor(e){let{channel:t,chatService:i}=e
super(...arguments),this.channel=t,this.chatService=i}get name(){return(0,n.dasherize)(this.channel.slugifiedTitle)}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get text(){return(0,r.htmlSafe)((0,o.emojiUnescape)(this.channel.escapedTitle))}get prefixType(){return"icon"}get prefixValue(){return"d-chat"}get prefixColor(){return this.channel.chatable.color}get title(){return this.channel.escapedDescription?(0,r.htmlSafe)(this.channel.escapedDescription):`${this.channel.escapedTitle} ${h.default.t("chat.title")}`}get prefixBadge(){return this.channel.chatable.read_restricted?"lock":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0||this.chatService.activeChannel?.id!==this.channel.id&&this.channel.unreadThreadsCountSinceLastViewed>0?"circle":""}get suffixCSSClass(){return this.channel.tracking.mentionCount>0?"urgent":"unread"}},p=(l=class extends a{constructor(){super(...arguments),b(this,"currentUser",c,this),b(this,"currentUserCanJoinPublicChannels",u,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"),this.router=e.lookup("service:router"))}get sectionLinks(){return this.chatChannelsManager.publicMessageChannels.map((e=>new d({channel:e,chatService:this.chatService})))}get name(){return"chat-channels"}get title(){return h.default.t("chat.chat_channels")}get text(){return h.default.t("chat.chat_channels")}get actions(){return[{id:"browseChannels",title:h.default.t("chat.channels_list_popup.browse"),action:()=>this.router.transitionTo("chat.browse.open")}]}get actionsIcon(){return"pencil-alt"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.currentUserCanJoinPublicChannels}},c=g(l.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=g(l.prototype,"currentUserCanJoinPublicChannels",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.currentUser&&(this.currentUser.staff||this.currentUser.has_joinable_public_channels)}}),l)
return p}),m.CHAT_PANEL),s.addSidebarSection(((n,s)=>{var o,u,m,v,y,w,_
const j=(o=class extends s{constructor(e){let{channel:t,chatService:i,currentUser:n}=e
if(super(...arguments),f(this,"route","chat.channel"),f(this,"suffixType","icon"),f(this,"suffixCSSClass","urgent"),f(this,"hoverType","icon"),f(this,"hoverValue","times"),f(this,"hoverTitle",h.default.t("chat.direct_messages.close")),this.channel=t,this.chatService=i,this.currentUser=n,this.oneOnOneMessage){const e=this.channel.chatable.users[0]
e.username!==h.default.t("chat.deleted_chat_username")&&e.trackStatus()}}willDestroy(){this.oneOnOneMessage&&this.channel.chatable.users[0].stopTrackingStatus()}get oneOnOneMessage(){return 1===this.channel.chatable.users.length}get contentComponentArgs(){return this.channel.chatable.users[0].get("status")}get contentComponent(){if(this.oneOnOneMessage)return"user-status-message"}get name(){return this.channel.slugifiedTitle}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get models(){return this.channel.routeModels}get title(){return this.channel.chatable.group?h.default.t("chat.placeholder_channel",{channelName:this.channel.escapedTitle}):h.default.t("chat.placeholder_users",{commaSeparatedNames:this.channel.escapedTitle})}get text(){if(this.channel.chatable.group)return this.channel.title
{const e=this.channel.escapedTitle.replaceAll("@","")
return(0,r.htmlSafe)(`${(0,l.escapeExpression)(e)}${(0,a.decorateUsername)((0,l.escapeExpression)(e))}`)}}get prefixType(){return this.channel.chatable.group?"text":"image"}get prefixValue(){return this.channel.chatable.group?this.channel.membershipsCount:(0,c.avatarUrl)(this.channel.chatable.users[0].avatar_template,"tiny")}get prefixCSSClass(){const e=this.chatService.presenceChannel.users,t=this.channel.chatable.users[0]
return e?.findBy("id",t?.id)||e?.findBy("username",t?.username)?"active":""}get suffixValue(){return this.channel.tracking.unreadCount>0?"circle":""}get hoverAction(){return e=>{e.stopPropagation(),e.preventDefault(),this.chatService.unfollowChannel(this.channel)}}},g(o.prototype,"willDestroy",[d.bind],Object.getOwnPropertyDescriptor(o.prototype,"willDestroy"),o.prototype),o),M=(u=class extends n{constructor(){super(...arguments),b(this,"site",m,this),b(this,"modal",v,this),b(this,"router",y,this),b(this,"currentUser",w,this),b(this,"userCanDirectMessage",_,this),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"))}get sectionLinks(){return this.chatChannelsManager.truncatedDirectMessageChannels.map((e=>new j({channel:e,chatService:this.chatService,currentUser:this.currentUser})))}get name(){return"chat-dms"}get title(){return h.default.t("chat.direct_messages.title")}get text(){return h.default.t("chat.direct_messages.title")}get actions(){return this.userCanDirectMessage?[{id:"startDm",title:h.default.t("chat.direct_messages.new"),action:()=>{this.modal.show(p.default)}}]:[]}get actionsIcon(){return"plus"}get links(){return this.sectionLinks}get displaySection(){return this.sectionLinks.length>0||this.userCanDirectMessage}},m=g(u.prototype,"site",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=g(u.prototype,"modal",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=g(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=g(u.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=g(u.prototype,"userCanDirectMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.chatService.userCanDirectMessage}}),u)
return M}),"chat")})))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-menu",["exports","discourse/lib/plugin-api","discourse/lib/utilities","discourse-i18n","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,i,n,r){"use strict"
function a(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-menu",initialize(e){(0,t.withPluginApi)("1.3.0",(t=>{e.lookup("service:chat").userCanChat&&(t.registerNotificationTypeRenderer&&(t.registerNotificationTypeRenderer("chat_invitation",(e=>class extends e{constructor(){super(...arguments),a(this,"linkTitle",n.default.t("notifications.titles.chat_invitation")),a(this,"icon","link"),a(this,"description",n.default.t("notifications.chat_invitation"))}get linkHref(){const e=this.notification.data
let t=`/chat/c/${(0,r.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_message_id&&(t+=`/${e.chat_message_id}`),t}get label(){return(0,i.formatUsername)(this.notification.data.invited_by_username)}})),t.registerNotificationTypeRenderer("chat_mention",(e=>class extends e{get linkHref(){let e=`/chat/c/${(0,r.default)({title:this.notification.data.chat_channel_title,slug:this.notification.data.chat_channel_slug})||"-"}/${this.notification.data.chat_channel_id}`
return this.notification.data.chat_thread_id?e+=`/t/${this.notification.data.chat_thread_id}`:e+=`/${this.notification.data.chat_message_id}`,e}get linkTitle(){return n.default.t("notifications.titles.chat_mention")}get icon(){return"d-chat"}get label(){return(0,i.formatUsername)(this.notification.data.mentioned_by_username)}get description(){const e=this.notification.data.identifier?`@${this.notification.data.identifier}`:null,t=this.notification.data.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",i=e?"other_plain":"direct"
return n.default.t(`${t}.${i}`,{identifier:e,channel:this.notification.data.chat_channel_title})}}))),t.registerUserMenuTab&&t.registerUserMenuTab((e=>class extends e{get id(){return"chat-notifications"}get panelComponent(){return"user-menu/chat-notifications-list"}get icon(){return"d-chat"}get count(){return this.getUnreadCountForType("chat_mention")+this.getUnreadCountForType("chat_invitation")}get notificationTypes(){return["chat_invitation","chat_mention","chat_message","chat_quoted"]}})))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-options",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-options",initialize(e){(0,t.withPluginApi)("0.11.0",(t=>{e.lookup("service:site-settings").chat_enabled&&(t.addSaveableUserOptionField("chat_enabled"),t.addSaveableUserOptionField("only_chat_push_notifications"),t.addSaveableUserOptionField("ignore_channel_wide_mention"),t.addSaveableUserOptionField("chat_sound"),t.addSaveableUserOptionField("chat_email_frequency"),t.addSaveableUserOptionField("chat_header_indicator_preference"),t.addSaveableUserOptionField("chat_separate_sidebar_mode"))}))}}})),define("discourse/plugins/chat/discourse/lib/chat-channel-subscription-manager",["exports","@glimmer/tracking","@ember/application","@ember/service","discourse-common/lib/object","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=class{constructor(e,t){let{onNewMessage:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
p(this,"currentUser",c,this),p(this,"chatChannelNoticesManager",u,this),p(this,"messageBus",d,this),p(this,"channel",h,this),(0,i.setOwner)(this,(0,i.getOwner)(e)),this.channel=t,this.onNewMessage=n,this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.channel.channelMessageBusLastId)}get messagesManager(){return this.channel.messagesManager}get messageBusChannel(){return`/chat/${this.channel.id}`}teardown(){this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage),this.modelId=null}onMessage(e,t,i,n){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)
break
case"update_thread_original_message":this.handleThreadOriginalMessageUpdate(e)
break
case"notice":this.handleNotice(e)}this.channel.channelMessageBusLastId=n}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessage(this.channel,this.messagesManager,e))return}const t=s.default.create(this.channel,e.chat_message)
t.manager=this.channel.messagesManager,this.onNewMessage?.(t),this.channel.lastMessage=t}handleStagedMessage(e,t,i){const n=t.findStagedMessage(i.staged_id)
if(n)return n.error=null,n.id=i.chat_message.id,n.staged=!1,n.excerpt=i.chat_message.excerpt,n.channel=e,n.createdAt=new Date(i.chat_message.created_at),n.cooked=i.chat_message.cooked,n}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked,t.uploads=(0,r.cloneJSON)(e.chat_message.uploads||[]),t.processed=!0,t.incrementVersion())}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.message=e.chat_message.message,t.cooked=e.chat_message.cooked,t.excerpt=e.chat_message.excerpt,t.uploads=(0,r.cloneJSON)(e.chat_message.uploads||[]),t.edited=e.chat_message.edited)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,i=this.messagesManager.findMessage(t)
i&&(this.currentUser.staff||this.currentUser.id===i.user.id?(i.deletedAt=e.deleted_at,i.deletedById=e.deleted_by_id,i.expanded=!1):this.messagesManager.removeMessage(i),this.channel.currentUserMembership.lastReadMessageId===i.id&&(this.channel.currentUserMembership.lastReadMessageId=e.latest_not_deleted_message_id))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=s.default.create(this.model,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.channel.threadsManager.find(this.channel.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.channel.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}handleNotice(e){this.chatChannelNoticesManager.handleNotice(e)}handleThreadOriginalMessageUpdate(e){const t=this.messagesManager.findMessage(e.original_message_id)
t?.thread&&(t.thread.preview=o.default.create(e.preview))}},c=m(l.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(l.prototype,"chatChannelNoticesManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(l.prototype,"messageBus",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(l.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(l.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(l.prototype,"onMessage"),l.prototype),l)})),define("discourse/plugins/chat/discourse/lib/chat-channel-thread-subscription-manager",["exports","@glimmer/tracking","@ember/application","@ember/service","discourse-common/lib/object","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class{constructor(e,t){let{onNewMessage:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
d(this,"currentUser",l,this),d(this,"messageBus",c,this),d(this,"channel",u,this),(0,i.setOwner)(this,(0,i.getOwner)(e)),this.thread=t,this.onNewMessage=n,this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.thread.channelMessageBusLastId)}get messagesManager(){return this.thread.messagesManager}get messageBusChannel(){return`/chat/${this.thread.channel.id}/thread/${this.thread.id}`}teardown(){this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage)}onMessage(e,t,i,n){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)}this.thread.threadMessageBusLastId=n}handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessage(this.thread.channel,this.messagesManager,e))return}const t=s.default.create(this.thread.channel,e.chat_message)
t.thread=this.thread,t.manager=this.messagesManager,this.onNewMessage?.(t)}handleStagedMessage(e,t,i){const n=t.findStagedMessage(i.staged_id)
if(n)return n.error=null,n.id=i.chat_message.id,n.staged=!1,n.excerpt=i.chat_message.excerpt,n.channel=e,n.createdAt=new Date(i.chat_message.created_at),n}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked,t.uploads=(0,r.cloneJSON)(e.chat_message.uploads||[]),t.processed=!0,t.incrementVersion())}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.excerpt=e.chat_message.excerpt,t.uploads=(0,r.cloneJSON)(e.chat_message.uploads||[]),t.edited=e.chat_message.edited)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,i=this.messagesManager.findMessage(t)
i&&(this.currentUser.staff||this.currentUser.id===i.user.id?(i.deletedAt=e.deleted_at,i.deletedById=e.deleted_by_id,i.expanded=!1):this.messagesManager.removeMessage(i),this.thread.currentUserMembership?.lastReadMessageId===i.id&&(this.thread.currentUserMembership.lastReadMessageId=e.latest_not_deleted_message_id))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=s.default.create(this.model,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.thread.threadsManager.find(this.thread.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.thread.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}},l=h(o.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"messageBus",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(o.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"onMessage"),o.prototype),o)})),define("discourse/plugins/chat/discourse/lib/chat-composer-buttons",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.chatComposerButtons=function(e,a,s){return Object.values(i).filter((t=>{let i=n(e,t,"displayed")&&n(e,t,"position")===a
return t.context&&(i=i&&n(e,t,"context")===s),i})).map((i=>{const a={id:i.id},o=n(e,i,"label")
a.label=o||n(e,i,"translatedLabel")
const l=n(e,i,"ariaLabel")
if(l)a.ariaLabel=t.default.t(l)
else{const t=n(e,i,"translatedAriaLabel")
a.ariaLabel=t||a.label}const c=n(e,i,"title")
if(a.title=c?t.default.t(c):n(e,i,"translatedTitle"),a.classNames=(n(e,i,"classNames")||[]).join(" "),a.icon=n(e,i,"icon"),a.disabled=n(e,i,"disabled"),a.priority=n(e,i,"priority"),r(i.action))a.action=()=>{i.action.apply(e,[s])}
else{const t=i.action
a.action=()=>{e[t](s)}}return a}))},e.chatComposerButtonsDependentKeys=function(){return[].concat(...Object.values(i).mapBy("dependentKeys").filter(Boolean))},e.clearChatComposerButtons=function(){i=[]},e.registerChatComposerButton=function(e){if(!e.id)throw new Error("Attempted to register a chat composer button with no id.")
if(i[e.id])return
const t=Object.assign({id:null,action:null,icon:null,title:null,translatedTitle:null,label:null,translatedLabel:null,ariaLabel:null,translatedAriaLabel:null,position:"inline",classNames:[],dependentKeys:[],displayed:!0,disabled:!1,priority:0},e)
if(!t.icon&&!t.label&&!t.translatedLabel)throw new Error(`Attempted to register a chat composer button: ${e.id} with no icon or label.`)
i[t.id]=t}
let i={}
function n(e,t,i){const n=t[i]
return r(n)?n.apply(e):n}function r(e){return e&&"function"==typeof e}})),define("discourse/plugins/chat/discourse/lib/chat-constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.READ_INTERVAL_MS=e.PAST=e.FUTURE=e.FOOTER_NAV_ROUTES=e.DEFAULT_MESSAGE_PAGE_SIZE=void 0
e.PAST="past",e.FUTURE="future",e.READ_INTERVAL_MS=1e3,e.DEFAULT_MESSAGE_PAGE_SIZE=50,e.FOOTER_NAV_ROUTES=["chat.direct-messages","chat.channels","chat.threads"]})),define("discourse/plugins/chat/discourse/lib/chat-ios-hacks",["exports","@ember/runloop","discourse/services/capabilities","discourse-common/lib/later","discourse/plugins/chat/discourse/lib/zoom-check"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.bodyScrollFix=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
i.capabilities.isIOS&&document.documentElement.classList.contains("keyboard-visible")&&!(0,r.default)()&&(e.delayed?setTimeout((()=>{document.documentElement.scrollTo(0,0)}),200):document.documentElement.scrollTo(0,0))},e.stackingContextFix=function(e,r){i.capabilities.isIOS&&(e.style.overflow="hidden",e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="1")))
r?.(),i.capabilities.isIOS&&(0,t.next)((()=>{(0,t.schedule)("afterRender",(()=>{e.style.overflow="auto",(0,n.default)((()=>{e&&e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="2"))}),50)}))}))}})),define("discourse/plugins/chat/discourse/lib/chat-message-container",["exports","discourse/plugins/chat/discourse/components/chat-message"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,i){let n
n=i===t.MESSAGE_CONTEXT_THREAD?`.chat-thread .chat-message-container[data-id="${e}"]`:`.chat-channel .chat-message-container[data-id="${e}"]`
return document.querySelector(n)}})),define("discourse/plugins/chat/discourse/lib/chat-message-flag",["exports","@ember/application","@ember/service","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,i,n,r,a){"use strict"
var s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=class{constructor(e){var i,n,r,a
i=this,n="chatApi",a=this,(r=o)&&Object.defineProperty(i,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(a):void 0}),(0,t.setOwner)(this,e)}title(){return"flagging.title"}customSubmitLabel(){return"flagging.notify_action"}submitLabel(){return"chat.flagging.action"}targetsTopic(){return!1}editable(){return!1}_rewriteFlagDescriptions(e){return e.map((e=>(e.set("description",a.default.t(`chat.flags.${e.name_key}`,{basePath:(0,r.default)("")})),e)))}flagsAvailable(e){let t=e.site.flagTypes
t=t.filter((t=>e.args.model.flagModel.availableFlags.includes(t.name_key)))
const i=t.indexOf(t.filterBy("name_key","notify_user")[0])
if(-1!==i){const e=t[i]
t.splice(i,1),t.splice(0,0,e)}return this._rewriteFlagDescriptions(t)}async create(e,t){e.args.closeModal()
const i=e.args.model.flagModel.channel.id,r=e.args.model.flagModel.id
try{await this.chatApi.flagMessage(i,r,{flag_type_id:e.selected.id,message:t.message,is_warning:t.isWarning,take_action:t.takeAction,queue_for_review:t.queue_for_review})}catch(a){(0,n.popupAjaxError)(a)}}},l=s.prototype,c="chatApi",u=[i.inject],d={configurable:!0,enumerable:!0,writable:!0,initializer:null},p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),o=p,s)
var l,c,u,d,h,p})),define("discourse/plugins/chat/discourse/lib/chat-message-interactor",["exports","@glimmer/tracking","@ember/application","@ember/object","@ember/service","discourse/components/modal/bookmark","discourse/components/modal/flag","discourse/lib/ajax-error","discourse/lib/bookmark","discourse/lib/utilities","discourse/models/bookmark","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-message-flag","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p,m,b,g,f){"use strict"
var v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D,A,N,I
function L(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function U(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function R(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.removeChatComposerSecondaryActions=function(e){e.forEach((e=>F.add(e)))},e.resetRemovedChatComposerSecondaryActions=function(){F.clear()}
const F=new Set
e.default=(v=class{constructor(e,t,n){L(this,"appEvents",y,this),L(this,"dialog",w,this),L(this,"chat",_,this),L(this,"chatEmojiReactionStore",j,this),L(this,"chatEmojiPickerManager",M,this),L(this,"chatChannelComposer",z,this),L(this,"chatThreadComposer",O,this),L(this,"chatChannelPane",C,this),L(this,"chatThreadPane",k,this),L(this,"chatApi",S,this),L(this,"currentUser",P,this),L(this,"site",T,this),L(this,"router",E,this),L(this,"modal",x,this),L(this,"capabilities",D,this),L(this,"toasts",A,this),L(this,"message",N,this),L(this,"context",I,this),U(this,"cachedFavoritesReactions",null),(0,i.setOwner)(this,e),this.message=t,this.context=n,this.cachedFavoritesReactions=this.chatEmojiReactionStore.favorites}get pane(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadPane:this.chatChannelPane}get emojiReactions(){let e=this.cachedFavoritesReactions
return e&&e.slice?e.slice(0,3).map((e=>this.message.reactions.find((t=>t.emoji===e))||f.default.create({emoji:e}))):[]}get canEdit(){return!this.message.deletedAt&&this.currentUser.id===this.message.user.id&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canInteractWithMessage(){return!this.message?.deletedAt&&this.message?.channel?.canModifyMessages(this.currentUser)}get canRestoreMessage(){return this.message?.deletedAt&&(this.currentUser.staff||this.message?.user?.id===this.currentUser.id&&this.message?.deletedById===this.currentUser.id)&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canBookmark(){return this.message?.channel?.canModifyMessages?.(this.currentUser)}get canReply(){return this.canInteractWithMessage&&this.context!==m.MESSAGE_CONTEXT_THREAD}get canReact(){return this.canInteractWithMessage}get canFlagMessage(){return this.currentUser.id!==this.message?.user?.id&&void 0===this.message?.userFlagStatus&&this.message.channel?.canFlag&&!this.message?.chatWebhookEvent&&!this.message?.deletedAt}get canRebakeMessage(){return this.currentUser.staff&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDeleteMessage(){return this.canDelete&&!this.message?.deletedAt&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDelete(){return this.currentUser.id===this.message.user.id?this.message.channel?.canDeleteSelf:this.message.channel?.canDeleteOthers}get composer(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadComposer:this.chatChannelComposer}get secondaryActions(){const e=[]
return e.push({id:"copyLink",name:p.default.t("chat.copy_link"),icon:"link"}),this.site.mobileView&&e.push({id:"copyText",name:p.default.t("chat.copy_text"),icon:"clipboard"}),this.canEdit&&e.push({id:"edit",name:p.default.t("chat.edit"),icon:"pencil-alt"}),this.pane.selectingMessages||e.push({id:"select",name:p.default.t("chat.select"),icon:"tasks"}),this.canFlagMessage&&e.push({id:"flag",name:p.default.t("chat.flag"),icon:"flag"}),this.canDeleteMessage&&e.push({id:"delete",name:p.default.t("chat.delete"),icon:"trash-alt"}),this.canRestoreMessage&&e.push({id:"restore",name:p.default.t("chat.restore"),icon:"undo"}),this.canRebakeMessage&&e.push({id:"rebake",name:p.default.t("chat.rebake_message"),icon:"sync-alt"}),e.reject((e=>F.has(e.id)))}select(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]
this.message.selected=e,this.pane.onSelectMessage(this.message)}bulkSelect(e){const t=this.message.manager,i=[t.findIndexOfMessage(this.pane.lastSelectedMessage.id),t.findIndexOfMessage(this.message.id)].sort(((e,t)=>e-t))
for(let n=i[0];n<=i[1];n++)t.messages[n].selected=e}copyText(){(0,c.clipboardCopy)(this.message.message),this.toasts.success({duration:3e3,data:{message:p.default.t("chat.text_copied")}})}copyLink(){const{protocol:e,host:t}=window.location,i=this.message.channel.id,n=this.message.thread?.id
let r
r=this.context===m.MESSAGE_CONTEXT_THREAD&&n?(0,d.default)(`/chat/c/-/${i}/t/${n}/${this.message.id}`):(0,d.default)(`/chat/c/-/${i}/${this.message.id}`),r=0===r.indexOf("/")?e+"//"+t+r:r,(0,c.clipboardCopy)(r),this.toasts.success({duration:1500,data:{message:p.default.t("chat.link_copied")}})}react(e,t){if(this.chat.userCanInteractWithChat&&!this.pane.reacting)return this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5),this.site.mobileView&&(this.chat.activeMessage=null),t===f.REACTIONS.add&&this.chatEmojiReactionStore.track(`:${e}:`),this.pane.reacting=!0,this.message.react(e,t,this.currentUser,this.currentUser.id),this.chatApi.publishReaction(this.message.channel.id,this.message.id,e,t).catch((t=>{(0,o.popupAjaxError)(t),this.message.react(e,f.REACTIONS.remove,this.currentUser,this.currentUser.id)})).finally((()=>{this.pane.reacting=!1}))}toggleBookmark(){this.modal.show(a.default,{model:{bookmark:new l.BookmarkFormData(this.message.bookmark||u.default.createFor(this.currentUser,"Chat::Message",this.message.id)),afterSave:e=>{const t=u.default.create(e)
this.message.bookmark=t,this.appEvents.trigger("bookmarks:changed",e,t.attachedTo())},afterDelete:()=>{this.message.bookmark=null}}})}flag(){const e=new g.default(this.message.channel,this.message)
e.username=this.message.user?.username,e.user_id=this.message.user?.id,this.modal.show(s.default,{model:{flagTarget:new b.default((0,i.getOwner)(this)),flagModel:e,setHidden:()=>e.set("hidden",!0)}})}delete(){return this.chatApi.trashMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}restore(){return this.chatApi.restoreMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}rebake(){return this.chatApi.rebakeMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}reply(){this.composer.replyTo(this.message)}edit(){this.composer.edit(this.message)}openEmojiPicker(e,t){let{target:i}=t
const n={didSelectEmoji:this.selectReaction,trigger:i,context:"chat-channel-message"}
this.chatEmojiPickerManager.open(n)}selectReaction(e){this.chat.userCanInteractWithChat&&this.react(e,f.REACTIONS.add)}handleSecondaryActions(e){this[e](this.message)}},y=R(v.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=R(v.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=R(v.prototype,"chat",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=R(v.prototype,"chatEmojiReactionStore",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=R(v.prototype,"chatEmojiPickerManager",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=R(v.prototype,"chatChannelComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=R(v.prototype,"chatThreadComposer",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=R(v.prototype,"chatChannelPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=R(v.prototype,"chatThreadPane",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=R(v.prototype,"chatApi",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=R(v.prototype,"currentUser",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=R(v.prototype,"site",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=R(v.prototype,"router",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=R(v.prototype,"modal",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=R(v.prototype,"capabilities",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=R(v.prototype,"toasts",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=R(v.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=R(v.prototype,"context",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R(v.prototype,"react",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"react"),v.prototype),R(v.prototype,"toggleBookmark",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"toggleBookmark"),v.prototype),R(v.prototype,"flag",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"flag"),v.prototype),R(v.prototype,"delete",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"delete"),v.prototype),R(v.prototype,"restore",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"restore"),v.prototype),R(v.prototype,"rebake",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"rebake"),v.prototype),R(v.prototype,"reply",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"reply"),v.prototype),R(v.prototype,"edit",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"edit"),v.prototype),R(v.prototype,"openEmojiPicker",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"openEmojiPicker"),v.prototype),R(v.prototype,"selectReaction",[h.bind],Object.getOwnPropertyDescriptor(v.prototype,"selectReaction"),v.prototype),R(v.prototype,"handleSecondaryActions",[n.action],Object.getOwnPropertyDescriptor(v.prototype,"handleSecondaryActions"),v.prototype),v)})),define("discourse/plugins/chat/discourse/lib/chat-messages-loader",["exports","@glimmer/tracking","@ember/application","@ember/service","discourse/lib/ajax-error","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=new WeakSet,m=new WeakSet,b=new WeakSet,o=class{constructor(e,t){f(this,b),f(this,m),f(this,p),g(this,"chatApi",l,this),g(this,"loading",c,this),g(this,"canLoadMorePast",u,this),g(this,"canLoadMoreFuture",d,this),g(this,"fetchedOnce",h,this),(0,i.setOwner)(this,e),this.model=t}get loadedPast(){return!1===this.canLoadMorePast&&this.fetchedOnce}async loadMore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(!1===this.canLoadMoreFuture&&e.direction===a.FUTURE)return
if(!1===this.canLoadMorePast&&e.direction===a.PAST)return
const t=v(this,b,j).call(this,e.direction,this.model)
let i
e={direction:e.direction,page_size:a.DEFAULT_MESSAGE_PAGE_SIZE,target_message_id:t?.id},e=v(this,m,_).call(this,e)
try{this.loading=!0,i=await v(this,p,w).call(this,e),this.canLoadMoreFuture=i.meta.can_load_more_future,this.canLoadMorePast=i.meta.can_load_more_past}catch(n){(0,r.popupAjaxError)(n)}finally{this.loading=!1}return i}async load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.canLoadMorePast=!0,this.canLoadMoreFuture=!0,this.fetchedOnce=!1,this.loading=!0,t.page_size??=a.DEFAULT_MESSAGE_PAGE_SIZE,t=v(this,m,_).call(this,t)
try{e=await v(this,p,w).call(this,t),this.canLoadMoreFuture=e.meta.can_load_more_future,this.canLoadMorePast=e.meta.can_load_more_past,this.fetchedOnce=!0}catch(i){(0,r.popupAjaxError)(i)}finally{this.loading=!1}return e}},l=y(o.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(o.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=y(o.prototype,"canLoadMorePast",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=y(o.prototype,"canLoadMoreFuture",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=y(o.prototype,"fetchedOnce",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o)
function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.model instanceof s.default?this.chatApi.channelMessages(this.model.id,e):this.chatApi.channelThreadMessages(this.model.channel.id,this.model.id,e)}function _(e){return Object.keys(e).filter((t=>null!=e[t])).reduce(((t,i)=>({...t,[i]:e[i]})),{})}function j(e,t){return e===a.PAST?t.messagesManager.messages.find((e=>!e.staged)):t.messagesManager.messages.findLast((e=>!e.staged))}})),define("discourse/plugins/chat/discourse/lib/chat-messages-manager",["exports","@glimmer/tracking","@ember/application"],(function(e,t,i){"use strict"
var n,r
function a(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class{constructor(e){var t,n,a,s
t=this,n="messages",s=this,(a=r)&&Object.defineProperty(t,n,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0}),(0,i.setOwner)(this,e)}get stagedMessages(){return this.messages.filterBy("staged")}get selectedMessages(){return this.messages.filterBy("selected")}clearSelectedMessages(){this.selectedMessages.forEach((e=>e.selected=!1))}clear(){this.messages=[]}addMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
this.messages=this.messages.concat(e).uniqBy("id").sort(((e,t)=>e.createdAt-t.createdAt))}findMessage(e){return this.messages.find((t=>t.id===parseInt(e,10)))}findFirstMessageOfDay(e){return this.messages.find((t=>e.getFullYear()===t.createdAt.getFullYear()&&e.getMonth()===t.createdAt.getMonth()&&e.getDate()===t.createdAt.getDate()))}removeMessage(e){return this.messages.removeObject(e)}findStagedMessage(e){return this.stagedMessages.find((t=>t.id===e))}findIndexOfMessage(e){return this.messages.findIndex((t=>t.id===e))}findLastMessage(){return this.messages.findLast((e=>!e.deletedAt))}findLastUserMessage(e){return this.messages.findLast((t=>t.user.id===e.id&&!t.deletedAt))}},r=a(n.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a(n.prototype,"stagedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"stagedMessages"),n.prototype),a(n.prototype,"selectedMessages",[t.cached],Object.getOwnPropertyDescriptor(n.prototype,"selectedMessages"),n.prototype),n)})),define("discourse/plugins/chat/discourse/lib/chat-notification-levels",["exports","discourse/lib/notification-levels"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.threadNotificationButtonLevels=void 0
e.threadNotificationButtonLevels=[t.NotificationLevels.TRACKING,t.NotificationLevels.REGULAR].map(t.buttonDetails)})),define("discourse/plugins/chat/discourse/lib/chat-threads-manager",["exports","@glimmer/tracking","@ember/application","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/plugins/chat/discourse/models/chat-thread"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b
function g(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(p=new WeakSet,m=new WeakSet,b=new WeakSet,o=class{constructor(e){f(this,b),f(this,m),f(this,p),g(this,"chatTrackingStateManager",l,this),g(this,"chatChannelsManager",c,this),g(this,"chatApi",u,this),g(this,"_cached",d,this),g(this,"_unreadThreadOverview",h,this),(0,i.setOwner)(this,e)}get unreadThreadCount(){return this.unreadThreadOverview.size}get unreadThreadOverview(){return this._unreadThreadOverview}set unreadThreadOverview(e){this._unreadThreadOverview.clear()
for(const[t,i]of Object.entries(e))this.markThreadUnread(t,i)}markThreadUnread(e,t){this.unreadThreadOverview.set(parseInt(e,10),new Date(t))}get threads(){return Object.values(this._cached)}async find(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fetchIfNotFound:!0}
const n=v(this,m,_).call(this,t)
return n?a.default.resolve(n):i.fetchIfNotFound?v(this,b,j).call(this,e,t):a.default.resolve()}remove(e){delete this._cached[e.id]}add(e,t){let i
return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).replace||(i=v(this,m,_).call(this,t.id)),i||(i=t instanceof s.default?t:s.default.create(e,t),v(this,p,w).call(this,i)),t?.meta?.message_bus_last_ids?.thread_message_bus_last_id&&(i.threadMessageBusLastId=t.meta.message_bus_last_ids.thread_message_bus_last_id),i}},l=y(o.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=y(o.prototype,"chatChannelsManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=y(o.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=y(o.prototype,"_cached",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new r.TrackedObject}}),h=y(o.prototype,"_unreadThreadOverview",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new r.TrackedMap}}),y(o.prototype,"threads",[t.cached],Object.getOwnPropertyDescriptor(o.prototype,"threads"),o.prototype),o)
function w(e){this._cached[e.id]=e}function _(e){return this._cached[e]}async function j(e,t){return this.chatApi.thread(e,t).then((t=>this.chatChannelsManager.find(e).then((e=>e.threadsManager.add(e,t.thread)))))}})),define("discourse/plugins/chat/discourse/lib/chat-user-preferences",["exports","discourse/plugins/chat/discourse/controllers/preferences-chat"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.hasChatIndicator=function(e){const i=e.user_option.chat_header_indicator_preference
return{ALL_NEW:i===t.HEADER_INDICATOR_PREFERENCE_ALL_NEW,DM_AND_MENTIONS:i===t.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,ONLY_MENTIONS:i===t.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,NEVER:i===t.HEADER_INDICATOR_PREFERENCE_NEVER}}})),define("discourse/plugins/chat/discourse/lib/check-message-visibility",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.checkMessageBottomVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().bottom-i<=e.clientHeight+1},e.checkMessageTopVisibility=function(e,t){const i=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().top-i>=-1}}))
define("discourse/plugins/chat/discourse/lib/collection",["exports","@glimmer/tracking","rsvp","discourse/lib/ajax","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
let a
var s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=new WeakSet,a=Symbol.iterator,s=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
p(this,d),h(this,"items",o,this),h(this,"meta",l,this),h(this,"loading",c,this),h(this,"fetchedOnce",u,this),this._resourceURL=e,this._handler=t,this._params=i,this._fetchedAll=!1}get loadMoreURL(){return this.meta?.load_more_url}get totalRows(){return this.meta?.total_rows}get length(){return this.items?.length}[a](){let e=0
return{next:()=>e<this.length?{value:this.items[e++],done:!1}:{done:!0}}}load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.loading||this._fetchedAll||this.totalRows&&this.items.length>=this.totalRows)return i.Promise.resolve()
if(this.loading=!0,this.loadMoreURL)e=this.loadMoreURL
else{const i=Object.entries(t).filter((e=>{let[,t]=e
return void 0!==t})),n=new URLSearchParams(i).toString()
e=this._resourceURL+(n?`?${n}`:"")}return function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,b).call(this,e).then((e=>{const i=this._handler(e)
i.length&&(this.items=(this.items??[]).concat(i)),(!i.length||i.length<t.limit)&&(this._fetchedAll=!0),this.meta=e.meta,this.fetchedOnce=!0})).finally((()=>{this.loading=!1}))}},o=m(s.prototype,"items",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=m(s.prototype,"meta",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c=m(s.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=m(s.prototype,"fetchedOnce",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(s.prototype,"load",[r.bind],Object.getOwnPropertyDescriptor(s.prototype,"load"),s.prototype),s)
function b(e){return(0,n.ajax)(e,{type:"GET",data:this._params})}})),define("discourse/plugins/chat/discourse/lib/dates-separators-positioner",["exports","@ember/runloop"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{static apply(e){(0,t.schedule)("afterRender",(()=>{const t=[...e.querySelectorAll(".chat-message-separator-date")].reverse(),i=e.querySelector(".chat-messages-container").clientHeight
t.map(((e,n)=>{const r={bottom:0,date:e},a=e.nextElementSibling
if(n>0){const e=t[n-1].nextElementSibling
r.bottom=i-e.offsetTop}if(1===t.length)r.height=i
else if(0===n)r.height=i-a.offsetTop
else{const e=t[n-1].nextElementSibling
r.height=i-a.offsetTop-(i-e.offsetTop)}return r})).forEach((e=>{e.date.style.bottom=e.bottom+"px",e.date.style.height=e.height+"px"}))}))}}})),define("discourse/plugins/chat/discourse/lib/fabricators",["exports","discourse/models/bookmark","discourse/models/category","discourse/models/group","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction","discourse/plugins/chat/discourse/models/chat-thread","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let d=0
function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||p(),i=o.default.create(t,Object.assign({id:e.id||d++,user:e.user||g(),message:e.message||"@discobot **abc**defghijklmnopqrstuvwxyz [discourse](discourse.org) :rocket: ",created_at:e.created_at||moment()},e)),n=i.message.toString()
return n.length<=50?i.excerpt=n:i.excerpt=n.slice(0,50)+"...",i}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.id||d++,n=e.chatable||m(),r=a.default.create({id:t,chatable_type:(n instanceof i.default?a.CHATABLE_TYPES.categoryChannel:a.CHATABLE_TYPES.directMessageChannel)||n?.type||e.chatable_type,chatable_id:n?.id||e.chatable_id,title:e.title?e.title:n instanceof i.default?"General":null,description:e.description,chatable:n,status:e.status||a.CHANNEL_STATUSES.open,slug:n?.slug||n instanceof i.default?"general":null,meta:Object.assign({can_delete_self:!0},e.meta||{}),archive_failed:e.archive_failed??!1,memberships_count:e.memberships_count??0})
return r.lastMessage=h({channel:r}),r}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return i.default.create({id:e.id||d++,color:e.color||"D56353",read_restricted:e.read_restricted??!1,name:e.name||"General",slug:e.slug||"general"})}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return s.default.create({group:e.group??!1,users:e.users??[g(),g()]})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return r.default.create({id:e.id||d++,username:e.username||"hawk",name:e.name,avatar_template:"/letter_avatar_proxy/v3/letter/t/41988e/{size}.png",suspended_till:e.suspended_till})}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return u.default.create({last_reply_id:e.last_reply_id||d++,last_reply_created_at:e.last_reply_created_at||Date.now(),last_reply_excerpt:e.last_reply_excerpt||"This is a reply",participant_count:e.participant_count??0,participant_users:e.participant_users??[]})}e.default={bookmark:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return t.default.create({id:e.id||d++})},user:g,channel:p,directMessageChannel:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.chatable||b({id:e.chatable_id||d++,group:e.group??!1,users:e.users})
return p(Object.assign(e,{chatable_type:a.CHATABLE_TYPES.directMessageChannel,chatable_id:t.id,chatable:t,memberships_count:t.users.length}))},message:h,thread:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||p()
return c.default.create(t,{id:e.id||d++,title:e.title,original_message:e.original_message||h({channel:t}),preview:e.preview||f({channel:t})})},threadPreview:f,reaction:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return l.default.create({count:e.count??1,users:e.users||[g()],emoji:e.emoji||"heart",reacted:e.reacted??!1})},upload:function(){return{extension:"jpeg",filesize:126177,height:800,human_filesize:"123 KB",id:202,original_filename:"avatar.PNG.jpg",retain_hours:null,short_path:"/images/avatar.png",short_url:"upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",thumbnail_height:320,thumbnail_width:690,url:"/images/avatar.png",width:1920}},category:m,directMessage:b,group:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return n.default.create({name:e.name||"Engineers"})}}})),define("discourse/plugins/chat/discourse/lib/get-reaction-text",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_DISPLAYED_USERNAMES=void 0,e.getReactionText=function(e,i){if(0===e.count)return
return e.reacted?function(e,i){if(1===e.count)return t.default.t("chat.reactions.only_you",{emoji:e.emoji})
const a=n(e.users,i)
if(2===e.count)return t.default.t("chat.reactions.you_and_single_user",{emoji:e.emoji,username:a.pop()})
const s=e.count-a.length-1
if(s>0)return t.default.t("chat.reactions.you_multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:r(a),count:s})
return t.default.t("chat.reactions.you_and_multiple_users",{emoji:e.emoji,username:a.pop(),commaSeparatedUsernames:r(a)})}(e,i):function(e,i){const a=n(e.users,i)
if(1===e.count)return t.default.t("chat.reactions.single_user",{emoji:e.emoji,username:a.pop()})
const s=e.count-a.length
if(s>0)return t.default.t("chat.reactions.multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:r(a),count:s})
return t.default.t("chat.reactions.multiple_users",{emoji:e.emoji,username:a.pop(),commaSeparatedUsernames:r(a)})}(e,i)}
const i=e.MAX_DISPLAYED_USERNAMES=15
function n(e,t){return e.filter((e=>e.id!==t?.id)).slice(0,i).mapBy("username")}function r(e){return e.join(t.default.t("word_connector.comma"))}})),define("discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getUserChatSeparateSidebarMode=function(e){let t=e?.get("user_option.chat_separate_sidebar_mode")
"default"===t&&(t=e.siteSettings.chat_separate_sidebar_mode)
return{never:"never"===t,always:"always"===t,fullscreen:"fullscreen"===t}}})),define("discourse/plugins/chat/discourse/lib/hashtag-types/channel",["exports","@ember/service","discourse/lib/hashtag-types/base","discourse-common/lib/icon-library"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chatChannelsManager",a,this),o(this,"currentUser",s,this)}get type(){return"channel"}get preloadedData(){return this.currentUser?this.chatChannelsManager.publicMessageChannels:[]}generateColorCssClasses(e){return[`.d-icon.hashtag-color--${this.type}-${e.id} { color: var(--category-${e.chatable.id}-color); }`]}generateIconHTML(e){const t=parseInt(e.id,10),i=this.preloadedData.mapBy("id").includes(t)?`hashtag-color--${this.type}-${e.id}`:"hashtag-missing"
return(0,n.iconHTML)(e.icon,{class:i})}},a=l(r.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/lib/init-sidebar-state",["exports","discourse/lib/sidebar/panels","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.CHAT_PANEL=void 0,e.initSidebarState=function(e,n){if(e.getSidebarPanel()?.key===t.ADMIN_PANEL)return
e.setSidebarPanel(t.MAIN_PANEL)
const r=(0,i.getUserChatSeparateSidebarMode)(n)
r.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):r.always?e.setSeparatedSidebarMode():(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())}
e.CHAT_PANEL="chat"})),define("discourse/plugins/chat/discourse/lib/scroll-helpers",["exports","@ember/runloop","discourse/plugins/chat/discourse/lib/chat-ios-hacks"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.scrollListToBottom=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:0,behavior:"auto"})}))},e.scrollListToMessage=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{highlight:!1,position:"start",autoExpand:!1}
if(!n)return
n?.deletedAt&&r.autoExpand&&(n.expanded=!0);(0,t.schedule)("afterRender",(()=>{const t=e.querySelector(`.chat-message-container[data-id='${n.id}']`)
t&&(r.highlight&&n.highlight(),(0,i.stackingContextFix)(e,(()=>{t.scrollIntoView({behavior:"auto",block:r.position||"center"})})))}))},e.scrollListToTop=function(e){(0,i.stackingContextFix)(e,(()=>{e.scrollTo({top:-e.scrollHeight,behavior:"auto"})}))}})),define("discourse/plugins/chat/discourse/lib/slugify-channel",["exports","discourse/lib/utilities"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(e.slug)return e.slug
if(!e.escapedTitle&&!e.title)return"-"
const i=(0,t.slugify)(e.escapedTitle||e.title),n=(i.length?i:e.title.trim().toLowerCase().replace(/\s|_+/g,"-")).slice(0,100)
if(!n)return"-"
return n}})),define("discourse/plugins/chat/discourse/lib/textarea-interactor",["exports","@ember/application","@ember/destroyable","@ember/object","@ember/runloop","@ember/service","discourse/mixins/textarea-text-manipulation"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class extends(n.default.extend(s.default)){constructor(e,n){super(...arguments),d(this,"capabilities",l,this),d(this,"site",c,this),d(this,"siteSettings",u,this),(0,t.setOwner)(this,e),this.textarea=n,this._textarea=n,this.element=this._textarea,this.ready=!0,this.composerFocusSelector=`#${n.id}`,this.init(),this.composerEventPrefix=null,this.textarea.addEventListener("paste",this.paste),(0,i.registerDestructor)(this,(e=>e.teardown()))}teardown(){this.textarea.removeEventListener("paste",this.paste)}set value(e){this._textarea.value=e
const t=new Event("input",{bubbles:!0,cancelable:!0})
this._textarea.dispatchEvent(t)}blur(){(0,r.next)((()=>{(0,r.schedule)("afterRender",(()=>{this._textarea.blur()}))}))}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ensureAtEnd:!1,refreshHeight:!0,addText:null};(0,r.next)((()=>{(0,r.schedule)("afterRender",(()=>{e.refreshHeight&&this.refreshHeight(),e.ensureAtEnd&&this.ensureCaretAtEnd(),this.capabilities.isIpadOS||this.site.mobileView||(e.addText&&this.addText(this.getSelected(),e.addText),this.focusTextArea())}))}))}ensureCaretAtEnd(){(0,r.schedule)("afterRender",(()=>{this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)}))}refreshHeight(){(0,r.schedule)("afterRender",(()=>{this._textarea.style.height="auto",this._textarea.style.height=this._textarea.scrollHeight+1+"px"}))}},l=h(o.prototype,"capabilities",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(o.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(o.prototype,"siteSettings",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/lib/transform-auto-links",["exports","discourse/lib/hashtag-decorator","discourse-common/lib/get-url"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){const r=n.parseFromString(e,"text/html")
return function(e){(e.querySelectorAll("span.mention")||[]).forEach((e=>{let t=document.createElement("a"),n=document.createTextNode(e.innerText)
t.classList.add("mention"),t.appendChild(n),t.href=(0,i.default)(`/u/${e.innerText.substring(1)}`),e.replaceWith(t)}))}(r),function(e){(e.querySelectorAll("span.hashtag-raw")||[]).forEach((e=>{(0,t.generatePlaceholderHashtagHTML)("category",e,{id:-1,text:"...",relative_url:"/",slug:"",icon:"square-full"})}))}(r),r.body.innerHTML}
const n=new DOMParser})),define("discourse/plugins/chat/discourse/lib/zoom-check",["exports","discourse-common/config/environment"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return!(0,t.isTesting)()&&1!==visualViewport?.scale&&document.documentElement.clientWidth/window.innerWidth!=1}})),define("discourse/plugins/chat/discourse/models/chat-channel-archive",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
l(this,"failed",n,this),l(this,"completed",r,this),l(this,"messages",a,this),l(this,"topicId",s,this),l(this,"totalMessages",o,this),this.failed=e.archive_failed,this.completed=e.archive_completed,this.messages=e.archived_messages,this.topicId=e.archive_topic_id,this.totalMessages=e.total_messages}},n=c(i.prototype,"failed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=c(i.prototype,"completed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c(i.prototype,"messages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(i.prototype,"topicId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(i.prototype,"totalMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/models/chat-channel",["exports","@glimmer/tracking","pretty-text/guid","discourse/lib/utilities","discourse/models/category","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/chat-threads-manager","discourse/plugins/chat/discourse/lib/slugify-channel","discourse/plugins/chat/discourse/models/chat-channel-archive","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-channel-membership"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h,p){"use strict"
var m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D
function A(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function N(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function I(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function L(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.CHATABLE_TYPES=e.CHANNEL_STATUSES=void 0,e.channelStatusIcon=function(e){if(e===R.open)return null
switch(e){case R.closed:return"lock"
case R.readOnly:return"comment-slash"
case R.archived:return"archive"}},e.default=void 0
const U=e.CHATABLE_TYPES={directMessageChannel:"DirectMessage",categoryChannel:"Category"},R=e.CHANNEL_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
const F=[R.readOnly,R.archived],B=[R.closed,R.readOnly,R.archived]
e.default=(D=new WeakSet,m=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
N(this,D),A(this,"title",b,this),A(this,"slug",g,this),A(this,"description",f,this),A(this,"status",v,this),A(this,"activeThread",y,this),A(this,"meta",w,this),A(this,"chatableId",_,this),A(this,"chatableType",j,this),A(this,"chatableUrl",M,this),A(this,"autoJoinUsers",z,this),A(this,"allowChannelWideMentions",O,this),A(this,"membershipsCount",C,this),A(this,"archive",k,this),A(this,"tracking",S,this),A(this,"threadingEnabled",P,this),A(this,"draft",T,this),I(this,"threadsManager",new o.default((0,a.getOwnerWithFallback)(this))),I(this,"messagesManager",new s.default((0,a.getOwnerWithFallback)(this))),A(this,"_currentUserMembership",E,this),A(this,"_lastMessage",x,this),this.id=e.id,this.chatableId=e.chatable_id,this.chatableUrl=e.chatable_url,this.chatableType=e.chatable_type,this.membershipsCount=e.memberships_count,this.slug=e.slug,this.title=e.title,this.status=e.status,this.description=e.description
this.threadingEnabled=e.threading_enabled,this.autoJoinUsers=e.auto_join_users,this.allowChannelWideMentions=e.allow_channel_wide_mentions,this.chatable=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,D,W).call(this,e.chatable||[]),this.currentUserMembership=e.current_user_membership,(e.archive_completed||e.archive_failed)&&(this.archive=c.default.create(e)),this.tracking=new h.default((0,a.getOwnerWithFallback)(this)),this.lastMessage=e.last_message,this.meta=e.meta}get unreadThreadsCountSinceLastViewed(){return Array.from(this.threadsManager.unreadThreadOverview.values()).filter((e=>e>=this.currentUserMembership.lastViewedAt)).length}get unreadThreadsCount(){return Array.from(this.threadsManager.unreadThreadOverview.values()).length}updateLastViewedAt(){this.currentUserMembership.lastViewedAt=new Date}get canDeleteSelf(){return this.meta.can_delete_self}get canDeleteOthers(){return this.meta.can_delete_others}get canFlag(){return this.meta.can_flag}get userSilenced(){return this.meta.user_silenced}get canModerate(){return this.meta.can_moderate}get escapedTitle(){return(0,n.escapeExpression)(this.title)}get escapedDescription(){return(0,n.escapeExpression)(this.description)}get slugifiedTitle(){return this.slug||(0,l.default)(this)}get routeModels(){return[this.slugifiedTitle,this.id]}get isDirectMessageChannel(){return this.chatableType===U.directMessageChannel}get isCategoryChannel(){return this.chatableType===U.categoryChannel}get isOpen(){return!this.status||this.status===R.open}get isReadOnly(){return this.status===R.readOnly}get isClosed(){return this.status===R.closed}get isArchived(){return this.status===R.archived}get isJoinable(){return this.isOpen&&!this.isArchived}get isFollowing(){return this.currentUserMembership.following}get canJoin(){return this.meta.can_join_chat_channel}async stageMessage(e){e.id=(0,i.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt=new Date,e.channel=this,e.inReplyTo&&this.threadingEnabled||this.messagesManager.addMessages([e]),e.manager=this.messagesManager}resetDraft(e){this.draft=d.default.createDraftMessage(this,{user:e})}canModifyMessages(e){return e.staff?!F.includes(this.status):!B.includes(this.status)}get currentUserMembership(){return this._currentUserMembership}set currentUserMembership(e){e instanceof p.default?this._currentUserMembership=e:this._currentUserMembership=p.default.create(e)}get lastMessage(){return this._lastMessage}set lastMessage(e){e?e instanceof d.default?this._lastMessage=e:this._lastMessage=d.default.create(this,e):this._lastMessage=null}},b=L(m.prototype,"title",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=L(m.prototype,"slug",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=L(m.prototype,"description",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=L(m.prototype,"status",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=L(m.prototype,"activeThread",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=L(m.prototype,"meta",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=L(m.prototype,"chatableId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=L(m.prototype,"chatableType",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=L(m.prototype,"chatableUrl",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=L(m.prototype,"autoJoinUsers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=L(m.prototype,"allowChannelWideMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C=L(m.prototype,"membershipsCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=L(m.prototype,"archive",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=L(m.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=L(m.prototype,"threadingEnabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=L(m.prototype,"draft",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=L(m.prototype,"_currentUserMembership",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=L(m.prototype,"_lastMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m)
function W(e){return!e||e instanceof r.default||e instanceof u.default?e:this.isDirectMessageChannel?u.default.create({users:e?.users,group:e?.group}):r.default.create(e)}})),define("discourse/plugins/chat/discourse/models/chat-chatable",["exports","@glimmer/tracking","@ember/service","discourse/models/category","discourse/models/group","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static createUser(t){return new e({type:"user",model:t,identifier:`u-${t.id}`})}static createGroup(t){return new e({type:"group",model:t,identifier:`g-${t.id}`})}static createChannel(t){return new e({type:"channel",model:t,identifier:`c-${t.id}`})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
switch(m(this,"chatChannelsManager",l,this),m(this,"identifier",c,this),m(this,"type",u,this),m(this,"model",d,this),m(this,"enabled",h,this),m(this,"tracking",p,this),this.identifier=e.identifier,this.type=e.type,this.type){case"channel":if(1===e.model.chatable?.users?.length&&(this.enabled=e.model.chatable?.users[0].has_chat_enabled),e.model instanceof s.default){this.model=e.model
break}this.model=s.default.create(e.model)
break
case"user":if(this.enabled=e.model.has_chat_enabled,e.model instanceof a.default){this.model=e.model
break}this.model=a.default.create(e.model)
break
case"group":if(this.enabled=e.model.can_chat,e.model instanceof r.default){this.model=e.model
break}this.model=r.default.create(e.model)}}get isUser(){return"user"===this.type}get isGroup(){return"group"===this.type}get isCategory(){return this instanceof n.default}},l=b(o.prototype,"chatChannelsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=b(o.prototype,"identifier",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(o.prototype,"type",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(o.prototype,"model",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=b(o.prototype,"enabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),p=b(o.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)})),define("discourse/plugins/chat/discourse/models/chat-direct-message",["exports","@glimmer/tracking","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
c(this,o),l(this,"users",a,this),l(this,"group",s,this),u(this,"type",n.CHATABLE_TYPES.directMessageChannel),this.group=e.group??!1,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,o,h).call(this,e.users||[])}},a=d(r.prototype,"users",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s=d(r.prototype,"group",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)
function h(e){return e.map((e=>!e||e instanceof i.default?e:i.default.create(e)))}})),define("discourse/plugins/chat/discourse/models/chat-message-reaction",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.REACTIONS=void 0
e.REACTIONS={add:"add",remove:"remove"}
e.default=(c=new WeakSet,r=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,c),u(this,"count",a,this),u(this,"reacted",s,this),u(this,"users",o,this),u(this,"emoji",l,this),this.count=e.count,this.emoji=e.emoji,this.users=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,c,p).call(this,e.users),this.reacted=e.reacted}},a=h(r.prototype,"count",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=h(r.prototype,"reacted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=h(r.prototype,"users",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=h(r.prototype,"emoji",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)
function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
return new i.TrackedArray(e.map((e=>e instanceof n.default?e:n.default.create(e))))}})),define("discourse/plugins/chat/discourse/models/chat-message",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/lib/text","discourse/models/bookmark","discourse/models/user","discourse-common/lib/get-owner","discourse-common/lib/later","discourse/plugins/chat/discourse/lib/transform-auto-links","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x,D,A,N,I,L,U,R,F,B,W,H,$,V,G,q,K,J,Y
function Z(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function X(e,t){Q(e,t),t.add(e)}function Q(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ee(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function te(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function ie(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(G=new WeakSet,q=new WeakMap,K=new WeakSet,J=new WeakSet,Y=new WeakSet,V=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static createDraftMessage(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return i.draft=!0,e.create(t,i)}constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
var a,s,o
X(this,Y),X(this,J),X(this,K),o={get:le,set:void 0},Q(a=this,s=q),s.set(a,o),X(this,G),Z(this,"id",d,this),Z(this,"error",h,this),Z(this,"selected",p,this),Z(this,"channel",m,this),Z(this,"staged",b,this),Z(this,"processed",g,this),Z(this,"draftSaved",f,this),Z(this,"draft",v,this),Z(this,"createdAt",y,this),Z(this,"uploads",w,this),Z(this,"excerpt",_,this),Z(this,"reactions",j,this),Z(this,"reviewableId",M,this),Z(this,"user",z,this),Z(this,"inReplyTo",O,this),Z(this,"expanded",C,this),Z(this,"bookmark",k,this),Z(this,"userFlagStatus",S,this),Z(this,"hidden",P,this),Z(this,"version",T,this),Z(this,"edited",E,this),Z(this,"editing",x,this),Z(this,"chatWebhookEvent",D,this),Z(this,"mentionWarning",A,this),Z(this,"availableFlags",N,this),Z(this,"newest",I,this),Z(this,"highlighted",L,this),Z(this,"firstOfResults",U,this),Z(this,"message",R,this),Z(this,"manager",F,this),Z(this,"deletedById",B,this),Z(this,"_deletedAt",W,this),Z(this,"_cooked",H,this),Z(this,"_thread",$,this),this.id=n.id,this.channel=t,this.manager=n.manager,this.newest=n.newest||!1,this.draftSaved=n.draftSaved||n.draft_saved||!1,this.firstOfResults=n.firstOfResults||n.first_of_results||!1,this.staged=n.staged||!1,this.processed=n.processed||!0,this.edited=n.edited||!1,this.editing=n.editing||!1,this.availableFlags=n.availableFlags||n.available_flags,this.hidden=n.hidden||!1,this.chatWebhookEvent=n.chatWebhookEvent||n.chat_webhook_event,this.createdAt=n.created_at?new Date(n.created_at):new Date(n.createdAt),this.deletedById=n.deletedById||n.deleted_by_id,this._deletedAt=n.deletedAt||n.deleted_at,this.expanded=!this.hidden&&!this._deletedAt&&(n.expanded||!0)
this.excerpt=n.excerpt,this.reviewableId=n.reviewableId||n.reviewable_id,this.userFlagStatus=n.userFlagStatus||n.user_flag_status,this.draft=n.draft,this.message=n.message||"",this._cooked=n.cooked||"",this.inReplyTo=n.inReplyTo||(n.in_reply_to||n.replyToMsg?e.create(t,n.in_reply_to||n.replyToMsg):null),this.reactions=te(this,K,ce).call(this,n.reactions),this.uploads=new i.TrackedArray(n.uploads||[]),this.user=te(this,Y,de).call(this,n.user),this.bookmark=n.bookmark?r.default.create(n.bookmark):null,this.mentionedUsers=te(this,J,ue).call(this,n.mentioned_users),n.thread&&(this.thread=n.thread)}get persisted(){return!!this.id&&!this.staged}get replyable(){return!this.staged&&!this.error}get editable(){return!this.staged&&!this.error}get thread(){return this._thread}set thread(e){this._thread=e?this.channel.threadsManager.add(this.channel,e,{replace:!0}):null}get deletedAt(){return this._deletedAt}set deletedAt(e){this._deletedAt=e,this.incrementVersion()}get cooked(){return this._cooked}set cooked(e){e!==this._cooked&&(this._cooked=e,this.incrementVersion())}async cook(){this.isDestroyed||this.isDestroying||(await te(this,G,oe).call(this),this.cooked=e.cookFunction(this.message))}get read(){return this.channel.currentUserMembership?.lastReadMessageId>=this.id}get index(){return this.manager?.messages?.indexOf(this)}get previousMessage(){return this.manager?.messages?.objectAt?.(this.index-1)}get nextMessage(){return this.manager?.messages?.objectAt?.(this.index+1)}highlight(){this.highlighted=!0,(0,o.default)((()=>{this.isDestroying||this.isDestroyed||(this.highlighted=!1)}),2e3)}incrementVersion(){this.version++}async parseMentions(){return await(0,n.parseMentions)(this.message,ee(this,q))}toJSONDraft(){if(0===this.message?.length&&0===this.uploads?.length&&!this.inReplyTo)return null
const e={}
return this.uploads?.length>0&&(e.uploads=this.uploads),this.message?.length>0&&(e.message=this.message),this.inReplyTo&&(e.replyToMsg={id:this.inReplyTo.id,excerpt:this.inReplyTo.excerpt,user:{id:this.inReplyTo.user.id,name:this.inReplyTo.user.name,avatar_template:this.inReplyTo.user.avatar_template,username:this.inReplyTo.user.username}}),this.editing&&(e.editing=!0,e.id=this.id,e.excerpt=this.excerpt),JSON.stringify(e)}react(e,t,i,n){const r=i.id===n,a=this.reactions.find((t=>t.emoji===e))
if(a)if("add"===t){if(r&&a.reacted)return
if(a.users.find((e=>e.id===i.id)))return
a.count=a.count+1,r&&(a.reacted=!0),a.users.pushObject(i)}else{const e=a.users.find((e=>e.id===i.id))
if(!e)return
r&&(a.reacted=!1),1===a.count?this.reactions.removeObject(a):(a.count=a.count-1,a.users.removeObject(e))}else"add"===t&&this.reactions.pushObject(c.default.create({count:1,emoji:e,reacted:r,users:[i]}))}},ne=V,ae=null,(re="symbol"==typeof(se=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(re="cookFunction","string"))?se:String(se))in ne?Object.defineProperty(ne,re,{value:ae,enumerable:!0,configurable:!0,writable:!0}):ne[re]=ae,d=ie((u=V).prototype,"id",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=ie(u.prototype,"error",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=ie(u.prototype,"selected",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=ie(u.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=ie(u.prototype,"staged",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=ie(u.prototype,"processed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=ie(u.prototype,"draftSaved",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=ie(u.prototype,"draft",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=ie(u.prototype,"createdAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=ie(u.prototype,"uploads",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=ie(u.prototype,"excerpt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=ie(u.prototype,"reactions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=ie(u.prototype,"reviewableId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=ie(u.prototype,"user",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=ie(u.prototype,"inReplyTo",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=ie(u.prototype,"expanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),k=ie(u.prototype,"bookmark",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=ie(u.prototype,"userFlagStatus",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=ie(u.prototype,"hidden",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ie(u.prototype,"version",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),E=ie(u.prototype,"edited",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=ie(u.prototype,"editing",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=ie(u.prototype,"chatWebhookEvent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new i.TrackedObject}}),A=ie(u.prototype,"mentionWarning",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=ie(u.prototype,"availableFlags",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=ie(u.prototype,"newest",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=ie(u.prototype,"highlighted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=ie(u.prototype,"firstOfResults",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=ie(u.prototype,"message",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=ie(u.prototype,"manager",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=ie(u.prototype,"deletedById",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=ie(u.prototype,"_deletedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=ie(u.prototype,"_cooked",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=ie(u.prototype,"_thread",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie(u.prototype,"index",[t.cached],Object.getOwnPropertyDescriptor(u.prototype,"index"),u.prototype),ie(u.prototype,"previousMessage",[t.cached],Object.getOwnPropertyDescriptor(u.prototype,"previousMessage"),u.prototype),ie(u.prototype,"nextMessage",[t.cached],Object.getOwnPropertyDescriptor(u.prototype,"nextMessage"),u.prototype),u)
var ne,re,ae,se
async function oe(){if(V.cookFunction)return
const e=await(0,n.generateCookFunction)(ee(this,q))
V.cookFunction=t=>(0,l.default)(e(t))}function le(){const e=(0,s.getOwnerWithFallback)(this).lookup("service:site")
return{featuresOverride:e.markdown_additional_options?.chat?.limited_pretty_text_features,markdownItRules:e.markdown_additional_options?.chat?.limited_pretty_text_markdown_rules,hashtagTypesInPriorityOrder:e.hashtag_configurations?.["chat-composer"],hashtagIcons:e.hashtag_icons}}function ce(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>c.default.create(e)))}function ue(e){const t=new Map
return e&&e.forEach((e=>{const i=a.default.create(e)
t.set(i.id,i)})),t}function de(e){return!e||e instanceof a.default?e:a.default.create(e)}})),define("discourse/plugins/chat/discourse/models/chat-notice",["exports","@glimmer/tracking"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
a(this,"channelId",n,this),a(this,"textContent",r,this),this.channelId=e.channel_id,this.textContent=e.text_content,this.type=e.notice_type,this.data=e.data}},n=s(i.prototype,"channelId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"textContent",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/models/chat-thread-preview",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u
function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
d(this,"replyCount",r,this),d(this,"lastReplyId",a,this),d(this,"lastReplyCreatedAt",s,this),d(this,"lastReplyExcerpt",o,this),d(this,"lastReplyUser",l,this),d(this,"participantCount",c,this),d(this,"participantUsers",u,this),e||(e={}),this.replyCount=e.reply_count||e.replyCount||0,this.lastReplyId=e.last_reply_id||e.lastReplyId,this.lastReplyCreatedAt=new Date(e.last_reply_created_at||e.lastReplyCreatedAt),this.lastReplyExcerpt=e.last_reply_excerpt||e.lastReplyExcerpt,this.lastReplyUser=e.last_reply_user||e.lastReplyUser,this.participantCount=e.participant_count||e.participantCount||0,this.participantUsers=new i.TrackedArray(e.participant_users||e.participantUsers||[])}get otherParticipantCount(){return this.participantCount-this.participantUsers.length}},r=h(n.prototype,"replyCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=h(n.prototype,"lastReplyId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=h(n.prototype,"lastReplyCreatedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=h(n.prototype,"lastReplyExcerpt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(n.prototype,"lastReplyUser",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(n.prototype,"participantCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=h(n.prototype,"participantUsers",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/models/chat-thread",["exports","@glimmer/tracking","pretty-text/guid","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-thread-membership"],(function(e,t,i,n,r,a,s,o,l){"use strict"
var c,u,d,h,p,m,b,g,f,v,y,w,_
function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.THREAD_STATUSES=void 0
e.THREAD_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
e.default=(c=class e{static create(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
j(this,"id",u,this),j(this,"title",d,this),j(this,"status",h,this),j(this,"draft",p,this),j(this,"staged",m,this),j(this,"channel",b,this),j(this,"originalMessage",g,this),j(this,"threadMessageBusLastId",f,this),j(this,"replyCount",v,this),j(this,"tracking",y,this),j(this,"currentUserMembership",w,this),j(this,"preview",_,this),M(this,"messagesManager",new r.default((0,n.getOwnerWithFallback)(this))),this.id=t.id,this.channel=e,this.status=t.status,this.staged=t.staged,this.replyCount=t.reply_count,this.originalMessage=t.original_message?a.default.create(e,t.original_message):null,this.originalMessage&&(this.originalMessage.thread=this),this.title=t.title,t.current_user_membership&&(this.currentUserMembership=l.default.create(t.current_user_membership)),this.tracking=new o.default((0,n.getOwnerWithFallback)(this)),this.preview=s.default.create(t.preview)}resetDraft(e){this.draft=a.default.createDraftMessage(this.channel,{user:e,thread:this})}async stageMessage(e){e.id=(0,i.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt=new Date,e.thread=this,this.messagesManager.addMessages([e]),e.manager=this.messagesManager}get routeModels(){return[...this.channel.routeModels,this.id]}},u=z(c.prototype,"id",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=z(c.prototype,"title",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=z(c.prototype,"status",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=z(c.prototype,"draft",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=z(c.prototype,"staged",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=z(c.prototype,"channel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=z(c.prototype,"originalMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=z(c.prototype,"threadMessageBusLastId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=z(c.prototype,"replyCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=z(c.prototype,"tracking",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=z(c.prototype,"currentUserMembership",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=z(c.prototype,"preview",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c)})),define("discourse/plugins/chat/discourse/models/chat-tracking-state",["exports","@glimmer/tracking","@ember/application","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
l(this,"chatTrackingStateManager",a,this),l(this,"_unreadCount",s,this),l(this,"_mentionCount",o,this),(0,i.setOwner)(this,e),this._unreadCount=t.unreadCount||0,this._mentionCount=t.mentionCount||0}reset(){this._unreadCount=0,this._mentionCount=0}get unreadCount(){return this._unreadCount}set unreadCount(e){this._unreadCount!==e&&(this._unreadCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}get mentionCount(){return this._mentionCount}set mentionCount(e){this._mentionCount!==e&&(this._mentionCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}},a=c(r.prototype,"chatTrackingStateManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"_unreadCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=c(r.prototype,"_mentionCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r)})),define("discourse/plugins/chat/discourse/models/user-chat-channel-membership",["exports","@glimmer/tracking","discourse/models/user"],(function(e,t,i){"use strict"
var n,r,a,s,o,l,c,u,d
function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(d=new WeakSet,n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
p(this,d),h(this,"following",r,this),h(this,"muted",a,this),h(this,"desktopNotificationLevel",s,this),h(this,"mobileNotificationLevel",o,this),h(this,"lastReadMessageId",l,this),h(this,"lastViewedAt",c,this),h(this,"user",u,this),this.following=e.following,this.muted=e.muted,this.desktopNotificationLevel=e.desktop_notification_level,this.mobileNotificationLevel=e.mobile_notification_level,this.lastReadMessageId=e.last_read_message_id,this.lastViewedAt=new Date(e.last_viewed_at),this.user=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,d,b).call(this,e.user)}},r=m(n.prototype,"following",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=m(n.prototype,"muted",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=m(n.prototype,"desktopNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=m(n.prototype,"mobileNotificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=m(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=m(n.prototype,"lastViewedAt",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=m(n.prototype,"user",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)
function b(e){return!e||e instanceof i.default?e:i.default.create(e)}})),define("discourse/plugins/chat/discourse/models/user-chat-thread-membership",["exports","@glimmer/tracking","discourse/lib/notification-levels"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class e{static create(){return new e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
s(this,"lastReadMessageId",r,this),s(this,"notificationLevel",a,this),this.lastReadMessageId=e.last_read_message_id,this.notificationLevel=e.notification_level}get isQuiet(){return this.notificationLevel===i.NotificationLevels.REGULAR||this.notificationLevel===i.NotificationLevels.MUTED}},r=o(n.prototype,"lastReadMessageId",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=o(n.prototype,"notificationLevel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n)})),define("discourse/plugins/chat/discourse/modifiers/chat/emoji-picker-scroll-listener",["exports","@ember/destroyable","@ember/service","ember-modifier"],(function(e,t,i,n){"use strict"
var r,a
function s(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(e,i){var n,r,o,l
super(e,i),n=this,r="emojiPickerScrollObserver",l=this,(o=a)&&Object.defineProperty(n,r,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(l):void 0}),s(this,"element",null),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.element=e,this.emojiPickerScrollObserver.observe(e)}cleanup(){this.emojiPickerScrollObserver.unobserve(this.element)}},o=r.prototype,l="emojiPickerScrollObserver",c=[i.inject],u={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),a=h,r)
var o,l,c,u,d,h})),define("discourse/plugins/chat/discourse/modifiers/chat/later-fn",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.handler=(0,r.default)((()=>{i?.(e)}),n)}cleanup(){(0,i.cancel)(this.handler)}}e.default=a})),define("discourse/plugins/chat/discourse/modifiers/chat/on-animation-end",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[n]=t
this.element=e,this.fn=n,this.handler=(0,i.schedule)("afterRender",(()=>{this.element.addEventListener("animationend",this.handleAnimationEnd)}))}handleAnimationEnd(){this.isDestroying||this.isDestroyed||this.fn?.(this.element)}cleanup(){(0,i.cancel)(this.handler),this.element?.removeEventListener("animationend",this.handleAnimationEnd)}},s=a.prototype,o="handleAnimationEnd",l=[r.bind],c=Object.getOwnPropertyDescriptor(a.prototype,"handleAnimationEnd"),u=a.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/modifiers/chat/on-long-press",["exports","@ember/destroyable","@ember/runloop","@ember/service","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function h(e){e.stopPropagation()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o=class extends r.default{constructor(e,i){super(e,i),u(this,"capabilities",l,this),u(this,"site",c,this),(0,t.registerDestructor)(this,(e=>e.cleanup()))}get enabled(){return this.capabilities.touch&&this.site.mobileView}modify(e,t){let[i,n,r]=t
this.enabled&&(this.element=e,this.onLongPressStart=i||(()=>{}),this.onLongPressEnd=n||(()=>{}),this.onLongPressCancel=r||(()=>{}),this.element.addEventListener("touchstart",this.handleTouchStart,{passive:!0}))}onCancel(){(0,i.cancel)(this.timeout),this.capabilities.touch&&(this.element.removeEventListener("touchmove",this.onCancel,{passive:!0}),this.element.removeEventListener("touchend",this.onCancel),this.element.removeEventListener("touchcancel",this.onCancel)),this.onLongPressCancel(this.element)}handleTouchStart(e){e.touches.length>1?this.onCancel():(this.onLongPressStart(this.element,e),this.element.addEventListener("touchmove",this.onCancel,{passive:!0}),this.element.addEventListener("touchend",this.onCancel),this.element.addEventListener("touchcancel",this.onCancel),this.timeout=(0,a.default)((()=>{this.isDestroying||this.isDestroyed||(this.element.addEventListener("touchend",h,{once:!0,passive:!0}),this.onLongPressEnd(this.element,e))}),400))}cleanup(){this.enabled&&(this.element.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.onCancel())}},l=d(o.prototype,"capabilities",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=d(o.prototype,"site",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d(o.prototype,"onCancel",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"onCancel"),o.prototype),d(o.prototype,"handleTouchStart",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"handleTouchStart"),o.prototype),o)})),define("discourse/plugins/chat/discourse/modifiers/chat/on-resize",["exports","@ember/destroyable","@ember/runloop","ember-modifier"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[n,r={}]=t
this.resizeObserver=new ResizeObserver((e=>{this.throttleHandler=(0,i.throttle)(this,n,e,r.delay??0,r.immediate??!1)})),this.resizeObserver.observe(e)}cleanup(){(0,i.cancel)(this.throttleHandler),this.resizeObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/on-scroll",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.element=e,this.callback=i,this.options=n,this.element.addEventListener("scroll",this.throttledCallback,{passive:!0})}throttledCallback(e){this.throttledHandler=(0,i.throttle)(this,this.callback,e,this.options.delay??100,this.options.immediate??!1)}cleanup(){(0,i.cancel)(this.throttledHandler),this.element.removeEventListener("scroll",this.throttledCallback)}},s=a.prototype,o="throttledCallback",l=[r.bind],c=Object.getOwnPropertyDescriptor(a.prototype,"throttledCallback"),u=a.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a)
var s,o,l,c,u,d}))
define("discourse/plugins/chat/discourse/modifiers/chat/resizable-node",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a
function s(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(o((a=class extends n.default{constructor(e,i){super(e,i),s(this,"element",null),s(this,"resizerSelector",null),s(this,"didResizeContainer",null),s(this,"options",null),s(this,"_originalWidth",0),s(this,"_originalHeight",0),s(this,"_originalX",0),s(this,"_originalY",0),s(this,"_originalPageX",0),s(this,"_originalPageY",0),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n,r={}]=t
this.resizerSelector=i,this.element=e,this.didResizeContainer=n,this.options=Object.assign({vertical:!0,horizontal:!0,position:!0,mutate:!0,resetOnWindowResize:!1},r),this.element.querySelector(this.resizerSelector)?.addEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.addEventListener("mousedown",this._startResize),window.addEventListener("resize",this._resizeWindow)}cleanup(){this.element.querySelector(this.resizerSelector)?.removeEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.removeEventListener("mousedown",this._startResize),window.removeEventListener("resize",this._resizeWindow),(0,i.cancel)(this._throttledResizeHandler)}_startResize(e){e.preventDefault(),this._minimumWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-width").replace("px","")||20),this._minimumHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-height").replace("px","")||20),this._originalWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("width").replace("px","")),this._originalHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("height").replace("px","")),this._originalX=this.element.getBoundingClientRect().left,this._originalY=this.element.getBoundingClientRect().top,this._originalPageX=this._eventValueForProperty(e,"pageX"),this._originalPageY=this._eventValueForProperty(e,"pageY"),window.addEventListener("touchmove",this._resize),window.addEventListener("touchend",this._stopResize),window.addEventListener("mousemove",this._resize),window.addEventListener("mouseup",this._stopResize)}_resize(e){let t=this._originalWidth,i=this._eventValueForProperty(e,"pageX")-this._originalPageX
t=document.documentElement.classList.contains("rtl")?Math.ceil(t+i):Math.ceil(t-i)
const n=Math.ceil(this._originalHeight-(this._eventValueForProperty(e,"pageY")-this._originalPageY)),r={}
this.options.horizontal&&t>=this._minimumWidth&&(r.width=t+"px",this.options.position&&(r.left=Math.ceil(this._originalX+(this._eventValueForProperty(e,"pageX")-this._originalPageX))+"px")),this.options.vertical&&n>=this._minimumHeight&&(r.height=n+"px",this.options.position&&(r.top=Math.ceil(this._originalY+(this._eventValueForProperty(e,"pageY")-this._originalPageY))+"px")),this.options.mutate&&Object.assign(this.element.style,r),this.didResizeContainer?.(this.element,{width:t>=this._minimumWidth?t:this._minimumWidth,height:n>=this._minimumHeight?n:this._minimumHeight})}_resizeWindow(){this.options.resetOnWindowResize&&(this._throttledResizeHandler=(0,i.throttle)(this,this._throttledResize,100))}_throttledResize(){const e={}
this.options.vertical&&(e.height="auto"),this.options.horizontal&&(e.width="auto"),Object.assign(this.element.style,e)}_stopResize(){window.removeEventListener("touchmove",this._resize),window.removeEventListener("touchend",this._stopResize),window.removeEventListener("mousemove",this._resize),window.removeEventListener("mouseup",this._stopResize)}_eventValueForProperty(e,t){return e.changedTouches?e.changedTouches[0][t]:e[t]}}).prototype,"_startResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_startResize"),a.prototype),o(a.prototype,"_resize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_resize"),a.prototype),o(a.prototype,"_resizeWindow",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_resizeWindow"),a.prototype),o(a.prototype,"_throttledResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_throttledResize"),a.prototype),o(a.prototype,"_stopResize",[r.bind],Object.getOwnPropertyDescriptor(a.prototype,"_stopResize"),a.prototype),a)})),define("discourse/plugins/chat/discourse/modifiers/chat/scrollable-list",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators","discourse/plugins/chat/discourse/lib/check-message-visibility"],(function(e,t,i,n,r,a,s){"use strict"
var o
function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c="down"
e.default=(l((o=class extends n.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i]=t
this.element=e,this.options=i,this.lastScrollTop=this.computeInitialScrollTop(),this.element.addEventListener("scroll",this.handleScroll,{passive:!0}),this.element.addEventListener("wheel",this.handleWheel,{passive:!0})}handleScroll(){this.throttleComputeScroll()}handleWheel(){this.throttleComputeScroll()}computeScroll(){const e=this.element.scrollTop
this.options.onScroll?.(this.computeState()),this.lastScrollTop=e}throttleComputeScroll(){(0,i.cancel)(this.scrollTimer),this.throttleTimer=(0,i.throttle)(this,this.computeScroll,50,!0),this.scrollTimer=(0,r.default)((()=>{this.options.onScrollEnd?.(Object.assign(this.computeState(),{lastVisibleId:this.computeFirstVisibleMessageId()}))}),this.options.delay||250)}cleanup(){(0,i.cancel)(this.scrollTimer),(0,i.cancel)(this.throttleTimer),this.element.removeEventListener("scroll",this.handleScroll),this.element.removeEventListener("wheel",this.handleWheel)}computeState(){const e=this.computeScrollDirection(),t=this.computeDistanceToBottom(),i=this.computeDistanceToTop()
return{up:"up"===e,down:e===c,distanceToBottom:t,distanceToTop:i,atBottom:t.pixels<=1,atTop:i.pixels<=1}}computeInitialScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight:this.element.scrollTop}computeScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop:this.element.scrollTop}computeDistanceToTop(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?t-Math.abs(this.element.scrollTop):Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeDistanceToBottom(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?-this.element.scrollTop:t-Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeScrollDirection(){return this.element.scrollTop===this.lastScrollTop?null:this.element.scrollTop<this.lastScrollTop?"up":c}computeFirstVisibleMessageId(){let e
const t=this.element.querySelectorAll(":scope .chat-messages-container > [data-id]")
for(let n=t.length-1;n>=0;n--){const i=t[n]
if((0,s.checkMessageBottomVisibility)(this.element,i)){e=i
break}}const i=e?.dataset?.id
return i?parseInt(i,10):null}}).prototype,"handleScroll",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"handleScroll"),o.prototype),l(o.prototype,"handleWheel",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"handleWheel"),o.prototype),l(o.prototype,"computeScroll",[a.bind],Object.getOwnPropertyDescriptor(o.prototype,"computeScroll"),o.prototype),o)})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message-separator-date",["exports","@ember/destroyable","ember-modifier"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n="is-pinned"
class r extends i.default{constructor(e,i){super(e,i),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.intersectionObserver=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(n):t.target.classList.remove(n)}),{threshold:[0,1]}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}}e.default=r})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message",["exports","@ember/destroyable","ember-modifier","discourse-common/utils/decorators"],(function(e,t,i,n){"use strict"
var r
function a(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(e,i){super(e,i),a(this,"didEnterViewport",null),a(this,"didLeaveViewport",null),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[i,n]=t
this.didEnterViewport=i,this.didLeaveViewport=n,this.intersectionObserver=new IntersectionObserver(this._intersectionObserverCallback,{root:document,threshold:0}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}_intersectionObserverCallback(e){e.forEach((e=>{e.isIntersecting?this.didEnterViewport?.():this.didLeaveViewport?.()}))}},s=r.prototype,o="_intersectionObserverCallback",l=[n.bind],c=Object.getOwnPropertyDescriptor(r.prototype,"_intersectionObserverCallback"),u=r.prototype,d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/pre-initializers/chat-plugin-api",["exports","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/services/chat-state-manager"],(function(e,t,i,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-api",after:"inject-discourse-objects",initialize(){(0,t.withPluginApi)("1.2.0",(e=>{const t=Object.getPrototypeOf(e)
t.hasOwnProperty("decorateChatMessage")||Object.defineProperty(t,"decorateChatMessage",{value(e){(0,i.addChatMessageDecorator)(e)}}),t.hasOwnProperty("registerChatComposerButton")||Object.defineProperty(t,"registerChatComposerButton",{value(e){(0,n.registerChatComposerButton)(e)}}),t.hasOwnProperty("addChatDrawerStateCallback")||Object.defineProperty(t,"addChatDrawerStateCallback",{value(e){(0,a.addChatDrawerStateCallback)(e)}}),t.hasOwnProperty("sendChatMessage")||Object.defineProperty(t,"sendChatMessage",{async value(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.container.lookup("service:chat-api").sendMessage(e,{thread_id:t.threadId,message:t.message,uploads:t.uploads})}}),t.hasOwnProperty("removeChatComposerSecondaryActions")||Object.defineProperty(t,"removeChatComposerSecondaryActions",{value(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];(0,r.removeChatComposerSecondaryActions)(t)}})}))},teardown(){(0,i.resetChatMessageDecorators)()}}})),define("discourse/plugins/chat/discourse/preferences-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.preferences",map(){this.route("chat")}}})),define("discourse/plugins/chat/discourse/routes/admin-plugins-chat",["exports","@ember/object","discourse/lib/ajax","discourse/routes/discourse","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends n.default{model(){return this.currentUser?.admin?(0,i.ajax)("/admin/plugins/chat.json").then((e=>(e.incoming_chat_webhooks=e.incoming_chat_webhooks.map((e=>t.default.create(e))),e.chat_channels=e.chat_channels.map((e=>r.default.create(e))),e))):{model:null}}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-browse-archived",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"router",r,this),s(this,"siteSettings",a,this)}afterModel(){this.siteSettings.chat_allow_archiving_channels||this.router.replaceWith("chat.browse")}},r=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-browse-index",["exports","@ember/service","discourse/lib/utilities","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),l(this,"chat",a,this),l(this,"siteSettings",s,this),l(this,"router",o,this)}beforeModel(){if(!this.siteSettings.enable_public_channels)return this.router.transitionTo(`discovery.${(0,i.defaultHomepage)()}`)}activate(){this.chat.activeChannel=null}afterModel(){this.router.replaceWith("chat.browse.open")}},a=c(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel-decorator",["exports","@ember/service"],(function(e,t){"use strict"
function i(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function n(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var r,a,s,o
return r=class extends e{constructor(){super(...arguments),i(this,"chatChannelsManager",a,this),i(this,"chat",s,this),i(this,"router",o,this)}async model(e){return this.chatChannelsManager.find(e.channelId)}titleToken(){if(this.currentModel)return this.currentModel.isDirectMessageChannel?`${this.currentModel.title}`:`#${this.currentModel.title}`}afterModel(e){if(super.afterModel?.(...arguments),this.chat.activeChannel=e,!e)return this.router.replaceWith("chat")
let{channelTitle:t}=this.paramsFor(this.routeName)
if(t&&t!==e.slugifiedTitle){if("chat.channel.info"===this.routeName)return this.router.replaceWith("chat.channel.info",...e.routeModels)
const t=this.paramsFor("chat.channel.near-message").messageId,i=this.paramsFor("chat.channel.thread").threadId
if(i){const t=this.paramsFor("chat.channel.thread.near-message").messageId
t?this.router.replaceWith("chat.channel.thread.near-message",...e.routeModels,i,t):this.router.replaceWith("chat.channel.thread",...e.routeModels,i)}else t?this.router.replaceWith("chat.channel.near-message",...e.routeModels,t):this.router.replaceWith("chat.channel",...e.routeModels)}else this.controllerFor("chat-channel").set("targetMessageId",null)}},a=n(r.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=n(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=n(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r}})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}afterModel(){this.router.replaceWith("chat.channel.info.settings")}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-members",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}afterModel(e){if(!e.isOpen)return this.router.replaceWith("chat.channel.info.settings")}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-info",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i,n,r){"use strict"
var a,s,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,r.default)((s=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatChannelInfoRouteOriginManager",n=this,(i=o)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}activate(e){const t=e?.from?.name
t&&(this.chatChannelInfoRouteOriginManager.origin=t.startsWith("chat.browse")?n.ORIGINS.browse:n.ORIGINS.channel)}deactivate(){this.chatChannelInfoRouteOriginManager.origin=null}},l=s.prototype,c="chatChannelInfoRouteOriginManager",u=[t.inject],d={configurable:!0,enumerable:!0,writable:!0,initializer:null},p={},Object.keys(d).forEach((function(e){p[e]=d[e]})),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(l,c,p),p=null),o=p,a=s))||a
var l,c,u,d,h,p})),define("discourse/plugins/chat/discourse/routes/chat-channel-legacy",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}redirect(){const{channelTitle:e,channelId:t,messageId:i}=this.paramsFor(this.routeName)
this.router.replaceWith("chat.channel",e,t,{queryParams:{messageId:i}})}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel"),{messageId:t}=this.paramsFor(this.routeName)
this.controllerFor("chat-channel").set("messageId",null),(t||this.controllerFor("chat-channel").get("targetMessageId"))&&this.controllerFor("chat-channel").set("targetMessageId",t),this.router.replaceWith("chat.channel",...e.routeModels)}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="router",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}beforeModel(){const e=this.modelFor("chat-channel-thread"),{messageId:t}=this.paramsFor(this.routeName);(t||this.controllerFor("chat-channel-thread").get("targetMessageId"))&&this.controllerFor("chat-channel-thread").set("targetMessageId",t),this.router.replaceWith("chat.channel.thread",...e.routeModels)}},a=n.prototype,s="router",o=[t.inject],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),c(this,"router",a,this),c(this,"chatStateManager",s,this),c(this,"chat",o,this),c(this,"chatThreadPane",l,this)}model(e,t){const i=this.modelFor("chat.channel")
return i.threadsManager.find(i.id,e.threadId).catch((()=>{t.abort(),this.chatStateManager.closeSidePanel(),this.router.transitionTo("chat.channel",...i.routeModels)}))}afterModel(e){this.chat.activeChannel.activeThread=e}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
const{messageId:i}=this.paramsFor(this.routeName+".near-message")
!i&&this.controllerFor("chat-channel-thread").get("targetMessageId")&&this.controllerFor("chat-channel-thread").set("targetMessageId",null),this.chatStateManager.openSidePanel()}},a=u(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=u(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(r.prototype,"chatThreadPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(r.prototype,"willTransition",[t.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel-threads",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,i,n){"use strict"
var r,a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),c(this,"router",a,this),c(this,"chatThreadListPane",s,this),c(this,"chatStateManager",o,this),c(this,"chat",l,this)}beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
this.chatStateManager.openSidePanel()}activate(){this.chat.activeMessage=null}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}},a=u(r.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=u(r.prototype,"chatThreadListPane",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(r.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=u(r.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(r.prototype,"activate",[t.action],Object.getOwnPropertyDescriptor(r.prototype,"activate"),r.prototype),u(r.prototype,"willTransition",[t.action],Object.getOwnPropertyDescriptor(r.prototype,"willTransition"),r.prototype),r)})),define("discourse/plugins/chat/discourse/routes/chat-channel",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,i,n){"use strict"
var r,a,s,o
function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,n.default)((a=class extends i.default{constructor(){super(...arguments),l(this,"site",s,this),l(this,"router",o,this)}redirect(e){if(this.site.mobileView)return
const t=this.paramsFor("chat.channel.near-message").messageId,i=this.paramsFor("chat.channel.thread").threadId
!t&&!i&&e.threadsManager.unreadThreadCount>0&&this.router.transitionTo("chat.channel.threads",...e.routeModels)}},s=c(a.prototype,"site",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=c(a.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=a))||r})),define("discourse/plugins/chat/discourse/routes/chat-channels",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"chatChannelsManager",a,this)}activate(){this.chat.activeChannel=null}model(){return this.chatChannelsManager.publicMessageChannels}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-direct-messages",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"chatChannelsManager",a,this)}activate(){this.chat.activeChannel=null}model(){return this.chatChannelsManager.directMessageChannels}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-draft-channel",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}beforeModel(){this.chat.userCanDirectMessage||this.router.transitionTo("chat")}activate(){this.chat.activeChannel=null}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),o(this,"chat",r,this),o(this,"chatChannelsManager",a,this),o(this,"router",s,this)}activate(){this.chat.activeChannel=null}redirect(){if(this.site.mobileView)return this.router.replaceWith("chat.channels")
const e=this.chat.getIdealFirstChannelId()
return e?this.chatChannelsManager.find(e).then((e=>this.router.replaceWith("chat.channel",...e.routeModels))):this.router.replaceWith("chat.browse")}},r=l(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l(n.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat-threads",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"chatStateManager",a,this)}activate(){this.chat.activeChannel=null,this.chatStateManager.closeSidePanel()}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"chatStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/routes/chat",["exports","@ember/runloop","@ember/service","discourse/lib/plugin-api","discourse/lib/utilities","discourse/mixins/scroll-top","discourse/routes/discourse","discourse-i18n","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(u=class extends s.default{constructor(){super(...arguments),b(this,"chat",d,this),b(this,"router",h,this),b(this,"chatStateManager",p,this),b(this,"currentUser",m,this)}titleToken(){return o.default.t("chat.title_capitalized")}beforeModel(e){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,r.defaultHomepage)()}`)
if(e.from&&this.chatStateManager.isDrawerPreferred&&["chat.channel","chat.direct-messages","chat.channels","chat.threads","chat.channel.thread","chat.channel.thread.index","chat.channel.thread.near-message","chat.channel.threads","chat.channel.index","chat.channel.near-message","chat.channel-legacy","chat","chat.index"].includes(e.targetName)){e.abort()
let t=e.intent.url
return e.targetName.startsWith("chat.channel")?t??=this.router.urlFor(e.targetName,...e.intent.contexts):t??=this.router.urlFor(e.targetName),void this.appEvents.trigger("chat:open-url",t)}this.appEvents.trigger("chat:toggle-close")}activate(){(0,n.withPluginApi)("1.8.0",(e=>{e.setSidebarPanel(c.CHAT_PANEL);(0,l.getUserChatSeparateSidebarMode)(this.currentUser).never?(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setSeparatedSidebarMode()})),this.chatStateManager.storeAppURL(),this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.add("has-full-page-chat"),document.documentElement.classList.add("has-full-page-chat"),(0,a.scrollTop)()}))}deactivate(e){if((0,n.withPluginApi)("1.8.0",(e=>{(0,c.initSidebarState)(e,this.currentUser)})),e){const t=this.router.urlFor(e.from.name)
this.chatStateManager.storeChatURL(t)}this.chat.activeChannel=null,this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.remove("has-full-page-chat"),document.documentElement.classList.remove("has-full-page-chat")}))}},d=g(u.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=g(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=g(u.prototype,"chatStateManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=g(u.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u)})),define("discourse/plugins/chat/discourse/routes/preferences-chat",["exports","@ember/service","discourse/lib/utilities","discourse/routes/restricted-user"],(function(e,t,i,n){"use strict"
var r,a,s,o,l
function c(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),c(this,"chat",a,this),c(this,"router",s,this),c(this,"siteSettings",o,this),c(this,"currentUser",l,this),u(this,"showFooter",!0)}setupController(e,t){if(!this.siteSettings.chat_enabled||!t.can_chat&&!this.currentUser?.admin)return this.router.transitionTo(`discovery.${(0,i.defaultHomepage)()}`)
e.set("model",t)}},a=d(r.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=d(r.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d(r.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)})),define("discourse/plugins/chat/discourse/services/chat-admin-api",["exports","@ember/service","discourse/lib/ajax"],(function(e,t,i){"use strict"
function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var a=new WeakMap,s=new WeakSet
class o extends t.default{constructor(){var e,t
super(...arguments),n(e=this,t=s),t.add(e),function(e,t,i){n(e,t),t.set(e,i)}(this,a,{get:l,set:void 0})}async exportMessages(){await function(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}(this,s,c).call(this,"/export/messages")}}function l(){return"/chat/admin"}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${r(this,a)}${e}`,{type:"POST",data:t})}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/chat/discourse/models/user-chat-channel-membership","discourse/plugins/chat/discourse/lib/collection"],(function(e,t,i,n,r){"use strict"
var a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t){b(e,t),t.add(e)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function f(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function v(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=new WeakMap,c=new WeakSet,u=new WeakSet,d=new WeakSet,h=new WeakSet,a=class extends t.default{constructor(){var e,t,i
super(...arguments),m(this,h),m(this,d),m(this,u),m(this,c),i={get:y,set:void 0},b(e=this,t=l),t.set(e,i),p(this,"chat",s,this),p(this,"chatChannelsManager",o,this)}channel(e){return f(this,c,w).call(this,`/channels/${e}`)}channelThreadMessages(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,c,w).call(this,`/channels/${e}/threads/${t}/messages?${new URLSearchParams(i).toString()}`)}channelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/messages?${new URLSearchParams(t).toString()}`)}flagMessage(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,d,j).call(this,`/channels/${e}/messages/${t}/flags`,i)}thread(e,t){return f(this,c,w).call(this,`/channels/${e}/threads/${t}`)}threads(e,t){return new r.default(`${g(this,l)}/channels/${e}/threads`,t)}channels(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return new r.default(`${g(this,l)}/channels`,(e=>e.channels.map((e=>this.chatChannelsManager.store(e)))),e)}moveChannelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,j).call(this,`/channels/${e}/messages/moves`,{move:t})}destroyChannel(e){return f(this,h,M).call(this,`/channels/${e}`)}createChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,d,j).call(this,"/channels",{channel:e}).then((e=>this.chatChannelsManager.store(e.channel)))}categoryPermissions(e){return f(this,c,w).call(this,`/category-chatables/${e}/permissions`)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`/chat/${e}`,{ignoreUnsent:!1,type:"POST",data:t})}trashMessage(e,t){return f(this,h,M).call(this,`/channels/${e}/messages/${t}`)}createChannelArchive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,d,j).call(this,`/channels/${e}/archives`,{archive:t})}updateChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,_).call(this,`/channels/${e}`,{channel:t})}createThread(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,d,j).call(this,`/channels/${e}/threads`,{title:i.title,original_message_id:t})}updateChannelStatus(e,t){return f(this,u,_).call(this,`/channels/${e}/status`,{status:t})}listChannelMemberships(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return new r.default(`${g(this,l)}/channels/${e}/memberships`,(e=>e.memberships.map((e=>n.default.create(e)))),t)}listCurrentUserChannels(){return f(this,c,w).call(this,"/me/channels")}followChannel(e){return f(this,d,j).call(this,`/channels/${e}/memberships/me`).then((e=>n.default.create(e.membership)))}unfollowChannel(e){return f(this,h,M).call(this,`/channels/${e}/memberships/me/follows`).then((e=>n.default.create(e.membership)))}leaveChannel(e){return f(this,h,M).call(this,`/channels/${e}/memberships/me`)}userThreads(e){return new r.default(`${g(this,l)}/me/threads`,e)}updateCurrentUserChannelNotificationsSettings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,u,_).call(this,`/channels/${e}/notifications-settings/me`,{notifications_settings:t})}updateCurrentUserThreadNotificationsSettings(e,t,i){return f(this,u,_).call(this,`/channels/${e}/threads/${t}/notifications-settings/me`,{notification_level:i.notificationLevel})}saveDraft(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=`/chat/api/channels/${e}`
return n.threadId&&(r+=`/threads/${n.threadId}`),r+="/drafts",(0,i.ajax)(r,{type:"POST",data:{data:t},ignoreUnsent:!1}).then((()=>{this.chat.markNetworkAsReliable()})).catch((e=>{e.jqXHR?.responseJSON?.errors?.length||this.chat.markNetworkAsUnreliable()}))}publishReaction(e,t,n,r){return(0,i.ajax)(`/chat/${e}/react/${t}`,{type:"PUT",data:{react_action:r,emoji:n}})}restoreMessage(e,t){return f(this,u,_).call(this,`/channels/${e}/messages/${t}/restore`)}rebakeMessage(e,t){return(0,i.ajax)(`/chat/${e}/${t}/rebake`,{type:"PUT"})}editMessage(e,t,i){return f(this,u,_).call(this,`/channels/${e}/messages/${t}`,i)}markAllChannelsAsRead(){return f(this,u,_).call(this,"/channels/read")}chatables(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return f(this,c,w).call(this,"/chatables",e)}markChannelAsRead(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return f(this,u,_).call(this,`/channels/${e}/read/${t}`)}markThreadAsRead(e,t){return f(this,u,_).call(this,`/channels/${e}/threads/${t}/read`)}editThread(e,t,i){return f(this,u,_).call(this,`/channels/${e}/threads/${t}`,i)}generateQuote(e,t){return(0,i.ajax)(`/chat/${e}/quote`,{type:"POST",data:{message_ids:t}})}invite(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return f(this,d,j).call(this,`/channels/${e}/invites`,{user_ids:t,message_id:i.messageId})}summarize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return f(this,c,w).call(this,`/channels/${e}/summarize`,t)}addMembersToChannel(e,t){return f(this,d,j).call(this,`/channels/${e}/memberships`,{usernames:t.usernames,groups:t.groups})}},s=v(a.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=v(a.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)
function y(){return"/chat/api"}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"GET",data:t})}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"PUT",data:t})}function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"POST",data:t})}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,i.ajax)(`${g(this,l)}${e}`,{type:"DELETE",data:t})}})),define("discourse/plugins/chat/discourse/services/chat-audio-manager",["exports","@ember/service","discourse-common/config/environment","discourse-common/lib/get-url","discourse-common/utils/decorators"],(function(e,t,i,n,r){"use strict"
var a,s
function o(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CHAT_SOUNDS=void 0
const l=e.CHAT_SOUNDS={bell:[{src:"/plugins/chat/audio/bell.mp3",type:"audio/mpeg"}],ding:[{src:"/plugins/chat/audio/ding.mp3",type:"audio/mpeg"}]}
e.default=(a=(0,r.debounce)(3e3,!0),s=class extends t.default{constructor(){super(...arguments),o(this,"_audioCache",{})}setup(){Object.keys(l).forEach((e=>{this._audioCache[e]=(e=>{const t=new Audio
return t.pause(),e.forEach((e=>{let{type:i,src:r}=e
const a=document.createElement("source")
a.type=i,a.src=(0,n.getURLWithCDN)(r),t.appendChild(a)})),t})(l[e])}))}willDestroy(){super.willDestroy(...arguments),this._audioCache={}}playImmediately(e){return this._play(e)}play(e){return this._play(e)}_play(e){const t=this._audioCache[e]||this._audioCache.bell
return t.muted=(0,i.isTesting)(),t.paused||(t.pause(),"function"==typeof t.fastSeek?t.fastSeek(0):t.currentTime=0),t.play().catch((()=>{(0,i.isTesting)()||console.info("[chat] User needs to interact with DOM before we can play notification sounds.")}))}},c=s.prototype,u="play",d=[a],h=Object.getOwnPropertyDescriptor(s.prototype,"play"),p=s.prototype,m={},Object.keys(h).forEach((function(e){m[e]=h[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(c,u,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(c,u,m),m=null),s)
var c,u,d,h,p,m})),define("discourse/plugins/chat/discourse/services/chat-channel-composer",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=(0,n.inject)("chat-thread-composer"),a=class extends n.default{constructor(){super(...arguments),p(this,"chat",s,this),p(this,"chatApi",o,this),p(this,"currentUser",l,this),p(this,"router",c,this),p(this,"threadComposer",u,this),p(this,"loadingSlider",d,this),p(this,"textarea",h,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea.blur()}edit(e){this.chat.activeMessage=null,e.editing=!0,e.channel.draft=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}async replyTo(e){if(this.chat.activeMessage=null,e.channel.threadingEnabled){if(!e.thread?.id)try{this.loadingSlider.transitionStarted()
const t=await this.chatApi.createThread(e.channel.id,e.id)
e.thread=e.channel.threadsManager.add(e.channel,t)}finally{this.loadingSlider.transitionEnded()}e.channel.resetDraft(this.currentUser),await this.router.transitionTo("chat.channel.thread",...e.thread.routeModels),this.threadComposer.focus({ensureAtEnd:!0,refreshHeight:!0})}else e.channel.draft.inReplyTo=e,this.focus({ensureAtEnd:!0,refreshHeight:!0})}},s=m(a.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=m(a.prototype,"chatApi",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=m(a.prototype,"currentUser",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=m(a.prototype,"router",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=m(a.prototype,"threadComposer",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=m(a.prototype,"loadingSlider",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=m(a.prototype,"textarea",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m(a.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"focus"),a.prototype),m(a.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"blur"),a.prototype),m(a.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"edit"),a.prototype),m(a.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"replyTo"),a.prototype),a)}))
define("discourse/plugins/chat/discourse/services/chat-channel-emoji-picker-manager",["exports","discourse/plugins/chat/discourse/services/chat-emoji-picker-manager"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager",["exports","@ember/service","@ember/utils","discourse/lib/key-value-store"],(function(e,t,i,n){"use strict"
function r(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ORIGINS=e.INFO_ROUTE_NAMESPACE=e.BACK_KEY=void 0
const a=e.BACK_KEY="back",s=e.INFO_ROUTE_NAMESPACE="discourse_chat_info_route",o=e.ORIGINS={channel:"channel",browse:"browse"}
class l extends t.default{constructor(){super(...arguments),r(this,"store",new n.default(s))}get origin(){const e=this.store.getObject(a)
if(e)return o[e]}set origin(e){this.store.setObject({key:a,value:e})}get isBrowse(){return this.origin===o.browse}get isChannel(){return this.origin===o.channel||(0,i.isEmpty)(this.origin)}}e.default=l})),define("discourse/plugins/chat/discourse/services/chat-channel-notices-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","discourse/plugins/chat/discourse/models/chat-notice"],(function(e,t,i,n,r){"use strict"
var a,s
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(a=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="notices",n=this,(i=s)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}handleNotice(e){this.notices.pushObject(r.default.create(e))}clearNotice(e){this.notices.removeObject(e)}},o=a.prototype,l="notices",c=[t.tracked],u={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedArray}},h={},Object.keys(u).forEach((function(e){h[e]=u[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce((function(e,t){return t(o,l,e)||e}),h),d&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(d):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,l,h),h=null),s=h,a)
var o,l,c,u,d,h})),define("discourse/plugins/chat/discourse/services/chat-channel-pane",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),u(this,"chat",a,this),u(this,"reacting",s,this),u(this,"selectingMessages",o,this),u(this,"lastSelectedMessage",l,this),u(this,"sending",c,this)}get channel(){return this.chat.activeChannel}get selectedMessageIds(){return this.channel.messagesManager.selectedMessages.mapBy("id")}cancelSelecting(){this.selectingMessages=!1,this.channel.messagesManager.clearSelectedMessages()}onSelectMessage(e){this.lastSelectedMessage=e,this.selectingMessages=!0}},a=d(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=d(r.prototype,"reacting",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=d(r.prototype,"selectingMessages",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=d(r.prototype,"lastSelectedMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=d(r.prototype,"sending",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d(r.prototype,"cancelSelecting",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"cancelSelecting"),r.prototype),d(r.prototype,"onSelectMessage",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"onSelectMessage"),r.prototype),r)})),define("discourse/plugins/chat/discourse/services/chat-channel-scroll-positions",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="positions",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get(e){return this.positions.get(e)}set(e,t){this.positions.set(e,t)}delete(e){this.positions.has(e)&&this.positions.delete(e)}},s=r.prototype,o="positions",l=[t.tracked],c={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedMap}},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a=d,r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/services/chat-channels-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/lib/ajax-error","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p,m,b,g,f,v
function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(l=(0,s.debounce)(300),b=new WeakSet,g=new WeakSet,f=new WeakSet,v=new WeakSet,c=class extends i.default{constructor(){super(...arguments),w(this,v),w(this,f),w(this,g),w(this,b),y(this,"chatSubscriptionsManager",u,this),y(this,"chatApi",d,this),y(this,"currentUser",h,this),y(this,"router",p,this),y(this,"_cached",m,this)}async find(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetchIfNotFound:!0}
const i=_(this,f,O).call(this,e)
return i?r.default.resolve(i):t.fetchIfNotFound?_(this,b,M).call(this,e):r.default.resolve()}get channels(){return Object.values(this._cached)}store(e){let t
return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).replace||(t=_(this,f,O).call(this,e.id)),t||(t=e instanceof o.default?e:o.default.create(e),_(this,g,z).call(this,t)),void 0!==e.meta?.message_bus_last_ids?.channel_message_bus_last_id&&(t.channelMessageBusLastId=e.meta.message_bus_last_ids.channel_message_bus_last_id),t}async follow(e){return this.chatSubscriptionsManager.startChannelSubscription(e),e.currentUserMembership.following?e:this.chatApi.followChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async unfollow(e){try{return this.chatSubscriptionsManager.stopChannelSubscription(e),e.currentUserMembership=await this.chatApi.unfollowChannel(e.id),e}catch(t){(0,a.popupAjaxError)(t)}}async markAllChannelsRead(){return this.chatApi.markAllChannelsAsRead()}remove(e){this.chatSubscriptionsManager.stopChannelSubscription(e),delete this._cached[e.id]}get allChannels(){return[...this.publicMessageChannels,...this.directMessageChannels].sort(((e,t)=>t?.currentUserMembership?.lastViewedAt?.localeCompare?.(e?.currentUserMembership?.lastViewedAt)))}get publicMessageChannels(){return this.channels.filter((e=>e.isCategoryChannel&&e.currentUserMembership.following)).sort(((e,t)=>e?.slug?.localeCompare?.(t?.slug)))}get directMessageChannels(){return _(this,v,C).call(this,this.channels.filter((e=>{const t=e.currentUserMembership
return e.isDirectMessageChannel&&t.following})))}get truncatedDirectMessageChannels(){return this.directMessageChannels.slice(0,20)}},u=j(c.prototype,"chatSubscriptionsManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=j(c.prototype,"chatApi",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=j(c.prototype,"currentUser",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=j(c.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=j(c.prototype,"_cached",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n.TrackedObject}}),j(c.prototype,"markAllChannelsRead",[l],Object.getOwnPropertyDescriptor(c.prototype,"markAllChannelsRead"),c.prototype),j(c.prototype,"publicMessageChannels",[t.cached],Object.getOwnPropertyDescriptor(c.prototype,"publicMessageChannels"),c.prototype),j(c.prototype,"directMessageChannels",[t.cached],Object.getOwnPropertyDescriptor(c.prototype,"directMessageChannels"),c.prototype),c)
async function M(e){try{const t=await this.chatApi.channel(e)
return this.store(t.channel)}catch(t){(0,a.popupAjaxError)(t)}}function z(e){e&&(this._cached[e.id]=e)}function O(e){return this._cached[e]}function C(e){return e.sort(((e,t)=>e.lastMessage.id?t.lastMessage.id?e.tracking.unreadCount===t.tracking.unreadCount?new Date(e.lastMessage.createdAt)>new Date(t.lastMessage.createdAt)?-1:1:e.tracking.unreadCount>t.tracking.unreadCount?-1:1:-1:1))}})),define("discourse/plugins/chat/discourse/services/chat-composer-presence-manager",["exports","@ember/runloop","@ember/service","discourse-common/config/environment"],(function(e,t,i,n){"use strict"
var r,a
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="presence",n=this,(i=a)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}willDestroy(){this.leave()}notifyState(e,i){i?(this._channelName!==e&&(this._enter(e),this._channelName=e),(0,n.isTesting)()||(this._autoLeaveTimer=(0,t.debounce)(this,this.leave,1e4))):this.leave()}leave(){this._presentChannel?.leave(),this._presentChannel=null,this._channelName=null,this._autoLeaveTimer&&((0,t.cancel)(this._autoLeaveTimer),this._autoLeaveTimer=null)}_enter(e){this.leave(),this._presentChannel=this.presence.getChannel(e),this._presentChannel.enter()}},s=r.prototype,o="presence",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),a=d,r)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/services/chat-composer-warnings-tracker",["exports","@glimmer/tracking","@ember/runloop","@ember/service","discourse/lib/ajax","discourse-common/lib/debounce","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s){"use strict"
var o,l,c,u,d,h,p,m,b,g,f
function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function w(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function j(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const M={invalid:-1,unreachable:0,over_members_limit:1}
e.default=(b=new WeakSet,g=new WeakSet,f=new WeakSet,o=class extends n.default{constructor(){super(...arguments),y(this,f),y(this,g),y(this,b),v(this,"siteSettings",l,this),v(this,"unreachableGroupMentions",c,this),v(this,"overMembersLimitGroupMentions",u,this),v(this,"tooManyMentions",d,this),v(this,"channelWideMentionDisallowed",h,this),v(this,"mentionsCount",p,this),v(this,"mentionsTimer",m,this),w(this,"_mentionWarningsSeen",{})}willDestroy(){(0,i.cancel)(this.mentionsTimer)}reset(){_(this,b,z).call(this),this.mentionsCount=0,(0,i.cancel)(this.mentionsTimer)}trackMentions(e,t){if(t)return this._trackMentions(e)
this.mentionsTimer=(0,a.default)(this,this._trackMentions,e,1e3)}_trackMentions(e){this.siteSettings.enable_mentions&&e.parseMentions().then((t=>{if(this.mentionsCount=t?.length,this.mentionsCount>0){if(this.tooManyMentions=this.mentionsCount>this.siteSettings.max_mentions_per_chat_message,!this.tooManyMentions){const i=t.filter((e=>!(e in this._mentionWarningsSeen)))
this.channelWideMentionDisallowed=!e.channel.allowChannelWideMentions&&(t.includes("here")||t.includes("all")),i?.length>0?_(this,g,O).call(this,i,t):_(this,f,C).call(this,t)}}else _(this,b,z).call(this)}))}},l=j(o.prototype,"siteSettings",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=j(o.prototype,"unreachableGroupMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u=j(o.prototype,"overMembersLimitGroupMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=j(o.prototype,"tooManyMentions",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=j(o.prototype,"channelWideMentionDisallowed",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=j(o.prototype,"mentionsCount",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=j(o.prototype,"mentionsTimer",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j(o.prototype,"reset",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"reset"),o.prototype),j(o.prototype,"trackMentions",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"trackMentions"),o.prototype),j(o.prototype,"_trackMentions",[s.bind],Object.getOwnPropertyDescriptor(o.prototype,"_trackMentions"),o.prototype),o)
function z(){this.tooManyMentions=!1,this.channelWideMentionDisallowed=!1,this.unreachableGroupMentions=[],this.overMembersLimitGroupMentions=[]}function O(e,t){(0,r.ajax)("/chat/api/mentions/groups.json",{data:{mentions:e}}).then((e=>{e.unreachable.forEach((e=>{this._mentionWarningsSeen[e]=M.unreachable})),e.over_members_limit.forEach((e=>{this._mentionWarningsSeen[e]=M.over_members_limit})),e.invalid.forEach((e=>{this._mentionWarningsSeen[e]=M.invalid})),_(this,f,C).call(this,t)})).catch(_(this,f,C).call(this,t))}function C(e){const t=e.reduce(((e,t)=>(t in this._mentionWarningsSeen&&this._mentionWarningsSeen[t]!==M.invalid&&(this._mentionWarningsSeen[t]===M.unreachable?e[0].push(t):e[1].push(t)),e)),[[],[]])
this.unreachableGroupMentions=t[0],this.overMembersLimitGroupMentions=t[1]}})),define("discourse/plugins/chat/discourse/services/chat-drafts-manager",["exports","@ember/runloop","@ember/service"],(function(e,t,i){"use strict"
var n,r
function a(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="chatApi",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),a(this,"drafts",{})}async add(e,t,i){try{this.drafts[this.key(t,i)]=e,await this.persistDraft(e,t,i)}catch(n){console.log("Couldn't save draft",n)}}get(e,t){return this.drafts[this.key(e,t)]}remove(e,t){delete this.drafts[this.key(e,t)]}reset(){this.drafts={}}key(e,t){let i=`c-${e}`
return t&&(i+=`:t-${t}`),i.toString()}async persistDraft(e,t,i){try{await this.chatApi.saveDraft(t,e.toJSONDraft(),{threadId:i}),e.draftSaved=!0}catch(n){}}willDestroy(){(0,t.cancel)(this?._persistHandler)}},s=n.prototype,o="chatApi",l=[i.inject],c={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(c).forEach((function(e){d[e]=c[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=l.slice().reverse().reduce((function(e,t){return t(s,o,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,o,d),d=null),r=d,n)
var s,o,l,c,u,d})),define("discourse/plugins/chat/discourse/services/chat-drawer-router",["exports","@glimmer/tracking","@ember/service","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads","discourse/plugins/chat/discourse/components/chat/drawer-routes/channels","discourse/plugins/chat/discourse/components/chat/drawer-routes/threads"],(function(e,t,i,n,r,a,s,o){"use strict"
var l,c,u,d,h,p
function m(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const g={"chat.channel":{name:n.default},"chat.channel.thread":{name:r.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.index":{name:r.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.near-message":{name:r.default,extractParams:e=>({channelId:e.parent.parent.params.channelId,threadId:e.parent.params.threadId,messageId:e.params.messageId})},"chat.channel.threads":{name:a.default,extractParams:e=>({channelId:e.parent.params.channelId})},"chat.threads":{name:o.default},chat:{name:s.default},"chat.channel.near-message":{name:n.default,extractParams:e=>({channelId:e.parent.params.channelId,messageId:e.params.messageId})},"chat.channel-legacy":{name:n.default,extractParams:e=>({channelId:e.params.channelId,messageId:e.queryParams.messageId})}}
e.default=(l=class extends i.default{constructor(){super(...arguments),m(this,"router",c,this),m(this,"chatHistory",u,this),m(this,"component",d,this),m(this,"drawerRoute",h,this),m(this,"params",p,this)}stateFor(e){this.drawerRoute?.deactivate?.(this.chatHistory.currentRoute),this.chatHistory.visit(e),this.drawerRoute=g[e.name],this.params=this.drawerRoute?.extractParams?.(e)||e.params,this.component=this.drawerRoute?.name||s.default,this.drawerRoute.activate?.(e)}},c=b(l.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=b(l.prototype,"chatHistory",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(l.prototype,"component",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=b(l.prototype,"drawerRoute",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=b(l.prototype,"params",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l)})),define("discourse/plugins/chat/discourse/services/chat-drawer-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_drawer_size_"),r(this,"MIN_HEIGHT",300),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get size(){return{width:this.store.getObject("width")||400,height:this.store.getObject("height")||530}}set size(e){let{width:t,height:i}=e
this.store.setObject({key:"width",value:a(this,s,l).call(this,t,this.MIN_WIDTH)}),this.store.setObject({key:"height",value:a(this,s,l).call(this,i,this.MIN_HEIGHT)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-emoji-picker-manager",["exports","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","rsvp","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/lib/helpers","discourse-common/utils/decorators"],(function(e,t,i,n,r,a,s,o,l,c,u){"use strict"
var d,h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,l.isTesting)()?0:125,M=["favorites","smileys_&_emotion"],z="favorites"
e.default=(d=class extends r.default{constructor(){super(...arguments),w(this,"appEvents",h,this),w(this,"closing",p,this),w(this,"loading",m,this),w(this,"picker",b,this),w(this,"emojis",g,this),w(this,"visibleSections",f,this),w(this,"lastVisibleSection",v,this),w(this,"element",y,this)}get sections(){return!this.loading&&this.emojis?Object.keys(this.emojis):[]}closeExisting(){this.visibleSections=M,this.lastVisibleSection=z,this.picker=null}close(){this.closing=!0,(0,n.later)((()=>{this.isDestroyed||this.isDestroying||(this.visibleSections=M,this.lastVisibleSection=z,this.closing=!1,this.picker=null)}),j)}addVisibleSections(e){this.visibleSections=(0,c.makeArray)(this.visibleSections).concat((0,c.makeArray)(e)).uniq()}open(e){this.loadEmojis(),this.picker?this.picker.trigger===e.trigger?this.closeExisting():(this.closeExisting(),this.picker=e):this.picker=e}loadEmojis(){return this.emojis?a.Promise.resolve():(this.loading=!0,(0,s.ajax)("/chat/emojis.json").then((e=>{this.emojis=e})).catch(o.popupAjaxError).finally((()=>{this.loading=!1})))}},h=_(d.prototype,"appEvents",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=_(d.prototype,"closing",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=_(d.prototype,"loading",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=_(d.prototype,"picker",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=_(d.prototype,"emojis",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=_(d.prototype,"visibleSections",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M}}),v=_(d.prototype,"lastVisibleSection",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z}}),y=_(d.prototype,"element",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_(d.prototype,"closeExisting",[u.bind],Object.getOwnPropertyDescriptor(d.prototype,"closeExisting"),d.prototype),_(d.prototype,"close",[u.bind],Object.getOwnPropertyDescriptor(d.prototype,"close"),d.prototype),_(d.prototype,"loadEmojis",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"loadEmojis"),d.prototype),d)})),define("discourse/plugins/chat/discourse/services/chat-emoji-reaction-store",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{constructor(){super(...arguments),n(this,"STORE_NAMESPACE","discourse_chat_emoji_reaction_"),n(this,"MAX_DISPLAYED_EMOJIS",20),n(this,"MAX_TRACKED_EMOJIS",2*this.MAX_DISPLAYED_EMOJIS),n(this,"SKIN_TONE_STORE_KEY","emojiSelectedDiversity"),n(this,"USER_EMOJIS_STORE_KEY","emojiUsage"),n(this,"store",new i.default(this.STORE_NAMESPACE)),this.store.getObject(this.USER_EMOJIS_STORE_KEY)||(this.storedFavorites=[])}get diversity(){return this.store.getObject(this.SKIN_TONE_STORE_KEY)||1}set diversity(e){void 0===e&&(e=1),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:e}),this.notifyPropertyChange("diversity")}get storedFavorites(){let e=this.store.getObject(this.USER_EMOJIS_STORE_KEY)||[]
return e.length<1&&(e=this.siteSettings.default_emoji_reactions?this.siteSettings.default_emoji_reactions.split("|").filter(Boolean):[],this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})),e}set storedFavorites(e){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e}),this.notifyPropertyChange("favorites")}get favorites(){return[...new Set(this._frequencySort(this.storedFavorites))].slice(0,this.MAX_DISPLAYED_EMOJIS)}set favorites(e){void 0===e&&(e=[]),this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})}track(e){const t=e.replace(/(^:)|(:$)/g,"")
let i=this.storedFavorites
i.unshift(t),i.length=Math.min(i.length,this.MAX_TRACKED_EMOJIS),this.storedFavorites=i}reset(){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:[]}),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:1})}_frequencySort(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})
return Object.keys(e).sort(((t,i)=>e[i]-e[t]))}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-guardian",["exports","@ember/service"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class extends t.default{constructor(){super(...arguments),a(this,"currentUser",n,this),a(this,"siteSettings",r,this)}canEditChatChannel(){return this.canUseChat()&&this.currentUser.staff}canArchiveChannel(e){return this.canEditChatChannel()&&this.siteSettings.chat_allow_archiving_channels&&!e.isArchived&&!e.isReadOnly}canUseChat(){return this.currentUser?.has_chat_enabled&&this.siteSettings?.chat_enabled}},n=s(i.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"siteSettings",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/services/chat-history",["exports","@glimmer/tracking","@ember/service"],(function(e,t,i){"use strict"
var n,r
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){var e,t,i,n
super(...arguments),e=this,t="history",n=this,(i=r)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}get previousRoute(){if(this.history?.length>1)return this.history[this.history.length-2]}get currentRoute(){if(this.history?.length>0)return this.history[this.history.length-1]}visit(e){this.history=(this.history||[]).slice(-9).concat([e])}},a=n.prototype,s="history",o=[t.tracked],l={configurable:!0,enumerable:!0,writable:!0,initializer:null},u={},Object.keys(l).forEach((function(e){u[e]=l[e]})),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=o.slice().reverse().reduce((function(e,t){return t(a,s,e)||e}),u),c&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(c):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(a,s,u),u=null),r=u,n)
var a,s,o,l,c,u})),define("discourse/plugins/chat/discourse/services/chat-notification-manager",["exports","@ember/service","discourse/lib/desktop-notifications","discourse/lib/plugin-api","discourse-common/config/environment","discourse-common/utils/decorators"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c
function u(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function d(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=class extends t.default{constructor(){super(...arguments),u(this,"presence",o,this),u(this,"chat",l,this),u(this,"chatStateManager",c,this),d(this,"_subscribedToCore",!0),d(this,"_subscribedToChat",!1),d(this,"_countChatInDocTitle",!0)}start(){this._shouldRun()&&(this.set("_chatPresenceChannel",this.presence.getChannel(`/chat-user/chat/${this.currentUser.id}`)),this.set("_corePresenceChannel",this.presence.getChannel(`/chat-user/core/${this.currentUser.id}`)),this._chatPresenceChannel.subscribe(),this._corePresenceChannel.subscribe(),(0,n.withPluginApi)("0.12.1",(e=>{e.onPageChange(this._pageChanged)})),this._pageChanged(),this._chatPresenceChannel.on("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.on("change",this._subscribeToCorrectNotifications))}willDestroy(){super.willDestroy(...arguments),this._shouldRun()&&(this._chatPresenceChannel.off("change",this._subscribeToCorrectNotifications),this._chatPresenceChannel.unsubscribe(),this._chatPresenceChannel.leave(),this._corePresenceChannel.off("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.unsubscribe(),this._corePresenceChannel.leave())}shouldCountChatInDocTitle(){return this._countChatInDocTitle}_pageChanged(){this.chatStateManager.isActive?(this._chatPresenceChannel.enter({onlyWhileActive:!1}),this._corePresenceChannel.leave()):(this._chatPresenceChannel.leave(),this._corePresenceChannel.enter({onlyWhileActive:!1}))}_coreAlertChannel(){return(0,i.alertChannel)(this.currentUser)}_chatAlertChannel(){return`/chat${(0,i.alertChannel)(this.currentUser)}`}_subscribeToCorrectNotifications(){this._chatPresenceChannel.count>0&&this._corePresenceChannel.count>0?this.chatStateManager.isActive?this._subscribeToChat({only:!0}):this._subscribeToCore({only:!0}):this._subscribeToBoth()}_subscribeToBoth(){this._subscribeToChat(),this._subscribeToCore()}_subscribeToChat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
this.set("_countChatInDocTitle",!0),this._subscribedToChat||(this.messageBus.subscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!0)),e.only&&this._subscribedToCore&&(this.messageBus.unsubscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!1))}_subscribeToCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
e.only&&this.set("_countChatInDocTitle",!1),this._subscribedToCore||(this.messageBus.subscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!0)),e.only&&this._subscribedToChat&&(this.messageBus.unsubscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!1))}onMessage(e){return(0,i.onNotification)(e,this.siteSettings,this.currentUser)}_shouldRun(){return this.chat.userCanChat&&!(0,r.isTesting)()}},o=h(s.prototype,"presence",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=h(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(s.prototype,"chatStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(s.prototype,"_pageChanged",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_pageChanged"),s.prototype),h(s.prototype,"_subscribeToCorrectNotifications",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"_subscribeToCorrectNotifications"),s.prototype),h(s.prototype,"onMessage",[a.bind],Object.getOwnPropertyDescriptor(s.prototype,"onMessage"),s.prototype),s)})),define("discourse/plugins/chat/discourse/services/chat-side-panel-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,i){"use strict"
function n(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function r(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=new WeakSet
class o extends t.default{constructor(){super(...arguments),n(this,s),r(this,"STORE_NAMESPACE","discourse_chat_side_panel_size_"),r(this,"MIN_WIDTH",250),r(this,"store",new i.default(this.STORE_NAMESPACE))}get width(){return this.store.getObject("width")||this.MIN_WIDTH}set width(e){this.store.setObject({key:"width",value:a(this,s,l).call(this,e,this.MIN_WIDTH)})}}function l(e,t){return Math.max(e,t)}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-state-manager",["exports","@glimmer/tracking","@ember/service","discourse/lib/key-value-store","discourse/lib/plugin-api","discourse/lib/sidebar/panels","discourse/lib/utilities","discourse/models/site","discourse-common/lib/get-url","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode"],(function(e,t,i,n,r,a,s,o,l,c){"use strict"
var u,d,h,p,m,b,g,f,v,y
function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function j(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function z(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.addChatDrawerStateCallback=function(e){S.push(e)},e.default=void 0,e.resetChatDrawerStateCallbacks=function(){S=[]}
const O="preferred_mode",C="FULL_PAGE_CHAT",k="DRAWER_CHAT"
let S=[]
e.default=(y=new WeakSet,u=class extends i.default{constructor(){super(...arguments),_(this,y),w(this,"chat",d,this),w(this,"chatHistory",h,this),w(this,"router",p,this),w(this,"isSidePanelExpanded",m,this),w(this,"isDrawerExpanded",b,this),w(this,"isDrawerActive",g,this),w(this,"_chatURL",f,this),w(this,"_appURL",v,this),j(this,"_store",new n.default("discourse_chat_"))}reset(){this._store.remove(O),this._chatURL=null,this._appURL=null}prefersFullPage(){this._store.setObject({key:O,value:C})}prefersDrawer(){this._store.setObject({key:O,value:k})}openSidePanel(){this.isSidePanelExpanded=!0}closeSidePanel(){this.isSidePanelExpanded=!1}didOpenDrawer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,r.withPluginApi)("1.8.0",(e=>{(0,c.getUserChatSeparateSidebarMode)(this.currentUser).always?(e.setSidebarPanel(a.MAIN_PANEL),e.setSeparatedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setCombinedSidebarMode()})),this.isDrawerActive=!0,this.isDrawerExpanded=!0,e&&this.storeChatURL(e),this.chat.updatePresence(),M(this,y,P).call(this)}didCloseDrawer(){(0,r.withPluginApi)("1.8.0",(e=>{e.setSidebarPanel(a.MAIN_PANEL)
const t=(0,c.getUserChatSeparateSidebarMode)(this.currentUser)
t.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):t.always?(e.setSeparatedSidebarMode(),e.showSidebarSwitchPanelButtons()):(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())})),this.isDrawerActive=!1,this.isDrawerExpanded=!1,this.chat.updatePresence(),M(this,y,P).call(this)}didExpandDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!0,this.chat.updatePresence()}didCollapseDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!1,M(this,y,P).call(this)}didToggleDrawer(){this.isDrawerExpanded=!this.isDrawerExpanded,this.isDrawerActive=!0,M(this,y,P).call(this)}get isFullPagePreferred(){return!(!o.default.currentProp("mobileView")&&this._store.getObject(O)!==C)}get isDrawerPreferred(){return!(this.isFullPagePreferred&&(o.default.currentProp("mobileView")||this._store.getObject(O)&&this._store.getObject(O)!==k))}get isFullPageActive(){return this.router.currentRouteName?.startsWith("chat")}get isActive(){return this.isFullPageActive||this.isDrawerActive}storeAppURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
e?this._appURL=e:this.router.currentURL?.startsWith("/chat")?this._appURL="/":this._appURL=this.router.currentURL}storeChatURL(e){this._chatURL=e}get lastKnownAppURL(){let e=this._appURL
return e&&"/"!==e||(e=this.router.urlFor(`discovery.${(0,s.defaultHomepage)()}`)),(0,l.default)(e)}get lastKnownChatURL(){return(0,l.default)(this._chatURL||"/chat")}},d=z(u.prototype,"chat",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=z(u.prototype,"chatHistory",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=z(u.prototype,"router",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=z(u.prototype,"isSidePanelExpanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=z(u.prototype,"isDrawerExpanded",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=z(u.prototype,"isDrawerActive",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=z(u.prototype,"_chatURL",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=z(u.prototype,"_appURL",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u)
function P(){const e={isDrawerActive:this.isDrawerActive,isDrawerExpanded:this.isDrawerExpanded}
S.forEach((t=>t(e)))}})),define("discourse/plugins/chat/discourse/services/chat-subscriptions-manager",["exports","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-channel-archive"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h,p,m
function b(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(s=class extends t.default{constructor(){super(...arguments),b(this,"store",o,this),b(this,"chatChannelsManager",l,this),b(this,"chatTrackingStateManager",c,this),b(this,"currentUser",u,this),b(this,"appEvents",d,this),b(this,"chat",h,this),b(this,"dialog",p,this),b(this,"router",m,this),g(this,"_channelSubscriptions",new Set)}startChannelSubscription(e){e.currentUserMembership.muted||this._channelSubscriptions.has(e.id)||(this._channelSubscriptions.add(e.id),this._startChannelMentionsSubscription(e),e.isDirectMessageChannel||this._startKickFromChannelSubscription(e),this._startChannelNewMessagesSubscription(e))}stopChannelSubscription(e){this.messageBus.unsubscribe(`/chat/${e.id}/new-messages`,this._onNewMessages),e.isDirectMessageChannel||(this.messageBus.unsubscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions),this.messageBus.unsubscribe(`/chat/${e.id}/kick`,this._onKickFromChannel)),this._channelSubscriptions.delete(e.id)}startChannelsSubscriptions(e){this._startNewChannelSubscription(e.new_channel),this._startChannelArchiveStatusSubscription(e.archive_status),this._startUserTrackingStateSubscription(e.user_tracking_state),this._startChannelsEditsSubscription(e.channel_edits),this._startChannelsStatusChangesSubscription(e.channel_status),this._startChannelsMetadataChangesSubscription(e.channel_metadata)}stopChannelsSubscriptions(){this._stopNewChannelSubscription(),this._stopChannelArchiveStatusSubscription(),this._stopUserTrackingStateSubscription(),this._stopChannelsEditsSubscription(),this._stopChannelsStatusChangesSubscription(),this._stopChannelsMetadataChangesSubscription(),(this.chatChannelsManager.channels||[]).forEach((e=>{this.stopChannelSubscription(e)}))}_startChannelArchiveStatusSubscription(e){this.currentUser.admin&&this.messageBus.subscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate,e)}_stopChannelArchiveStatusSubscription(){this.currentUser.admin&&this.messageBus.unsubscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate)}_startChannelMentionsSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions,e.meta.message_bus_last_ids.new_mentions)}_startKickFromChannelSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/kick`,this._onKickFromChannel,e.meta.message_bus_last_ids.kick)}_onChannelArchiveStatusUpdate(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.archive=a.default.create(e))}))}_onNewMentions(e){this.chatChannelsManager.find(e.channel_id).then((t=>{const i=t.currentUserMembership
e.message_id>i?.lastReadMessageId&&t.tracking.mentionCount++}))}_onKickFromChannel(e){this.chatChannelsManager.find(e.channel_id).then((e=>{this.chat.activeChannel.id===e.id?this.dialog.alert({message:n.default.t("chat.kicked_from_channel"),didConfirm:()=>{this.chatChannelsManager.remove(e)
const t=this.chatChannelsManager.publicMessageChannels[0]
t?this.router.transitionTo("chat.channel",...t.routeModels):this.router.transitionTo("chat.browse")}}):this.chatChannelsManager.remove(e)}))}_startChannelNewMessagesSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-messages`,this._onNewMessages,e.meta.message_bus_last_ids.new_messages)}_onNewMessages(e){switch(e.type){case"channel":this._onNewChannelMessage(e)
break
case"thread":this._onNewThreadMessage(e)}}_onNewChannelMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.lastMessage=e.message
const i=e.message.user
i.id===this.currentUser.id||this.currentUser.ignored_users.includes(i.username)?t.currentUserMembership.lastReadMessageId=t.lastMessage.id:(t.lastMessage.id>(t.currentUserMembership.lastReadMessageId||0)&&t.tracking.unreadCount++,e.thread_id&&t.threadingEnabled&&t.threadsManager.find(t.id,e.thread_id).then((i=>{i.currentUserMembership&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),this._updateActiveLastViewedAt(t))})))}))}_onNewThreadMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.threadingEnabled&&t.threadsManager.find(e.channel_id,e.thread_id).then((i=>{e.message.user.id===this.currentUser.id?i.currentUserMembership&&(t.threadsManager.unreadThreadOverview.delete(parseInt(e.thread_id,10)),i.currentUserMembership.lastReadMessageId=e.message.id):this.currentUser.ignored_users.includes(e.message.user.username)?i.currentUserMembership&&(i.currentUserMembership.lastReadMessageId=e.message.id):i.currentUserMembership&&e.message.id>(i.currentUserMembership.lastReadMessageId||0)&&!i.currentUserMembership.isQuiet&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),i.tracking.unreadCount++,this._updateActiveLastViewedAt(t))}))}))}_updateActiveLastViewedAt(e){this.chat.activeChannel?.id===e.id&&e.updateLastViewedAt()}_startUserTrackingStateSubscription(e){this.currentUser&&(this.messageBus.subscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate,e),this.messageBus.subscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate,e))}_stopUserTrackingStateSubscription(){this.currentUser&&(this.messageBus.unsubscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate),this.messageBus.unsubscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate))}_onBulkUserTrackingStateUpdate(e){Object.keys(e).forEach((t=>{this._updateChannelTrackingData(t,e[t])}))}_onUserTrackingStateUpdate(e){this._updateChannelTrackingData(e.channel_id,e)}_updateChannelTrackingData(e,t){this.chatChannelsManager.find(e).then((i=>{t.thread_id||(i.currentUserMembership.lastReadMessageId=t.last_read_message_id),i.tracking.unreadCount=t.unread_count,i.tracking.mentionCount=t.mention_count,t.hasOwnProperty("unread_thread_overview")&&i.threadingEnabled&&(i.threadsManager.unreadThreadOverview=t.unread_thread_overview),t.thread_id&&t.hasOwnProperty("thread_tracking")&&i.threadingEnabled&&i.threadsManager.find(e,t.thread_id).then((e=>{e.currentUserMembership&&!e.currentUserMembership.isQuiet&&(e.currentUserMembership.lastReadMessageId=t.last_read_message_id,e.tracking.unreadCount=t.thread_tracking.unread_count,e.tracking.mentionCount=t.thread_tracking.mention_count)}))}))}_startNewChannelSubscription(e){this.messageBus.subscribe("/chat/new-channel",this._onNewChannelSubscription,e)}_stopNewChannelSubscription(){this.messageBus.unsubscribe("/chat/new-channel",this._onNewChannelSubscription)}_onNewChannelSubscription(e){this.chatChannelsManager.find(e.channel.id).then((t=>{t.meta=e.channel.meta,t.currentUserMembership=e.channel.current_user_membership,t.isDirectMessageChannel&&!t.currentUserMembership.following&&(t.tracking.unreadCount=1),this.chatChannelsManager.follow(t)}))}_startChannelsMetadataChangesSubscription(e){this.messageBus.subscribe("/chat/channel-metadata",this._onChannelMetadata,e)}_startChannelsEditsSubscription(e){this.messageBus.subscribe("/chat/channel-edits",this._onChannelEdits,e)}_startChannelsStatusChangesSubscription(e){this.messageBus.subscribe("/chat/channel-status",this._onChannelStatus,e)}_stopChannelsStatusChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-status",this._onChannelStatus)}_stopChannelsEditsSubscription(){this.messageBus.unsubscribe("/chat/channel-edits",this._onChannelEdits)}_stopChannelsMetadataChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-metadata",this._onChannelMetadata)}_onChannelMetadata(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.membershipsCount=e.memberships_count,this.appEvents.trigger("chat:refresh-channel-members"))}))}_onChannelEdits(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t&&(t.title=e.name,t.description=e.description,t.slug=e.slug)}))}_onChannelStatus(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t.status=e.status,e.status===r.CHANNEL_STATUSES.archived&&t.tracking.reset()}))}},o=f(s.prototype,"store",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=f(s.prototype,"chatChannelsManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f(s.prototype,"chatTrackingStateManager",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=f(s.prototype,"currentUser",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f(s.prototype,"appEvents",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f(s.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=f(s.prototype,"dialog",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=f(s.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(s.prototype,"_onChannelArchiveStatusUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelArchiveStatusUpdate"),s.prototype),f(s.prototype,"_onNewMentions",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMentions"),s.prototype),f(s.prototype,"_onKickFromChannel",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onKickFromChannel"),s.prototype),f(s.prototype,"_onNewMessages",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewMessages"),s.prototype),f(s.prototype,"_onBulkUserTrackingStateUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onBulkUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_onUserTrackingStateUpdate",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onUserTrackingStateUpdate"),s.prototype),f(s.prototype,"_updateChannelTrackingData",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_updateChannelTrackingData"),s.prototype),f(s.prototype,"_onNewChannelSubscription",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onNewChannelSubscription"),s.prototype),f(s.prototype,"_onChannelMetadata",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelMetadata"),s.prototype),f(s.prototype,"_onChannelEdits",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelEdits"),s.prototype),f(s.prototype,"_onChannelStatus",[i.bind],Object.getOwnPropertyDescriptor(s.prototype,"_onChannelStatus"),s.prototype),s)})),define("discourse/plugins/chat/discourse/services/chat-thread-composer",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends n.default{constructor(){super(...arguments),o(this,"chat",a,this),o(this,"textarea",s,this)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e)}blur(){this.textarea?.blur()}edit(e){this.chat.activeMessage=null,e.editing=!0,e.thread.draft=e,this.focus({refreshHeight:!0,ensureAtEnd:!0})}replyTo(){this.chat.activeMessage=null}},a=l(r.prototype,"chat",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=l(r.prototype,"textarea",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(r.prototype,"focus",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"focus"),r.prototype),l(r.prototype,"blur",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"blur"),r.prototype),l(r.prototype,"edit",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"edit"),r.prototype),l(r.prototype,"replyTo",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"replyTo"),r.prototype),r)})),define("discourse/plugins/chat/discourse/services/chat-thread-list-pane",["exports","@ember/service"],(function(e,t){"use strict"
var i,n,r
function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function s(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=class extends t.default{constructor(){super(...arguments),a(this,"chat",n,this),a(this,"router",r,this)}get isOpened(){return"chat.channel.threads"===this.router.currentRoute.name}async close(){await this.router.transitionTo("chat.channel",...this.chat.activeChannel.routeModels)}async open(){await this.router.transitionTo("chat.channel.threads",...this.chat.activeChannel.routeModels)}},n=s(i.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=s(i.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)})),define("discourse/plugins/chat/discourse/services/chat-thread-pane",["exports","@ember/service","discourse/plugins/chat/discourse/services/chat-channel-pane"],(function(e,t,i){"use strict"
var n,r,a
function s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function o(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(n=class extends i.default{constructor(){super(...arguments),s(this,"chat",r,this),s(this,"router",a,this)}get thread(){return this.channel?.activeThread}get isOpened(){return"chat.channel.thread"===this.router.currentRoute.name}get selectedMessageIds(){return this.thread.messagesManager.selectedMessages.mapBy("id")}async close(){await this.router.transitionTo("chat.channel",...this.channel.routeModels)}async open(e){await this.router.transitionTo("chat.channel.thread",...e.routeModels)}},r=o(n.prototype,"chat",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=o(n.prototype,"router",[t.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)})),define("discourse/plugins/chat/discourse/services/chat-tracking-state-manager",["exports","@ember/application","@ember/runloop","@ember/service","discourse-common/lib/debounce","discourse/plugins/chat/discourse/models/chat-tracking-state"],(function(e,t,i,n,r,a){"use strict"
var s,o,l,c,u,d,h
function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function m(e,t,i){g(e,t),t.set(e,i)}function b(e,t){g(e,t),t.add(e)}function g(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f(e,t){var i=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance")
return t.get(e)}(e,t,"get")
return function(e,t){if(t.get)return t.get.call(e)
return t.value}(e,i)}function v(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return i}function y(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(c=new WeakSet,u=new WeakSet,d=new WeakMap,h=new WeakMap,s=class extends n.default{constructor(){super(...arguments),m(this,h,{get:M,set:void 0}),m(this,d,{get:j,set:void 0}),b(this,u),b(this,c),p(this,"chatChannelsManager",o,this),p(this,"appEvents",l,this)}setupWithPreloadedState(e){let{channel_tracking:t={}}=e
this.chatChannelsManager.channels.forEach((e=>{t[e.id.toString()]&&v(this,u,_).call(this,e,t[e.id.toString()])}))}setupChannelThreadState(e,t){e.threadsManager.threads.forEach((e=>{const i=t[e.id.toString()]
i&&v(this,u,_).call(this,e,i)}))}get publicChannelUnreadCount(){return f(this,d).reduce(((e,t)=>e+t.tracking.unreadCount),0)}get directMessageUnreadCount(){return f(this,h).reduce(((e,t)=>e+t.tracking.unreadCount),0)}get publicChannelMentionCount(){return f(this,d).reduce(((e,t)=>e+t.tracking.mentionCount),0)}get directMessageMentionCount(){return f(this,h).reduce(((e,t)=>e+t.tracking.mentionCount),0)}get allChannelMentionCount(){return this.publicChannelMentionCount+this.directMessageMentionCount}get allChannelUrgentCount(){return this.publicChannelMentionCount+this.directMessageUnreadCount}get hasUnreadThreads(){return f(this,d).some((e=>e.unreadThreadsCount>0))}willDestroy(){super.willDestroy(...arguments),(0,i.cancel)(this._onTriggerNotificationDebounceHandler)}triggerNotificationsChanged(){this._onTriggerNotificationDebounceHandler=(0,r.default)(this,v(this,c,w),100)}},o=y(s.prototype,"chatChannelsManager",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=y(s.prototype,"appEvents",[n.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s)
function w(){this.appEvents.trigger("notifications:changed")}function _(e,i){e.tracking||(e.tracking=new a.default((0,t.getOwner)(this))),e.tracking.unreadCount=i.unread_count,e.tracking.mentionCount=i.mention_count}function j(){return this.chatChannelsManager.publicMessageChannels}function M(){return this.chatChannelsManager.directMessageChannels}})),define("discourse/plugins/chat/discourse/services/chat",["exports","@glimmer/tracking","@ember/object","@ember/object/computed","@ember/runloop","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/user-presence","discourse-common/lib/deprecated","discourse-common/lib/later","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,i,n,r,a,s,o,l,c,u,d,h){"use strict"
var p,m,b,g,f,v,y,w,_,j,M,z,O,C,k,S,P,T,E,x
function D(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function A(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function N(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const I={userUnseenTime:3e5,browserHiddenTime:3e5}
e.default=(p=(0,n.and)("currentUser.has_chat_enabled","siteSettings.chat_enabled"),m=(0,i.computed)("currentUser.staff","currentUser.groups.[]"),b=(0,i.computed)("chatChannelsManager.directMessageChannels"),g=(0,i.computed)("activeChannel.userSilenced"),f=class extends a.default{constructor(){super(...arguments),D(this,"chatApi",v,this),D(this,"appEvents",y,this),D(this,"currentUser",w,this),D(this,"chatNotificationManager",_,this),D(this,"chatSubscriptionsManager",j,this),D(this,"chatStateManager",M,this),D(this,"chatDraftsManager",z,this),D(this,"presence",O,this),D(this,"router",C,this),D(this,"site",k,this),D(this,"chatChannelsManager",S,this),D(this,"chatTrackingStateManager",P,this),A(this,"cook",null),A(this,"presenceChannel",null),A(this,"sidebarActive",!1),A(this,"isNetworkUnreliable",!1),D(this,"userCanChat",T,this),D(this,"_activeMessage",E,this),D(this,"_activeChannel",x,this)}get activeChannel(){return this._activeChannel}set activeChannel(e){e||(this._activeMessage=null),this._activeChannel&&(this._activeChannel.activeThread=null),this._activeChannel=e}get userCanDirectMessage(){return!!this.currentUser&&(this.currentUser.staff||this.siteSettings.userInAnyGroups("direct_message_enabled_groups",this.currentUser))}get userHasDirectMessages(){return this.chatChannelsManager.directMessageChannels?.length>0}get userCanAccessDirectMessages(){return this.userCanDirectMessage||this.userHasDirectMessages}get userCanInteractWithChat(){return!this.activeChannel?.userSilenced}get activeMessage(){return this._activeMessage}set activeMessage(e){this._activeMessage=e||null}init(){super.init(...arguments),this.userCanChat&&(this.presenceChannel=this.presence.getChannel("/chat/online"),(0,l.onPresenceChange)({callback:this.onPresenceChangeCallback,browserHiddenTime:15e4,userUnseenTime:15e4}))}onPresenceChangeCallback(e){e&&this.chatApi.listCurrentUserChannels().then((e=>{this.chatSubscriptionsManager.stopChannelsSubscriptions(),this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),[...e.public_channels,...e.direct_message_channels].forEach((t=>{this.chatChannelsManager.find(t.id,{fetchIfNotFound:!1}).then((i=>{if(!i)return
i.meta.message_bus_last_ids=t.meta.message_bus_last_ids
const n=e.tracking.channel_tracking[i.id]
i.tracking.unreadCount=n.unread_count,i.tracking.mentionCount=n.mention_count,i.currentUserMembership=t.current_user_membership,this.chatSubscriptionsManager.startChannelSubscription(i)}))}))}))}markNetworkAsUnreliable(){(0,r.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!0),this._networkCheckHandler=(0,u.default)((()=>{this.isDestroyed||this.isDestroying||this.markNetworkAsReliable()}),3e4)}markNetworkAsReliable(){(0,r.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!1)}setupWithPreloadedChannels(e){this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),this.presenceChannel.subscribe(e.global_presence_channel_state),[...e.public_channels,...e.direct_message_channels].forEach((t=>{const i=this.chatChannelsManager.store(t)
return(this.currentUser?.chat_drafts||[]).filter((e=>e.channel_id===i.id)).forEach((e=>{this.chatDraftsManager.add(h.default.createDraftMessage(i,Object.assign({user:this.currentUser},JSON.parse(e.data))),e.channel_id,e.thread_id)})),e.unread_thread_overview?.[i.id]&&(i.threadsManager.unreadThreadOverview=e.unread_thread_overview[i.id]),this.chatChannelsManager.follow(i)})),this.chatTrackingStateManager.setupWithPreloadedState(e.tracking)}willDestroy(){super.willDestroy(...arguments),this.userCanChat&&(this.chatSubscriptionsManager.stopChannelsSubscriptions(),(0,l.removeOnPresenceChange)(this.onPresenceChangeCallback))}updatePresence(){(0,r.next)((()=>{this.isDestroyed||this.isDestroying||this.currentUser.user_option?.hide_profile_and_presence||(this.chatStateManager.isActive?this.presenceChannel.enter({activeOptions:I}):this.presenceChannel.leave())}))}getDocumentTitleCount(){return this.chatNotificationManager.shouldCountChatInDocTitle()?this.chatTrackingStateManager.allChannelUrgentCount:0}switchChannelUpOrDown(e){const{activeChannel:t}=this
if(!t)return
let i,n
t.isDirectMessageChannel?(i=this.chatChannelsManager.truncatedDirectMessageChannels,n=this.chatChannelsManager.publicMessageChannels):(i=this.chatChannelsManager.publicMessageChannels,n=this.chatChannelsManager.truncatedDirectMessageChannels)
const r="up"===e,a=i.findIndex((e=>e.id===t.id))
let s=i[a+(r?-1:1)]
if(s)return this.router.transitionTo("chat.channel",...s.routeModels)
const o=n.length?n:i,l=r?o[o.length-1]:o[0]
return l.id!==t.id?this.router.transitionTo("chat.channel",...l.routeModels):void 0}getIdealFirstChannelId(){let e,t,i,n,r,a
return this.chatChannelsManager.channels.forEach((s=>{const o=s.currentUserMembership
if(o.following)if(s.isDirectMessageChannel)!t&&s.tracking.unreadCount>0?t=s.id:r||(r=s.id)
else{if(o.unread_mentions>0)return void(e=s.id)
!i&&s.tracking.unreadCount>0?i=s.id:a||parseInt(this.siteSettings.chat_default_channel_id||0,10)!==s.id?n||(n=s.id):a=s.id}})),e||t||i||a||n||r}_fireOpenFloatAppEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
t?this.router.transitionTo("chat.channel.near-message",...e.routeModels,t):this.router.transitionTo("chat.channel",...e.routeModels)}async followChannel(e){return this.chatChannelsManager.follow(e)}async unfollowChannel(e){return this.chatChannelsManager.unfollow(e).then((()=>{e===this.activeChannel&&e.isDirectMessageChannel&&this.router.transitionTo("chat")}))}upsertDmChannelForUser(e,t){const i=(e.chatable.users||[]).mapBy("username").concat(t.username).uniq()
return this.upsertDmChannel({usernames:i})}upsertDmChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return(0,s.ajax)("/chat/api/direct-message-channels.json",{method:"POST",data:{target_usernames:e.usernames?.uniq(),target_groups:e.groups?.uniq(),name:t}}).then((e=>{const t=this.chatChannelsManager.store(e.channel)
return this.chatChannelsManager.follow(t),t})).catch(o.popupAjaxError)}getDmChannelForUsernames(e){return(0,s.ajax)("/chat/direct_messages.json",{data:{usernames:e.uniq().join(",")}})}addToolbarButton(){(0,c.default)("Use the new chat API `api.registerChatComposerButton` instead of `chat.addToolbarButton`")}toggleDrawer(){this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)}},v=N(f.prototype,"chatApi",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=N(f.prototype,"appEvents",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=N(f.prototype,"currentUser",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=N(f.prototype,"chatNotificationManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=N(f.prototype,"chatSubscriptionsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=N(f.prototype,"chatStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=N(f.prototype,"chatDraftsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=N(f.prototype,"presence",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=N(f.prototype,"router",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=N(f.prototype,"site",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=N(f.prototype,"chatChannelsManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=N(f.prototype,"chatTrackingStateManager",[a.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=N(f.prototype,"userCanChat",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=N(f.prototype,"_activeMessage",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=N(f.prototype,"_activeChannel",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N(f.prototype,"userCanDirectMessage",[m],Object.getOwnPropertyDescriptor(f.prototype,"userCanDirectMessage"),f.prototype),N(f.prototype,"userHasDirectMessages",[b],Object.getOwnPropertyDescriptor(f.prototype,"userHasDirectMessages"),f.prototype),N(f.prototype,"userCanInteractWithChat",[g],Object.getOwnPropertyDescriptor(f.prototype,"userCanInteractWithChat"),f.prototype),N(f.prototype,"onPresenceChangeCallback",[d.bind],Object.getOwnPropertyDescriptor(f.prototype,"onPresenceChangeCallback"),f.prototype),N(f.prototype,"toggleDrawer",[i.action],Object.getOwnPropertyDescriptor(f.prototype,"toggleDrawer"),f.prototype),f)})),define("discourse/plugins/chat/discourse/services/emoji-picker-scroll-observer",["exports","@glimmer/tracking","@ember/service","discourse-common/utils/decorators"],(function(e,t,i,n){"use strict"
var r,a,s
function o(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){var n
return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e
var i=e[Symbol.toPrimitive]
if(void 0!==i){var n=i.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var a={}
return Object.keys(n).forEach((function(e){a[e]=n[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(r=class extends i.default{constructor(){super(...arguments),o(this,"chatEmojiPickerManager",a,this),o(this,"enabled",s,this),l(this,"direction","up"),l(this,"prevYPosition",0)}_observerCallback(e){if(!this.enabled)return
this._setScrollDirection(e.target)
const t=[...document.querySelectorAll(".chat-emoji-picker__section")].filter((t=>this._isSectionVisibleInPicker(t,e.target)))
if(t?.length){let e
e="up"===this.direction||this.prevYPosition<50?t.firstObject:t.lastObject,this.chatEmojiPickerManager.lastVisibleSection=e.dataset.section,this.chatEmojiPickerManager.addVisibleSections(t.map((e=>e.dataset.section)))}}observe(e){e.addEventListener("scroll",this._observerCallback)}unobserve(e){e.removeEventListener("scroll",this._observerCallback)}_setScrollDirection(e){e.scrollTop>this.prevYPosition?this.direction="down":this.direction="up",this.prevYPosition=e.scrollTop}_isSectionVisibleInPicker(e,t){const{bottom:i,height:n,top:r}=e.getBoundingClientRect(),a=t.getBoundingClientRect()
return r<=a.top?a.top-r<=n:i-a.bottom<=n}},a=c(r.prototype,"chatEmojiPickerManager",[i.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c(r.prototype,"enabled",[t.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c(r.prototype,"_observerCallback",[n.bind],Object.getOwnPropertyDescriptor(r.prototype,"_observerCallback"),r.prototype),r)})),define("discourse/plugins/chat/discourse/templates/admin-plugins-chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"E7ktcAjF",block:'[[[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["selectedWebhook"]],[[[1,"  "],[8,[39,2],[[24,0,"incoming-chat-webhooks-back"]],[["@icon","@label","@title","@action"],["chevron-left","chat.incoming_webhooks.back","chat.incoming_webhooks.back",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhookId"]]],null],null],null]]],null],[1,"\\n\\n  "],[10,"form"],[14,0,"form-vertical"],[12],[1,"\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value"],[[30,0,["selectedWebhook","description"]]]],null],[1,"    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.system"],null]]],[["@type","@value"],["text",[30,0,["selectedWebhook","username"]]]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.username_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.post_to"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["selectedWebhook","chat_channel","id"]],[28,[37,9],[[30,0],"changeChatChannel"],null]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n"],[41,[30,0,["selectedWebhook","emoji"]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.current_emoji"],null]],[1,"\\n\\n          "],[10,1],[14,0,"incoming-chat-webhooks-current-emoji"],[12],[1,"\\n            "],[1,[28,[35,10],[[30,0,["selectedWebhook","emoji"]]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[35,5],["chat.incoming_webhooks.no_emoji"],null]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[8,[39,11],null,[["@isActive","@isEditorFocused","@emojiSelected","@onEmojiPickerClose"],[[30,0,["emojiPickerIsActive"]],true,[28,[37,9],[[30,0],"emojiSelected"],null],[28,[37,9],[[30,0],[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],false],null]]],null],[1,"\\n\\n"],[41,[51,[30,0,["emojiPickerIsActive"]]],[[[1,"        "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@action"],["chat.incoming_webhooks.select_emoji",[28,[37,3],[[28,[37,4],[[30,0,["emojiPickerIsActive"]]],null],true],null]]],null],[1,"\\n        "],[8,[39,2],null,[["@label","@action","@disabled"],["chat.incoming_webhooks.reset_emoji",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhook","emoji"]]],null],null],null],[28,[37,13],[[30,0,["selectedWebhook","emoji"]]],null]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.emoji_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"control-group"],[12],[1,"\\n      "],[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,5],["chat.incoming_webhooks.url"],null]],[13],[1,"\\n      "],[10,"label"],[12],[1,[30,0,["selectedWebhook","url"]]],[13],[1,"\\n      "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n        "],[1,[28,[35,5],["chat.incoming_webhooks.url_instructions"],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@title","@action","@disabled"],["chat.incoming_webhooks.save","chat.incoming_webhooks.save",[30,0,["saveEdit"]],[30,0,["saveEditDisabled"]]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,"h3"],[12],[1,[28,[35,5],["chat.incoming_webhooks.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["creatingNew"]],[[[1,"    "],[10,0],[14,0,"new-incoming-webhook-container"],[12],[1,"\\n      "],[8,[39,6],[[16,"placeholder",[28,[37,5],["chat.incoming_webhooks.name_placeholder"],null]]],[["@type","@value"],["text",[30,0,["newWebhookName"]]]],null],[1,"\\n      "],[8,[39,8],null,[["@content","@value","@onChange"],[[30,0,["model","chat_channels"]],[30,0,["newWebhookChannelId"]],[28,[37,9],[[30,0],[28,[37,4],[[30,0,["newWebhookChannelId"]]],null]],null]]],null],[1,"\\n      "],[8,[39,2],[[24,0,"btn-primary create-new-incoming-webhook-btn"]],[["@label","@title","@disabled","@action"],["chat.create","chat.create",[28,[37,13],[[30,0,["nameAndChannelValid"]]],null],[30,0,["createNewWebhook"]]]],null],[1,"\\n      "],[8,[39,2],null,[["@label","@title","@action"],["chat.cancel","chat.cancel",[30,0,["resetNewWebhook"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[8,[39,2],[[24,0,"btn-primary"]],[["@label","@title","@action"],["chat.incoming_webhooks.new","chat.incoming_webhooks.new",[28,[37,3],[[28,[37,4],[[30,0,["creatingNew"]]],null],true],null]]],null],[1,"\\n"]],[]]],[1,"\\n  "],[10,2],[12],[1,[28,[35,14],[[28,[37,5],["chat.incoming_webhooks.instructions"],null]],null]],[13],[1,"\\n\\n  "],[10,0],[14,0,"incoming-chat-webhooks"],[12],[1,"\\n"],[41,[30,0,["model","incoming_chat_webhooks"]],[[[42,[28,[37,16],[[28,[37,16],[[30,0,["sortedWebhooks"]]],null]],null],null,[[[1,"        "],[10,0],[14,0,"incoming-chat-webhooks--row"],[12],[1,"\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--details"],[12],[1,"\\n            "],[10,0],[14,0,"incoming-chat-webhooks--row--details--name"],[12],[1,"\\n              "],[1,[30,1,["name"]]],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[12],[1,"\\n"],[41,[30,1,["emoji"]],[[[1,"                "],[1,[28,[35,10],[[30,1,["emoji"]]],null]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["username"]],[[[1,"                "],[1,[30,1,["username"]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,5],["chat.incoming_webhooks.system"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n\\n            "],[10,0],[12],[8,[39,17],null,[["@channel"],[[30,1,["chat_channel"]]]],null],[13],[1,"\\n            "],[10,0],[12],[1,[30,1,["description"]]],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"incoming-chat-webhooks--row--controls"],[12],[1,"\\n            "],[10,0],[12],[1,"\\n              "],[8,[39,2],null,[["@icon","@label","@action"],["pencil-alt","chat.incoming_webhooks.edit",[28,[37,3],[[28,[37,4],[[30,0,["selectedWebhookId"]]],null],[30,1,["id"]]],null]]],null],[1,"\\n              "],[8,[39,2],[[24,0,"btn-danger"]],[["@icon","@title","@action"],["trash-alt","chat.incoming_webhooks.delete",[28,[37,3],[[30,0,["destroyWebhook"]],[30,1]],null]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[1]],null]],[]],[[[1,"      "],[1,[28,[35,5],["chat.incoming_webhooks.none"],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],[]]]],["webhook"],false,["chat/admin/export-messages","if","d-button","fn","mut","i18n","input","textarea","chat-channel-chooser","action","replace-emoji","emoji-picker","unless","not","html-safe","each","-track-array","channel-title"]]',moduleName:"discourse/plugins/chat/discourse/templates/admin-plugins-chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-all",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"wstkeSHU",block:'[[[8,[39,0],null,[["@status"],["all"]],null]],[],false,["chat/routes/browse"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-all.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-archived",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"0DBy4MEk",block:'[[[8,[39,0],null,[["@status"],["archived"]],null]],[],false,["chat/routes/browse"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-archived.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-closed",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"qYrewYp6",block:'[[[8,[39,0],null,[["@status"],["closed"]],null]],[],false,["chat/routes/browse"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-closed.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-open",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Ha6JlJwA",block:'[[[8,[39,0],null,[["@status"],["open"]],null]],[],false,["chat/routes/browse"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-open.hbs",isStrictMode:!1})}))
define("discourse/plugins/chat/discourse/templates/chat-browse",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"bDDVU8Cl",block:'[[[46,[28,[37,1],null,null],null,null,null]],[],false,["component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-members",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"F/Of0pmn",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info-members"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-members.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-settings",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"mUrk0Olg",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info-settings"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-settings.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Ap9/cIrL",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-thread",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dBCndVuI",block:'[[[8,[39,0],null,[["@thread","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null]],[],false,["chat/routes/channel-thread"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-thread.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"neA2/I/Y",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-threads"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-threads.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"H/iqPgyD",block:'[[[8,[39,0],null,[["@channel","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null]],[],false,["chat/routes/channel"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channels",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"0JNfhKtv",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channels.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-direct-messages",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"VIb67ytl",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/direct-messages"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-direct-messages.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-index",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Okro16df",block:'[[[8,[39,0],null,null,null]],[],false,["channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-index.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"xde66Ckc",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/threads"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-threads.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"PrN4v/9q",block:'[[[10,0],[14,1,"chat-progress-bar-container"],[12],[13],[1,"\\n\\n"],[8,[39,0],null,null,null],[1,"\\n\\n"],[41,[30,0,["chat","sidebarActive"]],[[[1,"  "],[10,0],[14,0,"full-page-chat teams-sidebar-on"],[12],[1,"\\n    "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,0],[15,0,[28,[37,4],["full-page-chat",[52,[30,0,["shouldUseCoreSidebar"]],"full-page-chat-sidebar-enabled"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldUseChatSidebar"]],[[[1,"      "],[8,[39,5],null,null,null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"main-chat-outlet"],[15,0,[28,[37,4],["main-chat-outlet",[30,0,["mainOutletModifierClasses"]]],null]],[12],[1,"\\n      "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n"],[41,[30,0,["shouldUseChatFooter"]],[[[1,"        "],[8,[39,6],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[],false,["chat-vh","if","component","-outlet","concat-class","channels-list","chat-footer"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"yzyIVLUg",block:'[[[8,[39,0],null,null,null]],[],false,["chat-channel-message-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dBkEnbeG",block:'[[[10,0],[14,0,"chat-drawer-outlet-container"],[12],[1,"\\n  "],[8,[39,0],null,null,null],[1,"\\n"],[13]],[],false,["chat-drawer"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6ho8SpDw",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-desktop"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dy8JR7Ux",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-mobile"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-mobile-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/home-logo-wrapper/chat-header-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"edqwta3S",block:'[[[8,[39,0],null,null,[["default"],[[[[18,1,null]],[]]]]]],["&default"],false,["chat-header","yield"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/home-logo-wrapper/chat-header-connector.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6Q54Siix",block:'[[[41,[30,0,["user","can_chat_user"]],[[[1,"  "],[8,[39,1],null,[["@user"],[[30,0,["user"]]]],null],[1,"\\n"]],[]],null]],[],false,["if","chat/user-card-button"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/preferences/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Z9h+n7xC",block:'[[[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,0],["chat.title_capitalized"],null]],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_enabled"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_enabled"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","chat_enabled"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.enable"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_only_push_notifications"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_only_push_notifications"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","only_chat_push_notifications"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_ignore_channel_wide_mention"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_ignore_channel_wide_mention"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","ignore_channel_wide_mention"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_sounds"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_sounds"],[12],[1,[28,[35,0],["chat.sound.title"],null]],[13],[1,"\\n  "],[8,[39,2],null,[["@options","@valueProperty","@content","@value","@id","@onChange"],[[28,[37,3],null,[["none"],["chat.sounds.none"]]],"value",[30,0,["chatSounds"]],[30,0,["model","user_option","chat_sound"]],"user_chat_sounds",[28,[37,4],[[30,0],"onChangeChatSound"],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_email_frequency"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_email_frequency"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.email_frequency.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["emailFrequencyOptions"]],[30,0,["model","user_option","chat_email_frequency"]],"user_chat_email_frequency",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_email_frequency"]]],null]],null]]],null],[1,"\\n"],[41,[28,[37,7],[[30,0,["model","user_option","chat_email_frequency"]],"when_away"],null],[[[1,"    "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n      "],[1,[28,[35,0],["chat.email_frequency.description"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_header_indicator_preference"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_header_indicator_preference"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.header_indicator_preference.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["headerIndicatorOptions"]],[30,0,["model","user_option","chat_header_indicator_preference"]],"user_chat_header_indicator_preference",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_header_indicator_preference"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_separate_sidebar_mode"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_separate_sidebar_mode"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.separate_sidebar_mode.title"],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["chatSeparateSidebarModeOptions"]],[30,0,["chatSeparateSidebarMode"]],"user_chat_separate_sidebar_mode",[28,[37,4],[[30,0],[28,[37,5],[[30,0,["model","user_option","chat_separate_sidebar_mode"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,8],null,[["@id","@model","@action","@saved"],["user_chat_preference_save",[30,0,["model"]],[28,[37,4],[[30,0],"save"],null],[30,0,["saved"]]]],null]],[],false,["i18n","input","combo-box","hash","action","mut","if","eq","save-controls"]]',moduleName:"discourse/plugins/chat/discourse/templates/preferences/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/widgets/chat-header-icon",["exports","discourse/widgets/render-glimmer","discourse/widgets/widget","@ember/template-factory"],(function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,i.createWidget)("chat-header-icon",{tagName:"li.header-dropdown-toggle.chat-header-icon",services:["chat"],html(){if(this.chat.userCanChat)return[new t.default(this,"div.widget-component-connector",(0,n.createTemplateFactory)({id:"/OOwVHdi",block:'[[[8,[39,0],null,null,null]],[],false,["chat/header/icon"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/widgets/chat-header-icon.js",isStrictMode:!1}))]}})})),define("discourse/plugins/chat/lib/discourse-markdown/chat-transcript",["exports","pretty-text/emoji","discourse-i18n"],(function(e,t,i){"use strict"
let n
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["svg[class=fa d-icon d-icon-discourse-threads svg-icon svg-node]","use[href=#discourse-threads]","div[class=chat-transcript]","details[class=chat-transcript]","div[class=chat-transcript chat-transcript-chained]","details[class=chat-transcript chat-transcript-chained]","div.chat-transcript-meta","div.chat-transcript-user","div.chat-transcript-username","div.chat-transcript-user-avatar","div.chat-transcript-messages","div.chat-transcript-datetime","div.chat-transcript-reactions","div.chat-transcript-reaction","span[title]","div[data-message-id]","div[data-channel-name]","div[data-channel-id]","div[data-username]","div[data-datetime]","a.chat-transcript-channel","div.chat-transcript-thread","div.chat-transcript-thread-header","span.chat-transcript-thread-header__title"]),e.registerOptions(((e,t)=>{e.features["chat-transcript"]=!!t.chat_enabled})),e.registerPlugin((e=>{e.options.discourse.features["chat-transcript"]&&e.block.bbcode.ruler.push("chat-transcript",r)})),e.buildCookFunction(((e,t)=>{if(!e.discourse.additionalOptions?.chat)return
const i=e.discourse.additionalOptions.chat,r=i.limited_pretty_text_markdown_rules.concat("image")
t({featuresOverride:i.limited_pretty_text_features,markdownItRules:r,hashtagLookup:e.discourse.hashtagLookup,hashtagTypesInPriorityOrder:i.hashtag_configurations["chat-composer"],hashtagIcons:e.discourse.hashtagIcons},(e=>{n=e}))}))}
const r={tag:"chat",replace:function(e,r,a){if(!n)return
const s=e.md.options.discourse,[o,l,c]=r.attrs.quote&&r.attrs.quote.split(";")||[],u=r.attrs.reactions,d=!!r.attrs.multiQuote,h=!!r.attrs.noLink,p=r.attrs.channel,m=r.attrs.channelId,b=r.attrs.threadId,g=r.attrs.threadTitle,f=m?s.getURL(`/chat/c/-/${m}`):null
if(!o||!l||!c)return
const v=b&&a.includes("[chat")
let y=e.push("div_chat_transcript_wrap","div",1)
if(p&&d){e.push("div_chat_transcript_meta","div",1).attrs=[["class","chat-transcript-meta"]]
const n=e.push("html_inline","",0),r=(0,t.performEmojiUnescape)(p,{getURL:s.getURL,emojiSet:s.emojiSet,emojiCDNUrl:s.emojiCDNUrl,enableEmojiShortcuts:s.enableEmojiShortcuts,inlineEmoji:s.inlineEmoji,lazy:!0})
n.content=i.default.t("chat.quote.original_channel",{channel:r,channelLink:f}),e.push("div_chat_transcript_meta","div",-1)}if(v){e.push("details_chat_transcript_wrap_open","details",1),e.push("summary_chat_transcript_open","summary",1)
e.push("div_thread_open","div",1).attrs=[["class","chat-transcript-thread"]]
e.push("div_thread_header_open","div",1).attrs=[["class","chat-transcript-thread-header"]]
const n=e.push("svg_thread_header_open","svg",1)
n.block=!1,n.attrs=[["class","fa d-icon d-icon-discourse-threads svg-icon svg-node"]],e.push(n)
let r=e.push("use_svg_thread_open","use",1)
r.block=!1,r.attrs=[["href","#discourse-threads"]],e.push(r),e.push(e.push("use_svg_thread_close","use",-1)),e.push(e.push("svg_thread_header_close","svg",-1))
e.push("span_thread_title_open","span",1).attrs=[["class","chat-transcript-thread-header__title"]]
const a=e.push("html_inline","",0),o=(0,t.performEmojiUnescape)(g,{getURL:s.getURL,emojiSet:s.emojiSet,emojiCDNUrl:s.emojiCDNUrl,enableEmojiShortcuts:s.enableEmojiShortcuts,inlineEmoji:s.inlineEmoji,lazy:!0})
a.content=o||i.default.t("chat.quote.default_thread_title"),e.push("span_thread_title_close","span",-1),e.push("div_thread_header_close","div",-1)}let w,_,j=["chat-transcript"]
if(r.attrs.chained&&j.push("chat-transcript-chained"),y.attrs=[["class",j.join(" ")]],y.attrs.push(["data-message-id",l]),y.attrs.push(["data-username",o]),y.attrs.push(["data-datetime",c]),u&&y.attrs.push(["data-reactions",u]),p&&y.attrs.push(["data-channel-name",p]),m&&y.attrs.push(["data-channel-id",m]),e.push("div_chat_transcript_user","div",1).attrs=[["class","chat-transcript-user"]],e.push("div_chat_transcript_user_avatar","div",1).attrs=[["class","chat-transcript-user-avatar"]],s.lookupAvatar&&(w=s.lookupAvatar(o)),w){e.push("html_inline","",0).content=w}e.push("div_chat_transcript_user_avatar","div",-1),e.push("div_chat_transcript_username","div",1).attrs=[["class","chat-transcript-username"]],_=s.formatUsername?s.formatUsername(o):o
if(e.push("html_inline","",0).content=_,e.push("div_chat_transcript_username","div",-1),e.push("div_chat_transcript_datetime","div",1).attrs=[["class","chat-transcript-datetime"]],h||!f){let t=e.push("span_open","span",1)
if(t.attrs=[["title",c]],t.block=!1,p&&!d){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",f]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}t=e.push("span_close","span",-1),t.block=!1}else{let t=e.push("link_open","a",1)
t.attrs=[["href",`${f}/${l}`],["title",c]],t.block=!1,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_datetime","div",-1),p&&!d){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",f]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_user","div",-1),e.push("div_chat_transcript_messages","div",1).attrs=[["class","chat-transcript-messages"]],v){const t=/\[chat/i.exec(a)
if(t){e.push("html_raw","",1).content=n(a.substring(0,t.index)),e.push("html_raw","",-1),e.push("div_thread_close","div",-1),e.push("summary_chat_transcript_close","summary",-1)
e.push("html_raw","",1).content=n(a.substring(t.index)),e.push("html_raw","",-1),e.push("details_chat_transcript_wrap_close","details",-1)}}else{e.push("html_raw","",1).content=n(a),e.push("html_raw","",-1)}if(u){let i={}
e.push("div_chat_transcript_reactions","div",1).attrs=[["class","chat-transcript-reactions"]],u.split(";").forEach((n=>{const r=n.split(":"),a=r[0],o=r[1].split(",")
e.push("div_chat_transcript_reaction","div",1).attrs=[["class","chat-transcript-reaction"]]
const l=e.push("html_inline","",0)
i[a]||(i[a]=(0,t.performEmojiUnescape)(`:${a}:`,{getURL:s.getURL,emojiSet:s.emojiSet,emojiCDNUrl:s.emojiCDNUrl,enableEmojiShortcuts:s.enableEmojiShortcuts,inlineEmoji:s.inlineEmoji,lazy:!0})),l.content=`${i[a]} ${o.length.toString()}`,e.push("div_chat_transcript_reaction","div",-1)})),e.push("div_chat_transcript_reactions","div",-1)}return e.push("div_chat_transcript_messages","div",-1),e.push("div_chat_transcript_wrap","div",-1),!0}}})),define("discourse/plugins/chat/select-kit/addons/components/thread-notifications-button",["exports","select-kit/components/notifications-button","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.default.extend({pluginApiIdentifiers:["thread-notifications-button"],classNames:["thread-notifications-button"],content:i.threadNotificationButtonLevels,selectKitOptions:{i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat"}})}))

//# sourceMappingURL=chat-dbcc03a68df92448666c7f079bd517e4fbd96d02c388906f7e9f1994d09eea1b.map
//!

;
